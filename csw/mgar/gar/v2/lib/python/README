This directory contains Python libraries, mostly related to checkpkg.

==Checkpkg==

Checks to implement:
 - foo_bar != CSWfoo-bar -> error
 - *dev(el)? -> error, suggest *-devel
 - *-?rt -> error, suggest specific library packages
 - empty package without 'transitional' in the name --> error, suggest
 	 'transitional'
 - CSWpmfoo --> error, suggest CSWpm-foo
 - Dependency on a transitional package --> error
 	 ('transitional', 'stub', 'legacy')
 - Dependency on CSWcas-initsmf + rc* files --> error


Development plan for checkpkg:
- Display stats from each run
- Shorten the on-screen output, add commands to display override lines
- Move the set check stats outside of checking functions, remove the special
  status of dependency checking functions; add a progress bar for it.
- Restructure the error reporting, group them by errors.
- Sort all list data structures so that it's possible to diff the results of
  pprint.pprint() and see meaningful results.  This will be the new
  implementation for comparepkg.
- Add fields to the srv4_file_stats table:
  - source URL (for grouping by software)
  - Description (to search for the word 'transitional')
- Don't suggest two packages for the same soname.

Also, see ticket list on trac: http://sourceforge.net/apps/trac/gar/report/1

Items done:
- Move the 'data' field of the srv4_file table to a separate table (should
  speed up checking if stats are already collected)
- Store run history
- Generalize dependency checking by adding NeedFile(file_list, reason) to
  error_mgr.  It's possible to need one of the listed files only, so files are
  given as alternatives, but the reason is common.

Known problems:
- libmagic fails sometimes when processing the whole catalog
- hachoir_parser fails sometimes on i386 packages when examining them on sparc

Package dependencies:

It's possible to develop checkpkg on a non-Solaris platform, using unit
tests as means to run various bits of code.  Here's the dependency list
for Ubuntu.

sudo aptitude install \
  python-cheetah \
  python-hachoir-parser \
  python-magic \
  python-mox \
  python-progressbar \
  python-sqlobject \
  python-yaml

===Checkpkg database===

Additional database indexes:

CREATE INDEX srv4_mtime_idx ON srv4_file_stats(mtime);
CREATE INDEX srv4_md5_idx ON srv4_file_stats(md5_sum);
CREATE INDEX catalog_idx ON srv4_file_in_catalog (arch_id, osrel_id, catrel_id);
