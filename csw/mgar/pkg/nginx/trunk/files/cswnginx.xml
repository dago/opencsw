<?xml version="1.0"?>
<!DOCTYPE service_bundle SYSTEM "/usr/share/lib/xml/dtd/service_bundle.dtd.1">
<!--
	nginx manifest
-->

<service_bundle type='manifest' name='nginx'>

<service
        name='network/nginx'
        type='service'
        version='1'>

        <instance name='nginx' enabled='false'>
                <dependency name='loopback'
                    grouping='require_all'
                    restart_on='error'
                    type='service'>
                        <service_fmri value='svc:/network/loopback:default'/>
                </dependency>

                <dependency name='physical'
                    grouping='optional_all'
                    restart_on='error'
                    type='service'>
                        <service_fmri value='svc:/network/physical:default'/>
                </dependency>

                <dependency name='multiuser-server'
                    grouping='require_all'
                    restart_on='error'
                    type='service'>
                        <service_fmri value='svc:/milestone/multi-user-server:default'/>
                </dependency>

                <exec_method
                        type='method'
                        name='start'
                        exec='/opt/csw/lib/svc/method/svc-cswnginx start'
                        timeout_seconds='60' />

                <exec_method
                        type='method'
                        name='stop'
                        exec='/opt/csw/lib/svc/method/svc-cswnginx stop'
                        timeout_seconds='60' />

                <exec_method
                        type='method'
                        name='refresh'
                        exec='/opt/csw/lib/svc/method/svc-cswnginx refresh'
                        timeout_seconds='60' />

                <property_group name='startd' type='framework'>
                        <!-- sub-process core dumps shouldn't restart
                                session -->
                        <propval name='ignore_error' type='astring'
                                value='core,signal' />
                </property_group>

        </instance>

        <template>
                <common_name>
                        <loctext xml:lang='C'>
                                nginx HTTP server and mail proxy server
                        </loctext>
                </common_name>
                <documentation>
                        <doc_link name='nginx docs'
                                uri='http://sysoev.ru/nginx/docs/' />
                </documentation>
        </template>
</service>

</service_bundle>
