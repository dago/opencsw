From bb82b6ee8a1ed4bd1f3c0df9656d9554a38d18b7 Mon Sep 17 00:00:00 2001
From: Dagobert Michelsen <dam@opencsw.org>
Date: Wed, 5 Sep 2012 11:44:36 -0500
Subject: [PATCH] Fix linking issues and enable building on Solaris 9 and
 earlier

---
 unix/tcl.m4 | 9 +++++----
 1 Datei geändert, 5 Zeilen hinzugefügt(+), 4 Zeilen entfernt(-)

diff --git a/unix/tcl.m4 b/unix/tcl.m4
index cb31f50..84a738c 100644
--- a/unix/tcl.m4
+++ b/unix/tcl.m4
@@ -1961,6 +1961,7 @@ AC_DEFUN([SC_CONFIG_CFLAGS], [
 		    ], [
 			do64bit_ok=yes
 			case $system in
+# Non functional check, m64/xarch depends on compiler not os version
 			    SunOS-5.1[[1-9]]*|SunOS-5.[[2-9]][[0-9]]*)
 				CFLAGS="$CFLAGS -m64"
 				LDFLAGS="$LDFLAGS -m64";;
@@ -1979,7 +1980,7 @@ AC_DEFUN([SC_CONFIG_CFLAGS], [
 	    AS_IF([test "$GCC" = yes],[use_sunmath=no],[
 		arch=`isainfo`
 		AC_MSG_CHECKING([whether to use -lsunmath for fp rounding control])
-		AS_IF([test "$arch" = "amd64 i386"], [
+		AS_IF([test "$arch" = "amd64 i386" -o "$arch" = "i386"], [
 			AC_MSG_RESULT([yes])
 			MATH_LIBS="-lsunmath $MATH_LIBS"
 			AC_CHECK_HEADER(sunmath.h)
@@ -2013,13 +2014,13 @@ AC_DEFUN([SC_CONFIG_CFLAGS], [
 	    ], [
 		AS_IF([test "$use_sunmath" = yes], [textmode=textoff],[textmode=text])
 		case $system in
-		    SunOS-5.[[1-9]][[0-9]]*)
+		    SunOS-5.[[1-9]][[0-9]]*|SunOS-5.[[7-9]])
 			SHLIB_LD="\${CC} -G -z $textmode \${LDFLAGS}";;
 		    *)
 			SHLIB_LD="/usr/ccs/bin/ld -G -z $textmode";;
 		esac
 		CC_SEARCH_FLAGS='-Wl,-R,${LIB_RUNTIME_DIR}'
 		LD_SEARCH_FLAGS='-R ${LIB_RUNTIME_DIR}'
 	    ])
 	    ;;
 	UNIX_SV* | UnixWare-5*)
-- 
1.7.11.3

diff --git a/unix/configure b/unix/configure
index 753f7c0..5810fc3 100755
--- a/unix/configure
+++ b/unix/configure
@@ -8599,7 +8599,7 @@ else
 		arch=`isainfo`
 		echo "$as_me:$LINENO: checking whether to use -lsunmath for fp rounding control" >&5
 echo $ECHO_N "checking whether to use -lsunmath for fp rounding control... $ECHO_C" >&6
-		if test "$arch" = "amd64 i386"; then
+		if test "$arch" = "amd64 i386" -o "$arch" = "i386"; then
 
 			echo "$as_me:$LINENO: result: yes" >&5
 echo "${ECHO_T}yes" >&6
