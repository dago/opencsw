From 008e0369d158cb20703097a4e1e5239048e9d7f8 Mon Sep 17 00:00:00 2001
From: Rafael Ostertag <raos@opencsw.org>
Date: Tue, 9 Oct 2012 14:29:23 +0200
Subject: [PATCH] Remove unsupported compiler options

Remove unsupported compiler options. Also set -z interpose on evalfunction_test, since it overwrites functions.
---
 tests/unit/Makefile.am | 2 +-
 tests/unit/Makefile.in | 4 ++--
 2 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/tests/unit/Makefile.am b/tests/unit/Makefile.am
index 86f52d0..176ccfc 100644
--- a/tests/unit/Makefile.am
+++ b/tests/unit/Makefile.am
@@ -68,7 +68,7 @@ xml_writer_test_LDADD = libtest.la
 #
 file_writer_test_SOURCES = file_writer_test.c gcov-stub.c \
         ../../src/writer.c
-file_writer_test_CFLAGS = $(AM_CFLAGS) -fno-profile-arcs -fno-test-coverage
+file_writer_test_CFLAGS = $(AM_CFLAGS)
 file_writer_test_LDADD = libtest.la
 file_writer_test_LDLFAGS =
 
diff --git a/tests/unit/Makefile.in b/tests/unit/Makefile.in
index 71e500e..b972a4d 100644
--- a/tests/unit/Makefile.in
+++ b/tests/unit/Makefile.in
@@ -123,7 +123,7 @@ domainname_test_LDADD = $(LDADD)
 domainname_test_DEPENDENCIES = ../../src/libpromises.la libtest.la
 evalfunction_test_SOURCES = evalfunction_test.c
 evalfunction_test_OBJECTS = evalfunction_test.$(OBJEXT)
-evalfunction_test_LDADD = $(LDADD)
+evalfunction_test_LDADD = $(LDADD) -z interpose
 evalfunction_test_DEPENDENCIES = ../../src/libpromises.la libtest.la
 am_file_writer_test_OBJECTS =  \
 	file_writer_test-file_writer_test.$(OBJEXT) \
@@ -467,7 +467,7 @@ xml_writer_test_LDADD = libtest.la
 file_writer_test_SOURCES = file_writer_test.c gcov-stub.c \
         ../../src/writer.c
 
-file_writer_test_CFLAGS = $(AM_CFLAGS) -fno-profile-arcs -fno-test-coverage
+file_writer_test_CFLAGS = $(AM_CFLAGS)
 file_writer_test_LDADD = libtest.la
 file_writer_test_LDLFAGS = 
 db_test_SOURCES = db_test.c
-- 
1.7.12

