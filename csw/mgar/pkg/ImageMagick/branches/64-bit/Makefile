NAME = imagemagick
VERSION = 6.5.9
GARSUBREV = 5
CATEGORIES = lib

DESCRIPTION = A comprehensive package supporting automated and interative manipulation of images
define BLURB
  ImageMagick is a robust collection of tools and libraries offered under a
  usage license to read, write, and manipulate an image in many image formats
  (over 89 major formats) including popular formats like TIFF, JPEG, PNG, PDF,
  PhotoCD, and GIF.
endef

MASTER_SITES = ftp://ftp.imagemagick.org/pub/ImageMagick/
DISTFILES  = ImageMagick-$(VERSION)-$(GARSUBREV).tar.bz2

DISTNAME = ImageMagick-$(VERSION)-$(GARSUBREV)

SPKG_SOURCEURL = http://www.imagemagick.org

LICENSE = LICENSE

RUNTIME_DEP_PKGS_CSWimagemagick += CSWbzip2
RUNTIME_DEP_PKGS_CSWimagemagick += CSWdjvulibrert
RUNTIME_DEP_PKGS_CSWimagemagick += CSWfconfig
RUNTIME_DEP_PKGS_CSWimagemagick += CSWftype2
RUNTIME_DEP_PKGS_CSWimagemagick += CSWggettextrt
RUNTIME_DEP_PKGS_CSWimagemagick += CSWglib2
RUNTIME_DEP_PKGS_CSWimagemagick += CSWgraphviz
RUNTIME_DEP_PKGS_CSWimagemagick += CSWgs
RUNTIME_DEP_PKGS_CSWimagemagick += CSWgtk2
RUNTIME_DEP_PKGS_CSWimagemagick += CSWilmbase
RUNTIME_DEP_PKGS_CSWimagemagick += CSWjasper
RUNTIME_DEP_PKGS_CSWimagemagick += CSWjbigkit
RUNTIME_DEP_PKGS_CSWimagemagick += CSWjpeg
RUNTIME_DEP_PKGS_CSWimagemagick += CSWlcmsrt
RUNTIME_DEP_PKGS_CSWimagemagick += CSWlibcairo
RUNTIME_DEP_PKGS_CSWimagemagick += CSWlibfpx
RUNTIME_DEP_PKGS_CSWimagemagick += CSWlibice
RUNTIME_DEP_PKGS_CSWimagemagick += CSWlibrsvg
RUNTIME_DEP_PKGS_CSWimagemagick += CSWlibsm
RUNTIME_DEP_PKGS_CSWimagemagick += CSWlibtoolrt
RUNTIME_DEP_PKGS_CSWimagemagick += CSWlibwmf
RUNTIME_DEP_PKGS_CSWimagemagick += CSWlibx11
RUNTIME_DEP_PKGS_CSWimagemagick += CSWlibxext
RUNTIME_DEP_PKGS_CSWimagemagick += CSWlibxml2
RUNTIME_DEP_PKGS_CSWimagemagick += CSWlibxt
RUNTIME_DEP_PKGS_CSWimagemagick += CSWopenexr
RUNTIME_DEP_PKGS_CSWimagemagick += CSWperl
RUNTIME_DEP_PKGS_CSWimagemagick += CSWpng
RUNTIME_DEP_PKGS_CSWimagemagick += CSWsunmath
RUNTIME_DEP_PKGS_CSWimagemagick += CSWtiffrt
RUNTIME_DEP_PKGS_CSWimagemagick += CSWzlib

CHECKPKG_OVERRIDES += CSWimagemagick|symbol-not-found|libMagick++.so.10.0.4
CHECKPKG_OVERRIDES += CSWimagemagick|symbol-not-found|ept.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|cip.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|otb.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|gif.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|vid.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|pix.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|mvg.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|palm.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|pdf.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|avs.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|pcd.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|icon.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|magick.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|tim.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|xc.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|ps2.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|raw.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|xcf.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|dps.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|ps3.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|ps.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|mpc.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|fpx.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|pnm.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|mpeg.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|xwd.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|url.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|gray.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|ycbcr.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|rgb.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|tile.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|uil.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|pwp.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|sfw.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|stegano.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|pattern.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|txt.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|mpr.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|html.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|info.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|pdb.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|cut.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|msl.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|jp2.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|fits.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|vicar.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|cmyk.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|histogram.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|scr.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|avi.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|label.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|bmp.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|psd.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|jbig.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|null.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|dcm.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|tiff.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|dot.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|sun.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|wmf.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|x.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|ttf.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|miff.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|xbm.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|jpeg.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|map.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|rle.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|art.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|xpm.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|svg.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|uyvy.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|tga.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|dib.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|wbmp.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|fax.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|clip.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|sct.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|pcl.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|mono.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|rla.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|matte.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|mat.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|pict.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|preview.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|viff.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|meta.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|gradient.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|sgi.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|yuv.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|cin.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|plasma.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|png.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|mtv.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|pcx.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|caption.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|wpg.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|dpx.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|analyze.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|inline.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|pcd.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|jpeg.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|ps2.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|miff.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|tim.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|mpc.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|xcf.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|ps3.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|raw.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|uyvy.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|pnm.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|fpx.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|jbig.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|cip.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|ept.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|label.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|otb.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|cmyk.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|thumbnail.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|tiff.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|gif.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|braille.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|avs.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|pdf.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|null.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|pix.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|mvg.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|exr.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|vid.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|txt.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|mpr.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|x.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|msl.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|pdb.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|cut.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|plasma.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|jp2.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|dds.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|hald.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|caption.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|xwd.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|hrz.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|clip.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|wbmp.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|rgb.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|url.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|sfw.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|meta.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|uil.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|viff.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|pwp.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|matte.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|pict.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|preview.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|xps.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|mono.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|xbm.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|ttf.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|sun.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|magick.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|wmf.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|art.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|rle.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|map.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|icon.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|dng.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|svg.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|xpm.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|tga.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|xc.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|bmp.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|cals.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|scr.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|psd.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|dcm.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|palm.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|dot.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|ipl.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|ps.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|sgi.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|gradient.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|info.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|html.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|png.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|stegano.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|djvu.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|cin.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|pattern.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|yuv.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|pcx.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|mtv.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|vicar.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|fits.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|dpx.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|wpg.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|ycbcr.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|dib.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|gray.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|sct.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|pcl.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|mpeg.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|histogram.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|fax.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|mat.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|tile.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|rla.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|convolve.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|analyze.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|libMagick++.so.2.0.1
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|libWand.so.10.0.4
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|libMagickWand.so.2.0.1
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|Magick.so
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|conjure
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|montage
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|animate
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|import
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|display
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|mogrify
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|identify
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|convert
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|compare2
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|composite
CHECKPKG_OVERRIDES_CSWimagemagick += symbol-not-found|stream

# We define upstream file regex so we can be notifed of new upstream software release
UFILES_REGEX = ImageMagick-((\d+(?:\.\d+)*)-(\d+)?).tar.bz2

CONFIGURE_ARGS_COMMON  = $(DIRPATHS)
CONFIGURE_ARGS_COMMON += --with-perl=$(bindir)/perl
CONFIGURE_ARGS_COMMON += --enable-shared --disable-static
CONFIGURE_ARGS_COMMON += --with-dps=yes --with-gslib=yes
CONFIGURE_ARGS_COMMON += --x-includes=/opt/csw/X11/include
CONFIGURE_ARGS_COMMON += --x-libraries=/opt/csw/X11/lib 
CONFIGURE_ARGS_COMMON += --with-modules=yes
CONFIGURE_ARGS_COMMON += --disable-openmp
CONFIGURE_ARGS_COMMON += --disable-silent-rules
# Until librsvg,graphviz and perl is 64bit
#CONFIGURE_ARGS_isa-amd64 += --without-gvc
#CONFIGURE_ARGS_isa-amd64 += --without-rsvg
#CONFIGURE_ARGS_isa-amd64 += --without-perl
#CONFIGURE_ARGS_isa-sparcv9 += --without-gvc
#CONFIGURE_ARGS_isa-sparcv9 += --without-rsvg
#CONFIGURE_ARGS_isa-sparcv9 += --without-perl

CONFIGURE_ARGS = $(CONFIGURE_ARGS_COMMON) $(foreach M,$(MODULATIONS),$(CONFIGURE_ARGS_$M))

PATCHFILES += Makefile.patch
# Temporary patch until upstream make a more permenent fix
#PATCHFILES += djvu.c.diff

# Test has to be run *after* install
#TEST_TARGET = check
TEST_TARGET = 

#Dependencies not 64-bit yet
#BUILD64 = 1

EXTRA_INC = $(prefix)/X11/include
EXTRA_LIB = $(prefix)/X11/lib
EXTRA_PKG_CONFIG_DIRS = $(prefix)/X11/lib
#EXTRA_LDFLAGS = -L./magick/.libs 
#EXTRA_LD_OPTIONS = -L./magick/.libs 
#
EXTRA_SOS_LD_FLAGS += -L$(shell pwd)/$(WORKSRC)/magick/.libs
EXTRA_SOS_LD_FLAGS += -L$(shell pwd)/$(WORKSRC)/wand/.libs
# We want to be link with Xrender from $(prefix)/X11/lib not $(prefix)/lib
# since the latter is linked to /usr/openwin/lib/libX11.so.4
EXTRA_SOS_LD_FLAGS += -L$(abspath $(prefix)/X11/lib/$(MM_LIBDIR))

MERGE_EXCLUDE_LIBTOOL ?= $(libdir)/lib.*\.la
EXTRA_MERGE_EXCLUDE_FILES = .*/perllocal.pod

STRIP_LIBTOOL=1

include gar/category.mk

SPKG_REVSTAMP := $(SPKG_REVSTAMP)_rev=$(GARSUBREV)

post-install-isa-sparcv8:
	@cp $(FILEDIR)/libMagick.so.10.0.4.s $(INSTALLISADIR)$(libdir)/libMagick.so.10.0.4
	@cp $(FILEDIR)/libWand.so.10.0.4.s $(INSTALLISADIR)$(libdir)/libWand.so.10.0.4
	@cp $(FILEDIR)/libMagick++.so.10.0.4.s $(INSTALLISADIR)$(libdir)/libMagick++.so.10.0.4
	@( if [ ! -r $(INSTALLISADIR)$(libdir)/libMagick.so.10.0.4 ] ; then ln -s libMagick.so.10.0.4 $(INSTALLISADIR)$(libdir)/libMagick.so.10 ; fi )
	@( if [ ! -r $(INSTALLISADIR)$(libdir)/libWand.so.10.0.4 ] ; then ln -s libWand.so.10.0.4 $(INSTALLISADIR)$(libdir)/libWand.so.10 ; fi )
	@( if [ ! -r $(INSTALLISADIR)$(libdir)/libMagick++.so.10.0.4 ] ; then ln -s libMagick++.so.10.0.4 $(INSTALLISADIR)$(libdir)/libMagick++.so.10 ; fi )
	@ln -s ImageMagick-$(VERSION) $(INSTALLISADIR)$(docdir)/ImageMagick
	@( cd $(INSTALLISADIR)$(libdir) ; gzip -dc $(CURDIR)/$(FILEDIR)/lib_6.2.9_s.tar.gz |tar xf -)
	@mv $(INSTALLISADIR)$(mandir)/man1/compare.1 $(INSTALLISADIR)$(mandir)/man1/compare2.1
	@mv $(INSTALLISADIR)$(bindir)/compare $(INSTALLISADIR)$(bindir)/compare2
	@$(MAKECOOKIE)

post-install-isa-i386:
	@cp $(FILEDIR)/libMagick.so.10.0.4.i $(INSTALLISADIR)$(libdir)/libMagick.so.10.0.4
	@cp $(FILEDIR)/libWand.so.10.0.4.i $(INSTALLISADIR)$(libdir)/libWand.so.10.0.4
	@cp $(FILEDIR)/libMagick++.so.10.0.4.i $(INSTALLISADIR)$(libdir)/libMagick++.so.10.0.4
	@( if [ ! -r $(INSTALLISADIR)$(libdir)/libMagick.so.10.0.4 ] ; then ln -s libMagick.so.10.0.4 $(INSTALLISADIR)$(libdir)/libMagick.so.10 ; fi )
	@( if [ ! -r $(INSTALLISADIR)$(libdir)/libWand.so.10.0.4 ] ; then ln -s libWand.so.10.0.4 $(INSTALLISADIR)$(libdir)/libWand.so.10 ; fi )
	@( if [ ! -r $(INSTALLISADIR)$(libdir)/libMagick++.so.10.0.4 ] ; then ln -s libMagick++.so.10.0.4 $(INSTALLISADIR)$(libdir)/libMagick++.so.10 ; fi )
	@ln -s ImageMagick-$(VERSION) $(INSTALLISADIR)$(docdir)/ImageMagick
	@( cd $(INSTALLISADIR)$(libdir) ; gzip -dc $(CURDIR)/$(FILEDIR)/lib_6.2.9_i.tar.gz |tar xf -)
	@mv $(INSTALLISADIR)$(mandir)/man1/compare.1 $(INSTALLISADIR)$(mandir)/man1/compare2.1
	@mv $(INSTALLISADIR)$(bindir)/compare $(INSTALLISADIR)$(bindir)/compare2
	@$(MAKECOOKIE)
