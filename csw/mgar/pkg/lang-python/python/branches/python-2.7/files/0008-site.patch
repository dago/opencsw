From aba7368c957a565f1f2b3770aaef3fe950816a1b Mon Sep 17 00:00:00 2001
From: Peter Felecan <pfelecan@opencsw.org>
Date: Tue, 16 Jul 2013 16:59:44 +0200
Subject: [PATCH] site

based on site.diff from 2.6 with adaptations
---
 Lib/distutils/sysconfig.py |  2 +-
 Lib/site.py                |  2 +-
 Lib/sysconfig.py           | 32 ++++++++++++++++----------------
 Lib/trace.py               |  4 ++--
 Makefile.pre.in            |  6 +++---
 Modules/getpath.c          |  6 +++---
 6 files changed, 26 insertions(+), 26 deletions(-)

diff --git a/Lib/distutils/sysconfig.py b/Lib/distutils/sysconfig.py
index 0c726d9..a9ada72 100644
--- a/Lib/distutils/sysconfig.py
+++ b/Lib/distutils/sysconfig.py
@@ -120,7 +120,7 @@ def get_python_lib(plat_specific=0, standard_lib=0, prefix=None):
 
     if os.name == "posix":
         libpython = os.path.join(prefix,
-                                 "lib", "python" + get_python_version())
+                                 "lib", "python")
         if standard_lib:
             return libpython
         else:
diff --git a/Lib/site.py b/Lib/site.py
index f1b0ae8..be21919 100644
--- a/Lib/site.py
+++ b/Lib/site.py
@@ -289,7 +289,7 @@ def getsitepackages():
             sitepackages.append(os.path.join(prefix, "Lib", "site-packages"))
         elif os.sep == '/':
             sitepackages.append(os.path.join(prefix, "lib",
-                                        "python" + sys.version[:3],
+                                        "python",
                                         "site-packages"))
             sitepackages.append(os.path.join(prefix, "lib", "site-python"))
         else:
diff --git a/Lib/sysconfig.py b/Lib/sysconfig.py
index aa69351..b177b61 100644
--- a/Lib/sysconfig.py
+++ b/Lib/sysconfig.py
@@ -7,12 +7,12 @@ from os.path import pardir, realpath
 
 _INSTALL_SCHEMES = {
     'posix_prefix': {
-        'stdlib': '{base}/lib/python{py_version_short}',
-        'platstdlib': '{platbase}/lib/python{py_version_short}',
-        'purelib': '{base}/lib/python{py_version_short}/site-packages',
-        'platlib': '{platbase}/lib/python{py_version_short}/site-packages',
-        'include': '{base}/include/python{py_version_short}',
-        'platinclude': '{platbase}/include/python{py_version_short}',
+        'stdlib': '{base}/lib/python',
+        'platstdlib': '{platbase}/lib/python',
+        'purelib': '{base}/lib/python/site-packages',
+        'platlib': '{platbase}/lib/python/site-packages',
+        'include': '{base}/include/python',
+        'platinclude': '{platbase}/include/python',
         'scripts': '{base}/bin',
         'data': '{base}',
         },
@@ -47,11 +47,11 @@ _INSTALL_SCHEMES = {
         'data'   : '{base}',
         },
     'os2_home': {
-        'stdlib': '{userbase}/lib/python{py_version_short}',
-        'platstdlib': '{userbase}/lib/python{py_version_short}',
-        'purelib': '{userbase}/lib/python{py_version_short}/site-packages',
-        'platlib': '{userbase}/lib/python{py_version_short}/site-packages',
-        'include': '{userbase}/include/python{py_version_short}',
+        'stdlib': '{userbase}/lib/python',
+        'platstdlib': '{userbase}/lib/python',
+        'purelib': '{userbase}/lib/python/site-packages',
+        'platlib': '{userbase}/lib/python/site-packages',
+        'include': '{userbase}/include/python',
         'scripts': '{userbase}/bin',
         'data'   : '{userbase}',
         },
@@ -65,11 +65,11 @@ _INSTALL_SCHEMES = {
         'data'   : '{userbase}',
         },
     'posix_user': {
-        'stdlib': '{userbase}/lib/python{py_version_short}',
-        'platstdlib': '{userbase}/lib/python{py_version_short}',
-        'purelib': '{userbase}/lib/python{py_version_short}/site-packages',
-        'platlib': '{userbase}/lib/python{py_version_short}/site-packages',
-        'include': '{userbase}/include/python{py_version_short}',
+        'stdlib': '{userbase}/lib/python',
+        'platstdlib': '{userbase}/lib/python',
+        'purelib': '{userbase}/lib/python/site-packages',
+        'platlib': '{userbase}/lib/python/site-packages',
+        'include': '{userbase}/include/python',
         'scripts': '{userbase}/bin',
         'data'   : '{userbase}',
         },
diff --git a/Lib/trace.py b/Lib/trace.py
index 38a13e2..a54e9e7 100644
--- a/Lib/trace.py
+++ b/Lib/trace.py
@@ -755,10 +755,10 @@ def main(argv=None):
 
                 s = s.replace("$prefix",
                               os.path.join(sys.prefix, "lib",
-                                           "python" + sys.version[:3]))
+                                           "python"))
                 s = s.replace("$exec_prefix",
                               os.path.join(sys.exec_prefix, "lib",
-                                           "python" + sys.version[:3]))
+                                           "python"))
                 s = os.path.normpath(s)
                 ignore_dirs.append(s)
             continue
diff --git a/Makefile.pre.in b/Makefile.pre.in
index 9d55550..b723a50 100644
--- a/Makefile.pre.in
+++ b/Makefile.pre.in
@@ -109,11 +109,11 @@ CONFINCLUDEDIR=	$(exec_prefix)/include
 SCRIPTDIR=	$(prefix)/lib
 
 # Detailed destination directories
-BINLIBDEST=	$(LIBDIR)/python$(VERSION)
-LIBDEST=	$(SCRIPTDIR)/python$(VERSION)
+BINLIBDEST=	$(LIBDIR)/python
+LIBDEST=	$(SCRIPTDIR)/python
 INCLUDEPY=	$(INCLUDEDIR)/python$(VERSION)
 CONFINCLUDEPY=	$(CONFINCLUDEDIR)/python$(VERSION)
-LIBP=		$(LIBDIR)/python$(VERSION)
+LIBP=		$(LIBDIR)/python
 
 # Symbols used for using shared libraries
 SO=		@SO@
diff --git a/Modules/getpath.c b/Modules/getpath.c
index de96d47..9a88383 100644
--- a/Modules/getpath.c
+++ b/Modules/getpath.c
@@ -117,8 +117,8 @@
 #endif
 
 #ifndef PYTHONPATH
-#define PYTHONPATH PREFIX "/lib/python" VERSION ":" \
-              EXEC_PREFIX "/lib/python" VERSION "/lib-dynload"
+#define PYTHONPATH PREFIX "/lib/python:" \
+              EXEC_PREFIX "/lib/python/lib-dynload"
 #endif
 
 #ifndef LANDMARK
@@ -129,7 +129,7 @@ static char prefix[MAXPATHLEN+1];
 static char exec_prefix[MAXPATHLEN+1];
 static char progpath[MAXPATHLEN+1];
 static char *module_search_path = NULL;
-static char lib_python[] = "lib/python" VERSION;
+static char lib_python[] = "lib/python";
 
 static void
 reduce(char *dir)
-- 
1.8.3.1

