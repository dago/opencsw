From b4da8e66d1a74bad609e0b6f585670a4180d0bb0 Mon Sep 17 00:00:00 2001
From: Peter Felecan <pfelecan@opencsw.org>
Date: Mon, 15 Jul 2013 14:16:24 +0200
Subject: [PATCH] multiprocess

based on multiprocess.diff from 2.6
---
 Modules/_multiprocessing/multiprocessing.h | 25 +++++++++++++++++++++++++
 1 file changed, 25 insertions(+)

diff --git a/Modules/_multiprocessing/multiprocessing.h b/Modules/_multiprocessing/multiprocessing.h
index 14425de..c9fd187 100644
--- a/Modules/_multiprocessing/multiprocessing.h
+++ b/Modules/_multiprocessing/multiprocessing.h
@@ -48,6 +48,20 @@
 #endif
 
 /*
+ * Solaris 8 missing CMSG_SPACE and CMSG_LEN
+ */
+#ifndef CMSG_SPACE
+#  define CMSG_SPACE(l)       (_CMSG_DATA_ALIGN(sizeof(struct cmsghdr)) + \
+                                      _CMSG_HDR_ALIGN(l))
+#  warning "assuming 4-byte alignment for CMSG_SPACE"
+#endif  /* CMSG_SPACE */
+
+#ifndef CMSG_LEN
+#  define CMSG_LEN(l)         (_CMSG_DATA_ALIGN(sizeof(struct cmsghdr)) + (l))
+#  warning "assuming 4-byte alignment for CMSG_LEN"
+#endif /* CMSG_LEN */
+
+/*
  * Issue 3110 - Solaris does not define SEM_VALUE_MAX
  */
 #ifndef SEM_VALUE_MAX
@@ -64,6 +78,17 @@
 
 
 /*
+ * Issue 3110 - Solaris does not define SEM_VALUE_MAX
+ */
+#ifndef SEM_VALUE_MAX
+#  ifdef _SEM_VALUE_MAX
+#    define SEM_VALUE_MAX _SEM_VALUE_MAX
+#  else
+#    define SEM_VALUE_MAX INT_MAX
+#  endif
+#endif
+
+/*
  * Make sure Py_ssize_t available
  */
 
-- 
1.8.3.1

