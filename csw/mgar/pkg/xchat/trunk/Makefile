NAME = xchat
VERSION = 2.8.8
CATEGORIES = gnome
GARTYPE = v2

DESCRIPTION = GTK+ based IRC client, similar to AmIRC (Amiga).
define BLURB
  X-Chat is a fully-featured graphical IRC client using the GTK toolkit.
  Optionally it can be compiled to use GNOME and Perl scripting.
endef

MASTER_SITES  = http://xchat.org/files/source/2.8/
MASTER_SITES += http://xchat.org/files/source/2.8/patches/
DISTFILES  = $(NAME)-$(VERSION).tar.bz2

PACKAGES = CSWxchat CSWxchat-pl CSWxchat-py CSWxchat-tcl
CATALOGNAME_CSWxchat     = xchat
CATALOGNAME_CSWxchat-pl  = xchat_pl
CATALOGNAME_CSWxchat-py  = xchat_py
CATALOGNAME_CSWxchat-tcl = xchat_tcl
SPKG_DESC_CSWxchat     = GTK+ based IRC client, similar to AmIRC (Amiga).
SPKG_DESC_CSWxchat-pl  = xChat Perl Plugin
SPKG_DESC_CSWxchat-py  = xChat Python Plugin
SPKG_DESC_CSWxchat-tcl = xChat TCL Plugin
RUNTIME_DEP_PKGS_CSWxchat  = CSWdbusglib CSWexpat CSWfconfig CSWftype2 CSWlibntlm
RUNTIME_DEP_PKGS_CSWxchat += CSWggettextrt CSWglib2 CSWgtk2 CSWiconv CSWlibatk 
RUNTIME_DEP_PKGS_CSWxchat += CSWlibcairo CSWlibdbus CSWlibxft2 CSWlibxrender 
RUNTIME_DEP_PKGS_CSWxchat += CSWosslrt CSWpango CSWpng CSWsunmath CSWzlib
RUNTIME_DEP_PKGS_CSWxchat-pl   = CSWxchat CSWperl CSWosslrt CSWglib2
RUNTIME_DEP_PKGS_CSWxchat-pl  += CSWggettextrt CSWlibntlm
RUNTIME_DEP_PKGS_CSWxchat-py   = CSWxchat CSWpython CSWosslrt CSWglib2
RUNTIME_DEP_PKGS_CSWxchat-py  += CSWggettextrt CSWlibntlm
RUNTIME_DEP_PKGS_CSWxchat-tcl  = CSWxchat CSWtcl CSWosslrt CSWglib2
RUNTIME_DEP_PKGS_CSWxchat-tcl += CSWggettextrt CSWlibntlm
PKGFILES_CSWxchat-pl  = $(libdir)/.*/perl.so
PKGFILES_CSWxchat-py  = $(libdir)/.*/python.so
PKGFILES_CSWxchat-tcl = $(libdir)/.*/tcl.so

# We define upstream file regex so we can be notifed of new 
# upstream software release
UFILES_REGEX = $(NAME)-(\d+(?:\.\d+)*).tar.bz2

# Fix some compilation problem under Solaris
PATCHFILES = xchat26-compiletime.diff

# Patch taken http://trac.macports.org/ticket/33959 and updated
# to be able to compile against a more recent version of glib
PATCHFILES += patch-glib-2.32.diff

LDFLAGS =
NOISALIST = 1
CONFIGURE_ARGS  = $(DIRPATHS)
CONFIGURE_ARGS += --enable-openssl=$(prefix)
CONFIGURE_ARGS += --enable-threads=solaris
CONFIGURE_ARGS += --enable-tcl=$(libdir)
CONFIGURE_ARGS += --enable-shm
CONFIGURE_ARGS += --enable-ipv6

## run checkpkg manually
ENABLE_CHECK = 0
EXTRA_INC = $(prefix)/bdb44/include
EXTRA_LIB = $(prefix)/bdb44/lib

DISTFILES += fixme.sh
post-configure-modulated:
	@(echo "~~~ Fixing Libtool ~~~")
	@$(DOWNLOADDIR)/fixme.sh $(WORKSRC)
	$(DONADA)

include gar/category.mk
