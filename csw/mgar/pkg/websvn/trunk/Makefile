NAME = websvn
VERSION = 2.2.1
CATEGORIES = apps

DESCRIPTION = PHP based web interface of Subversion repositories
define BLURB
  WebSVN offers a view onto your subversion repositories that's been
  designed to reflect the Subversion methodology. You can view the
  log of any file or directory and see a list of all the files changed,
  added or deleted in any given revision. You can also view the differences
  between 2 versions of a file so as to see exactly what was changed in
  a particular revision.
endef

MASTER_SITES  = http://websvn.tigris.org/files/documents/1380/45918/
DISTFILES = $(DISTNAME).tar.gz
PATCHFILES = websvn-csw-config.patch

SPKG_SOURCEURL = http://websvn.tigris.org/

LICENSE = license.txt

RUNTIME_DEP_PKGS = CSWapache2 CSWdiffutils CSWsvn CSWenscript CSWgsed CSWgtar CSWgzip

CONFIGURE_SCRIPTS =
BUILD_SCRIPTS =
TEST_SCRIPTS =
INSTALL_SCRIPTS = custom

EXTRA_PAX_ARGS += -s ',^\.\(.*\)/distconfig.php$$,.\1/config.php,'

PRESERVECONF = $(sharedstatedir)/www/websvn/include/config.php

ARCHALL = 1

include gar/category.mk

install-custom:
	@echo " ==> Installing $(NAME)"
	@rm -rf $(DESTDIR)$(sharedstatedir)/www/websvn
	@ginstall -d $(DESTDIR)$(sharedstatedir)/www/websvn
	@cp -rp $(WORKSRC) $(DESTDIR)$(sharedstatedir)/www/websvn/htdocs
	@find $(DESTDIR)$(prefix) -name .svn -exec rm -rf \{\} \;
	@rm -rf $(DESTDIR)$(prefix)/apache2/share/htdocs/websvn
	@ginstall -d $(DESTDIR)$(prefix)/apache2/share/htdocs
	@ln -s $(sharedstatedir)/www/websvn/htdocs $(DESTDIR)$(prefix)/apache2/share/htdocs/websvn
