# $Id$
# TODO (release-critical prefixed with !, non release-critical with *)
#
NAME = aspell
VERSION = 0.60.6.1
GARTYPE = v2
CATEGORIES = apps

DESCRIPTION = Spell checker
define BLURB
  The GNU spell checker (core package only, no dictionary)
endef

PACKAGES = CSWaspell 

SPKG_DESC_CSWaspell = The GNU spell checker (binaries)
RUNTIME_DEP_PKGS_CSWaspell  = CSWlibaspell15
RUNTIME_DEP_PKGS_CSWaspell += CSWlibncursesw5 
RUNTIME_DEP_PKGS_CSWaspell += CSWlibintl8

CHECKPKG_OVERRIDES_CSWaspell += file-with-bad-content|/usr/local|root/opt/csw/share/info/aspell.info
CHECKPKG_OVERRIDES_CSWaspell += file-with-bad-content|/usr/share|root/opt/csw/share/info/aspell.info
CHECKPKG_OVERRIDES_CSWaspell += file-with-bad-content|/usr/local|root/opt/csw/share/doc/aspell/README


PACKAGES += CSWlibaspell15
SPKG_DESC_CSWlibaspell15 = The GNU spell checker (libraries)
PKGFILES_CSWlibaspell15  = $(call pkgfiles_lib,libaspell.so.15)
PKGFILES_CSWlibaspell15 += $(call pkgfiles_lib,libpspell.so.15)
PKGFILES_CSWlibaspell15 += $(libdir)/aspell-.*/.*
PKGFILES_CSWlibaspell15 += $(docdir)/libaspell15/.* 
RUNTIME_DEP_PKGS_CSWlibaspell15 += CSWlibintl8

CHECKPKG_OVERRIDES_CSWlibaspell15 += file-with-bad-content|/usr/local|root/opt/csw/share/doc/libaspell15/README

# We want to keep pspell library in aspell package
CHECKPKG_OVERRIDES_CSWlibaspell15 += shared-lib-pkgname-mismatch|file=opt/csw/lib/libpspell.so.15.1.5|soname=libpspell.so.15|pkgname=CSWlibaspell15|expected=CSWlibpspell15

PACKAGES += CSWlibaspell-dev

SPKG_DESC_CSWlibaspell-dev = The GNU spell checker (developpement files)
PKGFILES_CSWlibaspell-dev  = $(PKGFILES_DEVEL)
PKGFILES_CSWlibaspell-dev += $(docdir)/libaspell_dev/.* 
RUNTIME_DEP_PKGS_CSWlibaspell-dev = CSWlibaspell15

CHECKPKG_OVERRIDES_CSWlibaspell-dev += file-with-bad-content|/usr/local|root/opt/csw/share/doc/libaspell_dev/README


MASTER_SITES = $(GNU_MIRROR)
DISTFILES  = $(DISTNAME).tar.gz
DISTFILES += changelog.CSW

# We have to patch ltmain.sh script generated by libtool
# to make sure the "-norunpath" option is passed to the linker
PATCHFILES = 0001-norunpath-option.patch

DOCFILES = TODO ABOUT-NLS README

PACKAGING_PLATFORMS = solaris10-sparc solaris10-i386

EXTRA_LINKER_FLAGS = -lm -norunpath

CONFIGURE_ARGS = $(DIRPATHS)

include gar/category.mk

post-merge: merge-doc 

merge-doc:
	for CATALOGNAME in $(foreach PKG, $(PACKAGES), $(call catalogname,$(PKG))); do \
                ginstall -d $(PKGROOT)/$(docdir)/$$CATALOGNAME; \
                (cd $(DOWNLOADDIR)/ && ginstall -m 0644 changelog.CSW $(PKGROOT)/$(docdir)/$$CATALOGNAME/); \
                (cd $(WORKSRC_FIRSTMOD)/ && ginstall -m 0644 $(DOCFILES) $(PKGROOT)/$(docdir)/$$CATALOGNAME/); \
        done
	@$(MAKECOOKIE)

