--- rdesktop-1.6.0.orig/disk.c	2009-06-19 09:06:27.000000000 -0400
+++ rdesktop-1.6.0/disk.c	2009-06-25 09:40:44.000000000 -0400
@@ -1096,10 +1101,24 @@
 			rdp_out_unistr(out, fsinfo->type, 2 * strlen(fsinfo->type) - 2);
 			break;
 
+		/* JMD 20090623: Needed for Windows 2008 support
+		   http://msdn.microsoft.com/en-us/library/cc232104(PROT.13).aspx
+		   IRP Query Volume Information class: 0x07 */
+		case FileFsFullSizeInformation:
+			printf("Called FileFsFullSizeInformation\n");
+			out_uint32_le(out, stat_fs.f_blocks);	/* TotalAllocationUnits */
+			out_uint32_le(out, 0);	
+			out_uint32_le(out, stat_fs.f_bavail);	/* CallerAvailableAllocationUnits */
+			out_uint32_le(out, 0);	
+			out_uint32_le(out, stat_fs.f_bfree);	/* ActualAvailableAllocationUnits */
+			out_uint32_le(out, 0);	
+			out_uint32_le(out, stat_fs.f_bsize / 0x200);	/* SectorsPerAllocationUnit */
+			out_uint32_le(out, 0x200);	/* Bytes per sector */
+			break;
+
 		case FileFsLabelInformation:
 		case FileFsDeviceInformation:
 		case FileFsControlInformation:
-		case FileFsFullSizeInformation:
 		case FileFsObjectIdInformation:
 		case FileFsMaximumInformation:
 
