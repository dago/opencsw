From 5732afdaaa749b7caf4757c1d6f7b92c87bf5e5b Mon Sep 17 00:00:00 2001
From: Dagobert Michelsen <dam@opencsw.org>
Date: Tue, 11 Nov 2014 15:27:55 +0100
Subject: [PATCH] Fix for latest autotools

---
 ijs/Makefile.am  | 4 +++-
 ijs/autogen.sh   | 4 ++--
 ijs/configure.ac | 7 ++++---
 3 files changed, 9 insertions(+), 6 deletions(-)

diff --git a/ijs/Makefile.am b/ijs/Makefile.am
index 6ca2adf..50c5755 100644
--- a/ijs/Makefile.am
+++ b/ijs/Makefile.am
@@ -23,7 +23,9 @@
 
 ## Process this file with automake to produce Makefile.in.
 
-AUTOMAKE_OPTIONS = 1.8 foreign dist-bzip2 no-dependencies
+AUTOMAKE_OPTIONS = 1.6 foreign dist-bzip2 no-dependencies
+
+ACLOCAL_AMFLAGS = -I m4
 
 @SET_MAKE@
 
diff --git a/ijs/autogen.sh b/ijs/autogen.sh
index 4e346eb..3b3c509 100755
--- a/ijs/autogen.sh
+++ b/ijs/autogen.sh
@@ -51,7 +51,7 @@ VERSIONGREP="sed -e s/.*[^0-9\.]\([0-9]\.[0-9]\).*/\1/"
   echo
   else
     echo -n "checking for automake $AM_NEEDED or later... "
-    for am in automake-$AM_NEEDED automake$AM_NEEDED automake; do
+    for am in automake automake-$AM_NEEDED automake$AM_NEEDED automake; do
       ($am --version < /dev/null > /dev/null 2>&1) || continue
       AM_MAJOR=`echo $AM_NEEDED |cut -d. -f1`
       AM_MINOR=`echo $AM_NEEDED |cut -d. -f2`
@@ -65,7 +65,7 @@ VERSIONGREP="sed -e s/.*[^0-9\.]\([0-9]\.[0-9]\).*/\1/"
     done
     test -z $AUTOMAKE &&  echo "no"
     echo -n "checking for aclocal $AM_NEEDED or later... "
-    for ac in aclocal-$AM_NEEDED aclocal$AM_NEEDED aclocal; do
+    for ac in aclocal aclocal-$AM_NEEDED aclocal$AM_NEEDED aclocal; do
       ($ac --version < /dev/null > /dev/null 2>&1) || continue
       AM_MAJOR=`echo $AM_NEEDED |cut -d. -f1`
       AM_MINOR=`echo $AM_NEEDED |cut -d. -f2`
diff --git a/ijs/configure.ac b/ijs/configure.ac
index df0260f..f0fae9f 100644
--- a/ijs/configure.ac
+++ b/ijs/configure.ac
@@ -51,6 +51,7 @@ pushdef([IJS_VERSION], IJS_MAJOR_VERSION.IJS_MINOR_VERSION[]IJS_EXTRA_VERSION)
 
 AC_INIT(IJS_NAME, IJS_VERSION, [inkjet-list@linuxprinting.org])
 AC_PREREQ(2.53)
+AC_CONFIG_MACRO_DIR([m4])
 AC_CONFIG_SRCDIR(ijs.c)
 AC_REVISION($Revision: 5783 $)
 
@@ -84,7 +85,7 @@ popdef([IJS_INTERFACE_AGE])
 popdef([IJS_BINARY_AGE])
 
 dnl Initialize automake stuff.
-AM_INIT_AUTOMAKE(IJS_NAME, IJS_VERSION)
+AM_INIT_AUTOMAKE
 popdef([IJS_NAME])
 popdef([IJS_VERSION])
 
@@ -117,7 +118,7 @@ AC_SUBST(LIBTOOL_DEPS)
 dnl Checks for programs
 
 AC_PROG_CC
-AM_PROG_LIBTOOL
+AC_PROG_LIBTOOL
 AC_SUBST(LIBTOOL_DEPS)
 AC_ISC_POSIX
 AC_PROG_INSTALL
@@ -140,6 +141,7 @@ case ${host_os} in
   cygwin | mingw32 | pw32 | interix3 | interix | uwin) libijs_sysdeps="windows";;
   *) libijs_sysdeps="unix";;
 esac
+
 AM_CONDITIONAL(SYSDEPS_WINDOWS, test x$libijs_sysdeps = xwindows)
 
 
@@ -151,7 +153,6 @@ AC_SUBST(IJS_VERSION)
 AC_SUBST(ijs_cflags)
 ijs_libs="${IJS_LIBS} ${IJS_DEPLIBS}"
 AC_SUBST(ijs_libs)
-AC_SUBST(INCLUDES)
 LIBIJS_LIBS="${LIBIJS_LIBS} ${IJS_DEPLIBS}"
 AC_SUBST(LIBIJS_LIBS)
 
-- 
2.0.3

