From 2ba932c4eae0e0750b21f72ca1952adaf110363a Mon Sep 17 00:00:00 2001
From: Dominic Cleal <dcleal@redhat.com>
Date: Wed, 4 Jan 2012 00:46:33 +0100
Subject: [PATCH] Enabled strchrnul gnulib module and rebuilt auto*

(upstream commit: 0d8d8882)
---
 ChangeLog                     |  596 ++++++++++++++++++++++-------------------
 Makefile.in                   |    2 +
 aclocal.m4                    |  452 +-------------------------------
 config.h.in                   |   12 +
 configure                     |  181 ++++++++++++-
 doc/Makefile.in               |    2 +
 doc/naturaldocs/Makefile.in   |    2 +
 examples/Makefile.in          |    2 +
 gnulib/lib/Makefile.am        |   20 ++-
 gnulib/lib/Makefile.in        |   27 ++-
 gnulib/lib/rawmemchr.c        |  136 ++++++++++
 gnulib/lib/rawmemchr.valgrind |   12 +
 gnulib/lib/strchrnul.c        |  142 ++++++++++
 gnulib/lib/strchrnul.valgrind |   12 +
 gnulib/m4/gnulib-comp.m4      |   22 ++
 gnulib/m4/rawmemchr.m4        |   21 ++
 gnulib/m4/strchrnul.m4        |   21 ++
 gnulib/tests/Makefile.am      |   16 ++
 gnulib/tests/Makefile.in      |  118 +++++---
 gnulib/tests/test-rawmemchr.c |   92 +++++++
 gnulib/tests/test-readlink.h  |    2 +-
 gnulib/tests/test-strchrnul.c |   86 ++++++
 man/Makefile.in               |    2 +
 man/augparse.1                |    2 +-
 src/Makefile.in               |    2 +
 tests/Makefile.in             |    2 +
 26 files changed, 1190 insertions(+), 794 deletions(-)
 create mode 100644 gnulib/lib/rawmemchr.c
 create mode 100644 gnulib/lib/rawmemchr.valgrind
 create mode 100644 gnulib/lib/strchrnul.c
 create mode 100644 gnulib/lib/strchrnul.valgrind
 create mode 100644 gnulib/m4/rawmemchr.m4
 create mode 100644 gnulib/m4/strchrnul.m4
 create mode 100644 gnulib/tests/test-rawmemchr.c
 create mode 100644 gnulib/tests/test-strchrnul.c

diff --git a/ChangeLog b/ChangeLog
index a7764d4..e93e7a5 100644
--- a/ChangeLog
+++ b/ChangeLog
@@ -1,3 +1,7 @@
+2011-12-02  David Lutterkort  <lutter@redhat.com>
+
+	Version 0.10.0
+
 2011-12-02  Dominic Cleal  <dcleal@redhat.com>
 
 	Implement escape sequences for whitespace, quotes and square brackets in command arguments to match Puppet provider.
@@ -19,7 +23,7 @@
 
 	Add documentation to test_aliases.aug
 
-2011-12-01  David Lutterkort  <lutter@redhat.com>
+2011-12-02  David Lutterkort  <lutter@redhat.com>
 
 	* src/augtool.c (print_aug_error): print newline after error details
 
@@ -56,6 +60,8 @@
 	  * src/augtool.c: call aug_init with AUG_NO_ERR_CLOSE and print errors on
 	    initialization failure
 
+2011-12-01  David Lutterkort  <lutter@redhat.com>
+
 	Update documentation for augtool/augrun and man page
 
 	Adjust more copyright notices
@@ -115,32 +121,32 @@
 
 	Better integration of tests in NaturalDocs, verbatim code display in doc.
 
-2011-11-30  RaphaÃ«l Pinson  <raphink@gmail.com>
-
 	Add unit tests for aug_to_xml
 
+2011-11-30  RaphaÃ«l Pinson  <raphink@gmail.com>
+
 	libaugeas must now be linked to libxml, too.
 
 2011-11-30  Dominic Cleal  <dcleal@redhat.com>
 
 	* augeas.spec.in: add build req on libxml2-devel
 
-2011-11-29  RaphaÃ«l Pinson  <raphink@gmail.com>
+2011-11-30  RaphaÃ«l Pinson  <raphink@gmail.com>
 
 	Add an Examples section to reprepro_uploaders.aug's header
 
 	ARG_CHECK errors when condition is met. Invert conditions in aug_to_xml.
 
-2011-11-29  Francis Giraldeau  <francis.giraldeau@gmail.com>
+2011-11-30  Francis Giraldeau  <francis.giraldeau@gmail.com>
 
 	Sudoers: add more parameter flags/options
 	Fixes bug #143
 
-2011-11-29  RaphaÃ«l Pinson  <raphink@gmail.com>
+2011-11-30  RaphaÃ«l Pinson  <raphink@gmail.com>
 
 	Add aug_to_xml to public API
 
-2011-11-29  David Lutterkort  <lutter@redhat.com>
+2011-11-30  David Lutterkort  <lutter@redhat.com>
 
 	New error code AUG_EBADARG and ARG_CHECK macro
 	Use ARG_CHECK to check arguments passed through the public API for
@@ -175,7 +181,7 @@
 
 	Improve CSS for NaturalDocs
 
-2011-11-28  Dominic Cleal  <dcleal@redhat.com>
+2011-11-29  Dominic Cleal  <dcleal@redhat.com>
 
 	augtool: change readline tab completion to be context-aware
 
@@ -184,10 +190,12 @@
 	changing relative paths into absolute paths.  The context is stored in
 	/augeas/context and defaults to the value "/files".
 
-2011-11-28  David Lutterkort  <lutter@redhat.com>
+2011-11-29  David Lutterkort  <lutter@redhat.com>
 
 	* src/transform.c (load_file): fix segfault when storing span in NULL tree
 
+2011-11-28  David Lutterkort  <lutter@redhat.com>
+
 	* src/syntax.c (print_tree): print something for a NULL tree
 
 2011-11-28  RaphaÃ«l Pinson  <raphink@gmail.com>
@@ -218,8 +226,6 @@
 
 	Add elif support to shellvars.aug
 
-2011-11-22  RaphaÃ«l Pinson  <raphink@gmail.com>
-
 	Add big WARNING to aptconf.aug
 
 	Register modules.aug with naturaldocs
@@ -260,12 +266,12 @@
 
 	Refactor modprobe.aug: * Parse commands in install/remove stanzas; * Drop support for include as it is not documented in manpages and no unit tests are shipped.
 
-2011-11-21  RaphaÃ«l Pinson  <raphink@gmail.com>
-
 	Fix unpriviliged into unpriviliged in test_postfix_master.aug, too.
 
 	Add one-liner unit test for shellvars.aug
 
+2011-11-21  RaphaÃ«l Pinson  <raphink@gmail.com>
+
 	shellvars.aug: Refactor lens, add end-of-line comment support, if/then/else/fi conditionals, one-liners support
 
 	phpvars.aug: Add test for bash-style comment, improve eol comments, use generic_function in simple_function definition
@@ -337,7 +343,7 @@
 
 	Fix origin entries in aptpreferences.aug
 
-2011-11-15  Dominic Cleal  <dcleal@redhat.com>
+2011-11-16  Dominic Cleal  <dcleal@redhat.com>
 
 	Resolv: Permit end-of-line comments
 	Fixes ticket #223
@@ -345,15 +351,15 @@
 	Krb5: Allow a [pam] section for pam_krb5 (possibly deprecated)
 	Fixes ticket #225
 
-2011-11-15  Roman Rakus  <rrakus@redhat.com>
+2011-11-16  Roman Rakus  <rrakus@redhat.com>
 
 	Kdump: new lens and tests
 
-2011-11-15  Dominic Cleal  <dcleal@redhat.com>
+2011-11-16  Dominic Cleal  <dcleal@redhat.com>
 
 	aug_srun: add 'insert' and 'move' command aliases to 'ins' and 'mv'
 
-2011-11-15  Michael Chapman  <mike@very.puzzling.org>
+2011-11-16  Michael Chapman  <mike@very.puzzling.org>
 
 	Dhcpd: slashes must be double-quoted
 	In dhcpd.conf, tokens containing slashes must be double-quoted.
@@ -381,7 +387,7 @@
 	RHEL 5 uses /etc/dhcpd.conf.
 	RHEL 6 uses /etc/dhcp/dhcpd.conf.
 
-2011-11-15  David Lutterkort  <lutter@redhat.com>
+2011-11-16  David Lutterkort  <lutter@redhat.com>
 
 	Mdadm: use case-insensitive regexps
 
@@ -393,15 +399,15 @@
 	totalize used to create transitions into the crash state that did
 	transition on upper case letters, violating the convention.
 
-2011-11-13  David Lutterkort  <lutter@redhat.com>
+2011-11-14  David Lutterkort  <lutter@redhat.com>
 
 	* src/builtin.c (regexp_match): new helper to test a regexp
 
-2011-11-13  Matthew Booth  <mbooth@redhat.com>
+2011-11-14  Matthew Booth  <mbooth@redhat.com>
 
 	Mdadm_conf: new lens for /etc/mdadm.conf
 
-2011-11-13  David Lutterkort  <lutter@redhat.com>
+2011-11-14  David Lutterkort  <lutter@redhat.com>
 
 	* lenses/tests/test_iptables.aug: fix syntax error
 
@@ -591,7 +597,7 @@
 
 	Add functionalities, refactor volume by type of disk_config entry and add tests to fai_diskconfig.aug
 
-2011-09-01  David Lutterkort  <lutter@redhat.com>
+2011-09-02  David Lutterkort  <lutter@redhat.com>
 
 	* src/pathx.c (nodeset_as_regexp): match nothing if nodeset is empty
 	This makes sure that constructs like 'glob(no_such_node)' or
@@ -604,8 +610,6 @@
 	This patch fixes autosave in the case only one command is provided as
 	arguments and adds a test that checks proper handling of this case.
 
-2011-08-31  Francis Giraldeau  <francis.giraldeau@gmail.com>
-
 	Disable autoload transform for the fai_diskconfig
 	Autoload transform with only standard exclude makes failing the glob_for_lens
 	xpath test. fai_diskconfig does this. As a temporary fix, we disable transform
@@ -665,19 +669,21 @@
 	Spacevars: rename toplevel lens to lns
 	Leave simple_lns as an alias for backwards compatibility
 
-2011-08-08  David Lutterkort  <lutter@redhat.com>
+2011-08-09  David Lutterkort  <lutter@redhat.com>
 
 	* examples/fadot.c: accept -h option to print usage
 
-2011-07-25  David Lutterkort  <lutter@redhat.com>
+2011-07-26  David Lutterkort  <lutter@redhat.com>
 
 	.gitignore: ignore tests/test-run
 
 	Version 0.9.0
 
+2011-07-25  David Lutterkort  <lutter@redhat.com>
+
 	Minor fixes to make distcheck pass
 
-2011-07-22  David Lutterkort  <lutter@redhat.com>
+2011-07-23  David Lutterkort  <lutter@redhat.com>
 
 	path expressions: parse [expr1 or expr2] correctly
 	Since commit ea010d85, we would interpret the predicate [e1 or e2] as
@@ -687,6 +693,8 @@
 
 	Of course, this is a heinous hack.
 
+2011-07-22  David Lutterkort  <lutter@redhat.com>
+
 	Migrate tests from test-mv.sh into run.tests
 
 	aug_srun: new API call
@@ -705,12 +713,12 @@
 
 	Aliases: allow spaces and commas in aliases; add docs
 
-2011-07-11  Dominic Cleal  <dcleal@redhat.com>
+2011-07-12  Dominic Cleal  <dcleal@redhat.com>
 
 	Sudoers: support users:groups format in a Runas_Spec line for sudo -g
 	Fixes ticket #211
 
-2011-07-11  David Lutterkort  <lutter@redhat.com>
+2011-07-12  David Lutterkort  <lutter@redhat.com>
 
 	* tests/test-bug-1.sh: fix test
 	The test caused an augtool failure for all the wrong reasons
@@ -780,10 +788,12 @@
 
 	* examples/fadot.c: include <config.h>, link against GNULIB
 
-2011-05-10  David Lutterkort  <lutter@redhat.com>
+2011-05-11  David Lutterkort  <lutter@redhat.com>
 
 	tests: expand what the valgrind target runs
 
+2011-05-10  David Lutterkort  <lutter@redhat.com>
+
 	* src/pathx.c: rename CHECK_ERROR{,_RET0} to RET{,0}_ON_ERROR
 	This should make it harder to misuse them and cause memory leaks
 
@@ -838,10 +848,12 @@
 
 	Fixes BZ 700608
 
-2011-04-15  David Lutterkort  <lutter@redhat.com>
+2011-04-16  David Lutterkort  <lutter@redhat.com>
 
 	Version 0.8.1
 
+2011-04-15  David Lutterkort  <lutter@redhat.com>
+
 	Iptables: handle --tcp-flags
 	Fixes bug #157
 
@@ -891,8 +903,6 @@
 	Httpd: include /etc/httpd/conf/httpd.conf used on Fedora/RHEL
 	Fixes https://bugzilla.redhat.com/show_bug.cgi?id=688149
 
-2011-03-22  David Lutterkort  <lutter@redhat.com>
-
 	* src/lexer.l: fix a few compilation warnings
 
 	Eliminate global variable 'comment_depth' in lexer
@@ -910,7 +920,7 @@
 
 	Add support for #includedir in sudoers.aug and test (ticket #188)
 
-2011-03-17  Francis Giraldeau  <francis.giraldeau@gmail.com>
+2011-03-18  Francis Giraldeau  <francis.giraldeau@gmail.com>
 
 	Support sudoers in nsswitch.aug
 	nsswitch.conf support a configuration item to specify database backend, this
@@ -938,7 +948,7 @@
 
 	Add FreeBSD /etc/rc.conf file to Shellvars lens.
 
-2011-03-15  David Lutterkort  <lutter@redhat.com>
+2011-03-16  David Lutterkort  <lutter@redhat.com>
 
 	Replace erroneous assert(0) with proper error report
 	  * src/put.c (create_union): report an error to the user if none of the
@@ -973,7 +983,7 @@
 	  * src/try: read commands from build/augcmds.txt rather than /tmp; use a
 	    more sensible default if augcmds.txt does not exist
 
-2011-03-03  Matthew Booth  <mbooth@redhat.com>
+2011-03-04  Matthew Booth  <mbooth@redhat.com>
 
 	Use getopt-gnu from gnulib for AIX support
 
@@ -1007,7 +1017,7 @@
 
 	Changes in nrpe.aug Remove wrong ^ in comment regex Use Util.comment_generic Use generic modules Improve NaturalDocs documentation
 
-2011-02-23  David Lutterkort  <lutter@redhat.com>
+2011-02-24  David Lutterkort  <lutter@redhat.com>
 
 	Version 0.8.0
 
@@ -1026,7 +1036,7 @@
 
 	Split Solaris multiboot argument for the kernel path into @path node (ticket #158)
 
-2011-02-22  Francis Giraldeau  <francis.giraldeau@gmail.com>
+2011-02-23  Francis Giraldeau  <francis.giraldeau@gmail.com>
 
 	Add aug_span API function V2
 	aug_span API function provides information about the node of the specified
@@ -1067,7 +1077,7 @@
 
 	Allow indentation for "iface" entries in interfaces.aug (Fix ticket #182) Add unit test for "iface" indentation
 
-2011-02-16  Francis Giraldeau  <francis.giraldeau@gmail.com>
+2011-02-17  Francis Giraldeau  <francis.giraldeau@gmail.com>
 
 	Minor code format cleanup
 	  * Cut long lines to 80 chars
@@ -1081,7 +1091,7 @@
 
 	Add comment_c_style and comment_multiline Add empty_generic and make empty a call to it Add empty_c_style to complement comment_c_style
 
-2011-02-15  Francis Giraldeau  <francis.giraldeau@gmail.com>
+2011-02-16  Francis Giraldeau  <francis.giraldeau@gmail.com>
 
 	Fix segfault in get.c with L_MAYBE lens (bug#180)
 	When a L_MAYBE lens was the last child of a L_CONCAT inside a L_SUBTREE, then
@@ -1100,17 +1110,17 @@
 
 	Improve vim syntax file
 
-2011-02-14  David Lutterkort  <lutter@redhat.com>
+2011-02-15  David Lutterkort  <lutter@redhat.com>
 
 	man pages: update man page for augtool
 
-2011-02-14  RaphaÃ«l Pinson  <raphink@gmail.com>
+2011-02-15  RaphaÃ«l Pinson  <raphink@gmail.com>
 
 	augtool: add --interactive option
 	This option runs an interactive shell after evaluating STDIN or an explicit
 	inputfile
 
-2011-02-14  David Lutterkort  <lutter@redhat.com>
+2011-02-15  David Lutterkort  <lutter@redhat.com>
 
 	Mysql: change default comment delimiter from ';' to '#'
 	Fixes bug #181 reported by devzero
@@ -1137,7 +1147,7 @@
 	* Allow directives without arguments in httpd.aug
 	* Adjust test_httpd.aug to test argument-less directives
 
-2011-01-25  Francis Giraldeau  <francis.giraldeau@gmail.com>
+2011-01-26  Francis Giraldeau  <francis.giraldeau@gmail.com>
 
 	Fix httpd.aug doc, filter and add to checks
 	  * Added other contributors to authors
@@ -1156,16 +1166,16 @@
 	are separated by spaces and it raises ambiguity when using unquoting. The lens
 	doesn't support either long lines splitted by backslash.
 
-2011-01-25  David Lutterkort  <lutter@redhat.com>
+2011-01-26  David Lutterkort  <lutter@redhat.com>
 
 	* src/pathx.c (store_error): make sure pos_str is always NUL terminated
 	Fixes bug #178
 
-2011-01-19  Fred  <frederic.lespez@free.fr>
+2011-01-20  Fred  <frederic.lespez@free.fr>
 
 	PuppetFileserver: new lens for Puppet's fileserver.conf
 
-2011-01-19  David Lutterkort  <lutter@redhat.com>
+2011-01-20  David Lutterkort  <lutter@redhat.com>
 
 	* man/augtool.pod: fix typos
 	Fixes https://bugzilla.redhat.com/show_bug.cgi?id=628502
@@ -1178,7 +1188,7 @@
 	  * src/pathx.c (coerce_to_bool, eval_pred): make sure we return something
 	    when assert(0) is compiled away
 
-2011-01-13  Francis Giraldeau  <francis.giraldeau@gmail.com>
+2011-01-14  Francis Giraldeau  <francis.giraldeau@gmail.com>
 
 	Fix a small bashism from test script
 
@@ -1189,7 +1199,7 @@
 
 	Fixes bug #175
 
-2011-01-11  David Lutterkort  <lutter@redhat.com>
+2011-01-12  David Lutterkort  <lutter@redhat.com>
 
 	Replace augtest by test-augtool.sh
 	This removes the silly dependency on Ruby, since augtest was the only
@@ -1224,8 +1234,6 @@
 
 	In autosave mode, print "save" when in echo or interactive mode. Remove comma at the end of enum list.
 
-2011-01-10  RaphaÃ«l Pinson  <raphink@gmail.com>
-
 	Refactor augtool.c to use only readline
 
 	augtool: add --autosave option
@@ -1236,7 +1244,7 @@
 
 	Fixes ticket #172
 
-2011-01-07  David Lutterkort  <lutter@redhat.com>
+2011-01-08  David Lutterkort  <lutter@redhat.com>
 
 	bootstrap: add sys_wait module
 	Fixes bug #164
@@ -1373,8 +1381,6 @@
 	  * tests/modules/pass_square.aug: unit tests to validate the square lens,
 	    regular and recursives
 
-2010-12-09  Francis Giraldeau  <francis.giraldeau@usherbrooke.ca>
-
 	Add test for lens-access.sh in Makefile
 
 2010-12-02  RaphaÃ«l Pinson  <raphink@gmail.com>
@@ -1389,7 +1395,7 @@
 
 	Fix GPL into LGPLv2+ for a series of lenses.
 
-2010-11-24  Francis Giraldeau  <francis.giraldeau@gmail.com>
+2010-11-25  Francis Giraldeau  <francis.giraldeau@gmail.com>
 
 	Ignore eclipse project files
 
@@ -1522,10 +1528,12 @@
 
 	Fix example in lens
 
-2010-11-02  Raphael Pinson  <raphink@gmail.com>
+2010-11-03  Raphael Pinson  <raphink@gmail.com>
 
 	Add a few lenses to Menu.txt
 
+2010-11-02  Raphael Pinson  <raphink@gmail.com>
+
 	Add shells.aug and associated test
 
 2010-11-01  Raphael Pinson  <raphink@gmail.com>
@@ -1552,17 +1560,19 @@
 
 	Use generic modules in bbhosts.aug
 
-2010-10-26  Francis Giraldeau  <francis.giraldeau@gmail.com>
+2010-10-27  Francis Giraldeau  <francis.giraldeau@gmail.com>
 
 	Fixes bug #144: wrong behavior of iter concat
 	This patch fix the list_tail_cons macro to fastforward the tail list when
 	the first item is added to the list, otherwise if the first item added when
 	the list is NULL has two item, the tail points the the first item.
 
-2010-10-26  Raphael Pinson  <raphink@gmail.com>
+2010-10-27  Raphael Pinson  <raphink@gmail.com>
 
 	Fix filter to use proper file
 
+2010-10-26  Raphael Pinson  <raphink@gmail.com>
+
 	Remove trailing whitespace
 
 	Add nsswitch.aug and associated test
@@ -1620,11 +1630,9 @@
 
 	Improve keepalived.aug
 
-2010-09-23  RaphaÃ«l Pinson  <raphink@gmail.com>
-
 	Add a lens for keepalived.conf and associated test
 
-2010-09-23  David Lutterkort  <lutter@redhat.com>
+2010-09-24  David Lutterkort  <lutter@redhat.com>
 
 	Preserve parse errors under /augeas//error
 	With the changes in commit 5ee81630, a subtree in /augeas/files that is
@@ -1651,7 +1659,7 @@
 
 	Odbc: new lens and tests.
 
-2010-09-15  David Lutterkort  <lutter@redhat.com>
+2010-09-16  David Lutterkort  <lutter@redhat.com>
 
 	When setting a tree node to the value it already has, do not modify the tree
 
@@ -1698,10 +1706,12 @@
 	* src/get.c (visit_exit): fix segfault from empty stack for L_MAYBE
 	Fixes bug #136
 
-2010-08-06  David Lutterkort  <lutter@redhat.com>
+2010-08-07  David Lutterkort  <lutter@redhat.com>
 
 	Version 0.7.3
 
+2010-08-06  David Lutterkort  <lutter@redhat.com>
+
 	Fix behavior of aug_defnode
 	  (1) Make sure that the definition of the variable is recorded under
 	      /augeas/variables
@@ -1754,7 +1764,7 @@
 	Limits: also look for files in /etc/security/limits.d
 	Suggested by David Timms
 
-2010-07-23  Tim Stoop  <tim.stoop@gmail.com>
+2010-07-24  Tim Stoop  <tim.stoop@gmail.com>
 
 	Mysql: lens for MySQL's *.cnf files
 
@@ -1785,10 +1795,12 @@
 	If the user writes 'let rec l = rhs' and the RHS does not mention l, just
 	mark the lens as regular and carry on.
 
-2010-07-21  David Lutterkort  <lutter@redhat.com>
+2010-07-22  David Lutterkort  <lutter@redhat.com>
 
 	* src/syntax.c (load_module_file): make sure we report an error
 
+2010-07-21  David Lutterkort  <lutter@redhat.com>
+
 	Fix segfault in glue routines; add test for the fix
 	The tree_*_glue functions did not set the error struct when parsing a path;
 	this caused a segfault when trying to insert before/after a non-existant
@@ -1824,11 +1836,11 @@
 
 	Adding is_scan in the condition to accept an item
 
-2010-06-30  Matthew Booth  <mbooth@redhat.com>
+2010-07-01  Matthew Booth  <mbooth@redhat.com>
 
 	Device_map: new lens for grub's device.map
 
-2010-06-29  David Lutterkort  <lutter@redhat.com>
+2010-06-30  David Lutterkort  <lutter@redhat.com>
 
 	Avoid unnecessary file parsing when reloading the tree
 	We used to reparse every file we knew about upon aug_load. Now, we only
@@ -1861,6 +1873,8 @@
 	  * tests/cutest.c (run): add impl
 	  * tests/test-save.c (run): remove
 
+2010-06-29  David Lutterkort  <lutter@redhat.com>
+
 	Redefine all variables upon load
 	This is a slight change in behavior: before, we used to just discard the
 	contents of all variables upon load. Now, we redefine variables by
@@ -1917,14 +1931,14 @@
 	* lenses/shellvars_array.aug: new lens
 	* lenses/tests/test_shellvars_array.aug: test for new lens
 
-2010-05-13  David Lutterkort  <lutter@redhat.com>
+2010-05-14  David Lutterkort  <lutter@redhat.com>
 
 	Add modules_conf to naturaldocs Menu
 
 	Add /etc/modules.conf from hell
 	Actually, from http://www.janerob.com/rob/ts5100/modules.conf
 
-2010-05-13  Matthew Booth  <mbooth@redhat.com>
+2010-05-14  Matthew Booth  <mbooth@redhat.com>
 
 	Modules_conf: new lens for modules.conf and conf.modules
 
@@ -1989,8 +2003,6 @@
 	* tests/test-save.c: use proper includes for WIFEXITED
 	Without them, the build fails on FreeBSD
 
-2010-04-20  David Lutterkort  <lutter@redhat.com>
-
 	Debctrl (multi_line_entry): fix bad regexp
 	The lens 'del /^ / " "' is not valid, since we do not allow '^' as a meta
 	character. Changing that to 'del / / " "' exposed a typecheck problem in
@@ -2005,13 +2017,15 @@
 
 	  * tests/fatest.c (testExpandCharRanges): test escaping of literal '|'
 
-2010-04-19  David Lutterkort  <lutter@redhat.com>
+2010-04-20  David Lutterkort  <lutter@redhat.com>
 
 	* tests/fatest.c (print_regerror): do not use alloca
 
 	* bootstrap: pull in isblank explicitly
 	Fixes bug #111
 
+2010-04-19  David Lutterkort  <lutter@redhat.com>
+
 	* src/lens.c (lns_check_rec): fix refcounting mistake on error path
 	Fixes bug #120
 
@@ -2043,30 +2057,30 @@
 
 	* src/jmt.c (build_tree): print debug output for build_nullable
 
-2010-03-12  David Lutterkort  <lutter@redhat.com>
+2010-03-13  David Lutterkort  <lutter@redhat.com>
 
 	* lenses/tests/test_logrotate.aug: add test for files separated by newlines
 	This test the fix for bug #104, commit fe0453ce.
 
-2010-03-11  David Lutterkort  <lutter@redhat.com>
+2010-03-12  David Lutterkort  <lutter@redhat.com>
 
 	* lenses/group.aug (password): remove backslashes
 	Backslashes in char classes are taken literally, they do not escape a
 	character.
 
-2010-03-11  root  <root@lx200.costest.lrz.de>
+2010-03-12  root  <root@lx200.costest.lrz.de>
 
 	Group: Added disabled password support
 	* lenses/group.aug: '*' and '!' are allowed chars for disabled password
 	* lenses/tests/test_group.aug: added test for lens change
 
-2010-03-11  David Lutterkort  <lutter@redhat.com>
+2010-03-12  David Lutterkort  <lutter@redhat.com>
 
 	* src/lens.c (lns_check_rec): avoid use of uninitialized 'result'
 	The ensures can fail, and we check whether result is NULL in the error
 	path.
 
-2010-03-05  David Lutterkort  <lutter@redhat.com>
+2010-03-06  David Lutterkort  <lutter@redhat.com>
 
 	* src/lens.c (lns_format_atype): format L_REC lenses
 
@@ -2081,7 +2095,7 @@
 
 	Approx: allow keywords starting with '$'
 
-2010-03-04  David Lutterkort  <lutter@redhat.com>
+2010-03-05  David Lutterkort  <lutter@redhat.com>
 
 	Approx: lens and test for the approx proxy server
 
@@ -2130,7 +2144,7 @@
 
 	Debctrl: new lens and test
 
-2010-02-23  David Lutterkort  <lutter@redhat.com>
+2010-02-24  David Lutterkort  <lutter@redhat.com>
 
 	Ntp: add 'tinker' directive
 	Fixes bug #103
@@ -2138,7 +2152,7 @@
 	Logrotate: tolerate whitespace at the end of a line
 	Fixes bug #101
 
-2010-02-23  Raphael Pinson  <raphink@gmail.com>
+2010-02-24  Raphael Pinson  <raphink@gmail.com>
 
 	Dhclient: add rfc code parsing
 	Fixes bug #107
@@ -2168,7 +2182,7 @@
 
 	Nagisocfg: lens and test for /etc/nagios3/nagios.cfg
 
-2010-02-12  Ivana Hutarova Varekova  <varekova@redhat.com>
+2010-02-13  Ivana Hutarova Varekova  <varekova@redhat.com>
 
 	Cgrules: new lens and test
 	See cgrules.conf for http://libcg.sourceforge.net/
@@ -2188,8 +2202,6 @@
 	Instead of dumping raw regular expressions for the tree encoding, print out
 	something resembling our tree notation.
 
-2010-02-08  David Lutterkort  <lutter@redhat.com>
-
 	libfa: handle the syntax r{min,} properly
 	  * src/fa.c (parse_repeated_regexp): set max = -1 when we see r{min,};
 	    (re_iter_as_string): when max == -1, print r{min,}
@@ -2197,6 +2209,8 @@
 
 	* src/fa.c (parse_int): flag not parsing anything as an error
 
+2010-02-08  David Lutterkort  <lutter@redhat.com>
+
 	* src/jmt.c: add caller filtering
 	Caller filtering is needed to weed out seemingly ambiguous parse trees (see
 	Section 5.3 of Jim/Mandelbaum's paper)
@@ -2221,7 +2235,7 @@
 
 	Sshd: allow optional arguments in subsystem commands
 
-2010-01-27  David Lutterkort  <lutter@redhat.com>
+2010-01-28  David Lutterkort  <lutter@redhat.com>
 
 	* src/augeas.c (tree_replace): don't bother marking the new parent as dirty
 	We call tree_rm on it earlier, which already marks it as dirty.
@@ -2234,7 +2248,7 @@
 	* src/get.c (no_match_error): initialize lname
 	Otherwise, gcc complains about a possibly uninitialized value with -O2
 
-2010-01-25  David Lutterkort  <lutter@redhat.com>
+2010-01-26  David Lutterkort  <lutter@redhat.com>
 
 	Test for using a recursive lens inside other lenses
 
@@ -2301,7 +2315,7 @@
 
 	* src/get.c (struct state): make info a pointer
 
-2010-01-23  David Lutterkort  <lutter@redhat.com>
+2010-01-24  David Lutterkort  <lutter@redhat.com>
 
 	* src/lens.c (restrict_regexp): properly report OOM
 
@@ -2309,7 +2323,7 @@
 
 	Document the basics of building from git
 
-2010-01-15  David Lutterkort  <lutter@redhat.com>
+2010-01-16  David Lutterkort  <lutter@redhat.com>
 
 	* src/builtin.c: builtins for printing and inspecting lenses
 
@@ -2330,10 +2344,12 @@
 	In analogy to 'label', this lens allows setting the value of a tree node to
 	a fixed string
 
-2010-01-14  David Lutterkort  <lutter@redhat.com>
+2010-01-15  David Lutterkort  <lutter@redhat.com>
 
 	Version 0.7.0
 
+2010-01-14  David Lutterkort  <lutter@redhat.com>
+
 	Json: lens and tests for generic Json files
 
 	Tests for recursive (context free) lenses
@@ -2447,7 +2463,7 @@
 
 	* src/lens.c (subtree_atype): new function
 
-2010-01-07  David Lutterkort  <lutter@redhat.com>
+2010-01-08  David Lutterkort  <lutter@redhat.com>
 
 	Facelift for augtool
 	This makes augtool somewhat friendlier, mostly because
@@ -2459,6 +2475,8 @@
 	    be enclosed in quotes if they have spaces with predicates, e.g. you can
 	    now type 'get /foo[ last() ]'
 
+2010-01-07  David Lutterkort  <lutter@redhat.com>
+
 	Record an error if more than one lens tries to load a file
 	  * src/transform.c (file_info): new function; (transform_load): detect if
 	    more than one lens tries to load a file and record error in
@@ -2507,8 +2525,6 @@
 
 	Xinetd (name): fix bad '-' in character class
 
-2010-01-05  David Lutterkort  <lutter@redhat.com>
-
 	Do not choke on non-existing lens during save
 	  * src/transform.c (add_file_info): check that lens is non-NULL;
 	    (lens_from_name): provide detailed error message when lens lookup
@@ -2543,7 +2559,7 @@
 
 	* src/regexp.c (print_regexp): clean the regexp with fa_restrict_alphabet
 
-2009-12-18  David Lutterkort  <lutter@redhat.com>
+2009-12-19  David Lutterkort  <lutter@redhat.com>
 
 	* src/builtin.c (lens_get, lens_put): propagate errors as exceptions
 
@@ -2565,7 +2581,7 @@
 
 	* doc/ftdetect/augeas.vim: fix syntax
 
-2009-12-09  Partha Aji  <paji@redhat.com>
+2009-12-10  Partha Aji  <paji@redhat.com>
 
 	Made samba aug accept entry keys with ':' in them
 
@@ -2598,7 +2614,7 @@
 	* src/parser.y: properly initialize yylloc
 	Fixes ticket #96
 
-2009-11-25  David Lutterkort  <lutter@redhat.com>
+2009-11-26  David Lutterkort  <lutter@redhat.com>
 
 	Properly check regexp literals for syntax errors
 	  * src/regexp.h (regexp_check): new function
@@ -2630,7 +2646,7 @@
 
 	Support version pins in apt_preferences
 
-2009-11-23  David Lutterkort  <lutter@redhat.com>
+2009-11-24  David Lutterkort  <lutter@redhat.com>
 
 	* tests/Makefile.am (lens_tests): run postfix_access tests
 
@@ -2661,8 +2677,6 @@
 	happened (e.g., out-of-memory) that has already been reported in the
 	central augeas->error instance.
 
-2009-11-12  David Lutterkort  <lutter@redhat.com>
-
 	* src/info.c (print_info): do not choke on NULL info
 
 	* src/internal.h: new macros MEMCMP and MEMMOVE
@@ -2820,7 +2834,7 @@
 	/etc/ethers: new lens and test
 	The followings adds a new lens for /etc/ethers and associated test.
 
-2009-09-30  David Lutterkort  <lutter@redhat.com>
+2009-10-01  David Lutterkort  <lutter@redhat.com>
 
 	* src/augparse.c: get error details from error API
 
@@ -2873,6 +2887,8 @@
 	  - use the safe-alloc macros for allocations
 	  - abort the test when internal allocations fail
 
+2009-09-30  David Lutterkort  <lutter@redhat.com>
+
 	* src/hash.c (hash_alloc_insert): return 0/-1 for success/error
 
 	Use a proper function for make_ref
@@ -2889,7 +2905,7 @@
 	* src/transform.c: do not include canonicalize.h anymore
 	The canonicalize-lgpl gnulib module doesn't require that anymore
 
-2009-09-21  David Lutterkort  <lutter@redhat.com>
+2009-09-22  David Lutterkort  <lutter@redhat.com>
 
 	Path expressions: add regexp matching
 	Add a function regexp : string -> regexp and an operator
@@ -2920,6 +2936,8 @@
 	parser/typechecker. Now functions like pathx_first etc. report errors
 	properly.
 
+2009-09-21  David Lutterkort  <lutter@redhat.com>
+
 	Store pathx parse errors in internal error struct
 	The pathx_parse function will now store error information in a struct
 	error; we pass the one from struct augeas in and save it in the pathx.
@@ -2951,13 +2969,15 @@
 
 	Version 0.5.3
 
-2009-09-11  David Lutterkort  <lutter@redhat.com>
+2009-09-12  David Lutterkort  <lutter@redhat.com>
 
 	Man pages: update to match current augtool and augparse
 
 	Add --version option to augtool and augparse
 	Fixes bug #88
 
+2009-09-11  David Lutterkort  <lutter@redhat.com>
+
 	A couple more files for the test root
 
 	Add preceding-sibling and following-sibling axes to path expressions
@@ -2979,8 +2999,6 @@
 
 	* src/try: fix 'set annotate' for gdb
 
-2009-09-03  David Lutterkort  <lutter@redhat.com>
-
 	Transparent save of cross-device links
 	When saving to a file, we first write to a file with extension .augnew and
 	then rename that file to the actual file. This fails when the original is a
@@ -2991,9 +3009,9 @@
 	e.g. when the original file is bindmounted - in that situation, we have to
 	copy.
 
-	* src/syntax.c (print_value): use print_tree instead of dump_tree
+2009-09-03  David Lutterkort  <lutter@redhat.com>
 
-2009-09-02  David Lutterkort  <lutter@redhat.com>
+	* src/syntax.c (print_value): use print_tree instead of dump_tree
 
 	* lenses/rx.aug (fspath): simplistic regex for filesystem paths
 
@@ -3001,6 +3019,8 @@
 	When the typechecker finds lens overlap in a union's put direction, format
 	the generated example as a tree to make it more readable.
 
+2009-09-02  David Lutterkort  <lutter@redhat.com>
+
 	* src/lens.c(enc_format): remove extraneous quote
 
 	Make fa_example work for strings with embedded NUL's
@@ -3069,7 +3089,7 @@
 
 	Fixes bug #68
 
-2009-08-12  David Lutterkort  <lutter@redhat.com>
+2009-08-13  David Lutterkort  <lutter@redhat.com>
 
 	Do not assume how glob allocates gl_pathv
 	We assumed that the gl_pathv in a glob_t was allocated in a particular
@@ -3077,7 +3097,7 @@
 
 	  * src/transform.c (filter_generate): make a copy of gl_pathv
 
-2009-08-10  David Lutterkort  <lutter@redhat.com>
+2009-08-11  David Lutterkort  <lutter@redhat.com>
 
 	aug_load: cleanup variables when deleting /files
 	The first thing aug_load does is delete /augeas/files and /files. We need
@@ -3093,7 +3113,7 @@
 
 	Pass symtab explicitly into pathx_symtab_remove_descendants
 
-2009-08-06  David Lutterkort  <lutter@redhat.com>
+2009-08-07  David Lutterkort  <lutter@redhat.com>
 
 	Record new files under /augeas/files when they are saved
 	  * src/transform.c (transform_save): add file info with add_file_info
@@ -3207,7 +3227,7 @@
 	ls -lZ $hosts | cut -d ' ' -f 5.  The latter fails with some
 	combinations of ls and SELinux.
 
-2009-07-16  David Lutterkort  <lutter@redhat.com>
+2009-07-17  David Lutterkort  <lutter@redhat.com>
 
 	* src/Makefile.am: link libfa with gnulib, needed on AIX
 
@@ -3215,11 +3235,11 @@
 
 	* doc/augeas.vim: vi syntax highlighting for .aug files
 
-2009-07-13  David Lutterkort  <lutter@redhat.com>
+2009-07-14  David Lutterkort  <lutter@redhat.com>
 
 	Version 0.5.2
 
-2009-07-09  David Lutterkort  <lutter@redhat.com>
+2009-07-10  David Lutterkort  <lutter@redhat.com>
 
 	tree handling: propagate dirty flag into root
 	We had an off-by-one error in tree_mark_dirty that lead to the root of the
@@ -3234,13 +3254,15 @@
 
 	This bug was introduced in commit 7278965b
 
-2009-07-08  David Lutterkort  <lutter@redhat.com>
+2009-07-09  David Lutterkort  <lutter@redhat.com>
 
 	Ntp: allow additional options for server etc.
 	Allow options listed on http://doc.ntp.org/4.2.4/confopt.html
 
 	Fixes bug #72 reported by Micah
 
+2009-07-08  David Lutterkort  <lutter@redhat.com>
+
 	Shellvars: allow backticks as quote characters
 	  * lenses/shellvars.aug (simple_value): allow backticks as quotes
 	  * lenses/tests/test_shellvars.aug: add tests
@@ -3276,7 +3298,7 @@
 
 	Reported and fix suggested by Jeff Johnson <n3npq@mac.com>
 
-2009-06-26  Jim Meyering  <meyering@redhat.com>
+2009-06-27  Jim Meyering  <meyering@redhat.com>
 
 	tests: divide test-lenses.sh into its 54 independent tests
 	This permits these tests to be run in parallel.
@@ -3297,7 +3319,7 @@
 	* configure.ac: Require automake-1.11.
 	Enable color-tests parallel-tests.  Use AM_SILENT_RULES([yes])
 
-2009-06-26  Marc Fournier  <marc.fournier@camptocamp.com>
+2009-06-27  Marc Fournier  <marc.fournier@camptocamp.com>
 
 	Yum: also read files in /etc/yum/pluginconf.d
 
@@ -3321,7 +3343,7 @@
 	  * man/augtool.pod: document --echo option
 	  * man/augtool.1: regenerated
 
-2009-06-15  Jim Meyering  <meyering@redhat.com>
+2009-06-16  Jim Meyering  <meyering@redhat.com>
 
 	build: fix "make distcheck" failure
 	* src/Makefile.am (EXTRA_DIST): Add fa_sym.version.
@@ -3333,13 +3355,13 @@
 	* test-test-preserve.sh: work with BSD ls, as well as GNU ls
 	Needed to make the test pass on OS/X
 
-2009-06-11  David Lutterkort  <lutter@redhat.com>
+2009-06-12  David Lutterkort  <lutter@redhat.com>
 
 	libfa: use linker script to only export public symbols
 	libfa was exporting all kinds of symbols that were meant to be internal;
 	now it only exports what's in fa.h
 
-2009-06-11  Anders F Björklund  <afb@users.sourceforge.net>
+2009-06-12  Anders F Björklund  <afb@users.sourceforge.net>
 
 	configure: do not use version script if the linker doesn't support it
 	That is the case on OS X
@@ -3355,7 +3377,7 @@
 	* src/augtool.c: add missing include for ctype.h
 	Part of fix for ticket #66
 
-2009-06-09  David Lutterkort  <lutter@redhat.com>
+2009-06-10  David Lutterkort  <lutter@redhat.com>
 
 	Version 0.5.1
 
@@ -3406,7 +3428,7 @@
 
 	* tests/root/etc/: add group and passwd files
 
-2009-05-28  Matt Palmer  <matt@anchor.net.au>
+2009-05-29  Matt Palmer  <matt@anchor.net.au>
 
 	Interfaces: various bug fixes
 	* disallow end-of-line comments
@@ -3415,7 +3437,7 @@
 	Interfaces: accept options containing '_'
 	Bug reported by Jonas Eriksson
 
-2009-05-28  David Lutterkort  <lutter@redhat.com>
+2009-05-29  David Lutterkort  <lutter@redhat.com>
 
 	* tests/grub-rm-entry.rb: 'savedefault' indented by '\t', not ''
 
@@ -3423,7 +3445,7 @@
 
 	Modprobe: handle comments at the end of a line
 
-2009-04-13  David Lutterkort  <lutter@redhat.com>
+2009-04-14  David Lutterkort  <lutter@redhat.com>
 
 	Grub: allow optional argument for savedefault command
 
@@ -3480,21 +3502,19 @@
 
 	Squid: allow indentation of entries
 
-2009-04-07  Raphael Pinson  <raphink@gmail.com>
-
 	Logrotate: allow = as a separator for value_to_eol
 	Fix ticket #61 by allowing "=" as a valid separator in value_to_eol.
 	"word" may not contain "=" anymore in this case.  Note that this is not
 	documented in "man logrotate" but is shipped by default in CentOS (cf
 	ticket #61).
 
-2009-04-07  David Lutterkort  <lutter@redhat.com>
+2009-04-08  David Lutterkort  <lutter@redhat.com>
 
 	Ntp: fixes to make the default Fedora config work
 	Now enough of ntp.conf is understood so that the config from Fedora 10 with
 	all directives uncommented can be processed.
 
-2009-04-07  Raphael Pinson  <raphink@gmail.com>
+2009-04-08  Raphael Pinson  <raphink@gmail.com>
 
 	Ntp: add fudge directive
 	Fixes ticket #59
@@ -3507,7 +3527,7 @@
 
 	Bug reported by Michael Conigliaro <mike@conigliaro.org>
 
-2009-04-03  David Lutterkort  <lutter@redhat.com>
+2009-04-04  David Lutterkort  <lutter@redhat.com>
 
 	* src/augtool.c: new option --noautoload
 
@@ -3520,7 +3540,7 @@
 
 	Rx: remove \b and \d escapes
 
-2009-04-03  Raphael Pinson  <raphink@gmail.com>
+2009-04-04  Raphael Pinson  <raphink@gmail.com>
 
 	Modify some existing lenses to use new utility modules
 	Changes Aliases, Exports, Fstab, Group, and Monit
@@ -3544,7 +3564,7 @@
 	* handle empty lines
 	* find vsftpd.conf on Fedora/RHEL
 
-2009-03-27  David Lutterkort  <lutter@redhat.com>
+2009-03-28  David Lutterkort  <lutter@redhat.com>
 
 	Iptables: fix ticket #51
 	 * allow more characters in chain names
@@ -3558,6 +3578,8 @@
 
 	* src/get.c (get_quant_star): do not leak registers
 
+2009-03-27  David Lutterkort  <lutter@redhat.com>
+
 	Some more test files
 
 	Fix uninitialized variables found by optimizer
@@ -3633,7 +3655,7 @@
 	The new API call aug_defvar allows defining variables that can later be
 	used in path expressions.
 
-2009-03-22  David Lutterkort  <lutter@redhat.com>
+2009-03-23  David Lutterkort  <lutter@redhat.com>
 
 	Add FilterExpr to path expression grammar
 	This allows using constructs like $foo/some/path and $foo[2]
@@ -3648,7 +3670,7 @@
 
 	* src/pathx.c (clone_value): new function
 
-2009-03-21  David Lutterkort  <lutter@redhat.com>
+2009-03-22  David Lutterkort  <lutter@redhat.com>
 
 	* src/pathx.c (release_value): factor logic into separate function
 
@@ -3661,10 +3683,12 @@
 
 	* examples/fadot: remove, checked in by mistake
 
-2009-03-20  David Lutterkort  <lutter@redhat.com>
+2009-03-21  David Lutterkort  <lutter@redhat.com>
 
 	* .gitignore: ignore examples/fadot
 
+2009-03-20  David Lutterkort  <lutter@redhat.com>
+
 	* src/get.c: rename 'Short iteration' to a more helpful message
 
 	* src/transform.c (store_error): report which lens failed
@@ -3682,7 +3706,7 @@
 	operations on FA's from the command line, like intersection and complement
 	of FA's.
 
-2009-03-19  David Lutterkort  <lutter@redhat.com>
+2009-03-20  David Lutterkort  <lutter@redhat.com>
 
 	* src/pathx.c: call make_value before pop_value
 	Since make_value might realloc, pointers retrieved with pop_value may
@@ -3692,6 +3716,8 @@
 
 	* src/augeas.c: create various /augeas nodes when they go missing
 
+2009-03-19  David Lutterkort  <lutter@redhat.com>
+
 	* src/put.c (create_concat): fix goofy error message
 
 	Update and refresh man pages
@@ -3742,7 +3768,7 @@
 	legal iptables config file; what makes it basic is that it doesn't break
 	some of the values down as fine-grained as I would like to have them
 
-2009-03-13  David Lutterkort  <lutter@redhat.com>
+2009-03-14  David Lutterkort  <lutter@redhat.com>
 
 	* configure.ac: bump major version of libfa
 
@@ -3754,6 +3780,8 @@
 
 	* src/fa.h (fa_compile): pass in size of regexp
 
+2009-03-13  David Lutterkort  <lutter@redhat.com>
+
 	* src/fa.h: use 'struct fa *' instead of fa_t
 
 	* src/augeas.c: fix handling of dirty flag
@@ -3766,14 +3794,14 @@
 
 	* Makefile.maint: different setup at home
 
-2009-03-12  David Lutterkort  <lutter@redhat.com>
-
 	* src/transform.c (transform_save): properly sync data to disk
 	Make sure the data we write into the .augnew file hits the disk before
 	renaming to the proper name
 
 	Modprobe: lens and tests for modprobe.conf
 
+2009-03-12  David Lutterkort  <lutter@redhat.com>
+
 	* src/fa.c (re_cset_as_string): turn '[^\n]' into '.'
 
 	Place Sudoers and Util under LGPLv2+
@@ -3808,7 +3836,7 @@
 
 	cat /tmp/squid2.7 /tmp/squid3-HEAD | sort | uniq
 
-2009-03-08  David Lutterkort  <lutter@redhat.com>
+2009-03-09  David Lutterkort  <lutter@redhat.com>
 
 	* tests/xpath.tests: Hosts lens puts comments into #comment nodes
 
@@ -3832,20 +3860,22 @@
 
 	Sshd: add test showing how to add a Subsystem
 
-2009-03-03  David Lutterkort  <lutter@redhat.com>
+2009-03-04  David Lutterkort  <lutter@redhat.com>
 
 	* Makefile.maint: add autogen target
 
 	* src/pathx.c (eval_rel): for numbers, '<' and '<=' were reversed
 
+2009-03-03  David Lutterkort  <lutter@redhat.com>
+
 	Postfix_main: handle continuation lines
 
 	* src/pathx.c: fix some comments
 
-2009-03-02  David Lutterkort  <lutter@redhat.com>
-
 	Version 0.4.1
 
+2009-03-02  David Lutterkort  <lutter@redhat.com>
+
 	* configure.ac: make default warning level 'maximum'
 	Using 'error' here is too unfriendly on weird platforms, since builds can
 	fail, e.g. because of broken system headers. When doing actual development,
@@ -3864,7 +3894,7 @@
 
 	* src/pathx.c: it is an error if we don't consume the whole expression
 
-2009-02-27  David Lutterkort  <lutter@redhat.com>
+2009-02-28  David Lutterkort  <lutter@redhat.com>
 
 	* tests/test-event-saved.sh: make sure fuiles are writable by owner
 
@@ -3882,8 +3912,6 @@
 
 	* src/augeas.c (tree_find): helper for getting a tree node
 
-2009-02-24  David Lutterkort  <lutter@redhat.com>
-
 	* src/augeas.c: erase /augeas/events/saved only once
 	tree_save is called recursively; /augeas/events/saved must be reset
 	in aug_save, not tree_save
@@ -3894,19 +3922,23 @@
 
 	* src/transform.h: move transform decls out of syntax.h
 
+2009-02-24  David Lutterkort  <lutter@redhat.com>
+
 	Util.stdexcl: exclude .augsave and .augnew files
 
-2009-02-20  David Lutterkort  <lutter@redhat.com>
+2009-02-21  David Lutterkort  <lutter@redhat.com>
 
 	* src/lexer.l: correct location info for strings and regexps
 
 	* src/get.c: check for valid match before calling token()
 
-2009-02-19  David Lutterkort  <lutter@redhat.com>
+2009-02-20  David Lutterkort  <lutter@redhat.com>
 
 	* src/parser.y: do not allow epsilon as a tree constant
 	This grammar mistake made epsilon a valid expression
 
+2009-02-19  David Lutterkort  <lutter@redhat.com>
+
 	* src/fa.c: cache hash values in the state
 	This gives about a 15% performance improvement in typechecking
 	the logrotate lens
@@ -3997,7 +4029,7 @@
 
 	* src/augtool.c (cmd_match): check return from aug_match more defensively
 
-2009-02-06  David Lutterkort  <lutter@redhat.com>
+2009-02-07  David Lutterkort  <lutter@redhat.com>
 
 	Version 0.4.0
 
@@ -4007,6 +4039,8 @@
 	Fix compilation on OpenSolaris
 	* src/pathx.c (position): assert not marked as noreturn
 
+2009-02-06  David Lutterkort  <lutter@redhat.com>
+
 	* tests/test-xpath.c (run_one_test): allow results in   arbitrary order. Files on Fedora and Debian are enumerated   in different order, leading to spurious test failures
 
 	* src/pathx.c: remove the value() function, it's redundant with '.'
@@ -4036,7 +4070,7 @@
 	Lens and tests for DarkIce
 	See http://darkice.tyrell.hu/
 
-2009-02-01  David Lutterkort  <lutter@redhat.com>
+2009-02-02  David Lutterkort  <lutter@redhat.com>
 
 	* src/augeas.c: use ALLOC instead of CALLOC
 
@@ -4048,7 +4082,7 @@
 
 	* src/augeas.c (init_root): check for failure of strdup
 
-2009-01-30  David Lutterkort  <lutter@redhat.com>
+2009-01-31  David Lutterkort  <lutter@redhat.com>
 
 	* src/pathx.c: factor test if a step matches into step_matches
 	This also fixes a problem matching, test also included
@@ -4114,7 +4148,7 @@
 
 	Grub: support color directive
 
-2009-01-26  David Lutterkort  <lutter@redhat.com>
+2009-01-27  David Lutterkort  <lutter@redhat.com>
 
 	Version 0.3.6
 
@@ -4138,15 +4172,15 @@
 
 	Report version and legal save modes in /augeas/version
 
-2009-01-17  David Lutterkort  <lutter@redhat.com>
+2009-01-18  David Lutterkort  <lutter@redhat.com>
 
 	* ref.h: include limits.h, since we use UINT_MAX
 
-2009-01-16  David Lutterkort  <lutter@redhat.com>
+2009-01-17  David Lutterkort  <lutter@redhat.com>
 
 	Mark up code in documentation comments for Dpkg and Exports
 
-2009-01-16  Robin Lee Powell  <rlpowell@digitalkingdom.org>
+2009-01-17  Robin Lee Powell  <rlpowell@digitalkingdom.org>
 
 	Documentation for Exports and Dpkg
 
@@ -4189,20 +4223,20 @@
 	* test-preserve.sh: Use cut -b1-10 to get mode from ls -l output.
 	Use ls -lZ (not ls -Z, which is not portable) to get SELinux context.
 
-2009-01-04  Arnaud Gomes-do-Vale  <arnaud.gomes@ircam.fr>
+2009-01-05  Arnaud Gomes-do-Vale  <arnaud.gomes@ircam.fr>
 
 	* src/Makefile.am: fix bz #478619 - do not use abspath
 
-2009-01-03  Robin Lee Powell  <rlpowell@digitalkingdom.org>
+2009-01-04  Robin Lee Powell  <rlpowell@digitalkingdom.org>
 
 	Dpkg: new lens and test
 
-2009-01-03  David Lutterkort  <lutter@redhat.com>
+2009-01-04  David Lutterkort  <lutter@redhat.com>
 
 	Php: expand filter slightly
 	Suggested by Robin Lee Powell <rlpowell@digitalkingdom.org>
 
-2008-12-29  David Lutterkort  <lutter@redhat.com>
+2008-12-30  David Lutterkort  <lutter@redhat.com>
 
 	Fix segfault when branch in a union does not have a ktype
 	* src/lens.c (lns_key_regexp): check for NULL ktype of branch
@@ -4210,25 +4244,25 @@
 
 	Bug reported by Robin Lee Powell <rlpowell@digitalkingdom.org>
 
-2008-12-27  Free Ekanayaka  <free@64studio.com>
+2008-12-28  Free Ekanayaka  <free@64studio.com>
 
 	Add soma lens and test
 
 	Add limits lens and test
 
-2008-12-24  David Lutterkort  <lutter@redhat.com>
+2008-12-25  David Lutterkort  <lutter@redhat.com>
 
 	* autogen.sh: remove bogus argument to configure
 
-2008-12-24  Marc Fournier  <marc.fournier@camptocamp.com>
+2008-12-25  Marc Fournier  <marc.fournier@camptocamp.com>
 
 	Php, Gdm: exclude literal ".anon" from title, not regexp /.anon/
 
-2008-12-24  Free Ekanayaka  <free@64studio.com>
+2008-12-25  Free Ekanayaka  <free@64studio.com>
 
 	Phpvars: allow whitespaces before the \n in the <?php head line
 
-2008-12-23  David Lutterkort  <lutter@redhat.com>
+2008-12-24  David Lutterkort  <lutter@redhat.com>
 
 	Version 0.3.5
 
@@ -4240,11 +4274,11 @@
 	The list of users in a group is now split into individual 'user/'
 	nodes. If a group has no members, no user/ nodes are produced.
 
-2008-12-23  Free Ekanayaka  <free@64studio.com>
+2008-12-24  Free Ekanayaka  <free@64studio.com>
 
 	Add lens and test for /etc/group
 
-2008-12-23  David Lutterkort  <lutter@redhat.com>
+2008-12-24  David Lutterkort  <lutter@redhat.com>
 
 	Simpler interface and implementation for path_find_one
 
@@ -4270,19 +4304,19 @@
 
 	Add an explicit parent pointer to the tree
 
-2008-12-23  Free Ekanayaka  <free@64studio.com>
+2008-12-24  Free Ekanayaka  <free@64studio.com>
 
 	Lens and test for config files using PHP-style variables
 	Process /etc/squirrelmail/config.php
 
-2008-12-23  Marc Fournier  <marc.fournier@camptocamp.com>
+2008-12-24  Marc Fournier  <marc.fournier@camptocamp.com>
 
 	New lens and tests for /etc/rsyncd.conf
 	rsyncd.conf is an ini file which allows indented
 	parameters (like smb.conf) as well as entries outside
 	any section (like php.ini).
 
-2008-12-23  David Lutterkort  <lutter@redhat.com>
+2008-12-24  David Lutterkort  <lutter@redhat.com>
 
 	* fa.c: mark '.' as a special character that needs to be escaped
 
@@ -4333,7 +4367,7 @@
 	* transform.c (transform_save): if rename fails because new/backup file
 	  and target file are on different devices, copy the files
 
-2008-11-05  David Lutterkort  <lutter@redhat.com>
+2008-11-06  David Lutterkort  <lutter@redhat.com>
 
 	* Makefile.maint: add target tag-release
 
@@ -4368,11 +4402,11 @@
 	build: use LIB_SELINUX as set by gnulib
 	* configure.ac: do not set up LIB_SELINUX, gnulib does that
 
-2008-10-22  Sylvain Baubeau  <bob@glumol.com>
+2008-10-23  Sylvain Baubeau  <bob@glumol.com>
 
 	Grub: support "rootnoverify" and "chainloader" directives
 
-2008-10-21  David Lutterkort  <lutter@redhat.com>
+2008-10-22  David Lutterkort  <lutter@redhat.com>
 
 	Version 0.3.2
 
@@ -4380,6 +4414,8 @@
 
 	test-events-saved.sh: sort the list of saved files
 
+2008-10-21  David Lutterkort  <lutter@redhat.com>
+
 	aug_save: report saved files in /augeas/events/saved
 	aug_save now reports which files were changed on disk underneath
 	/augeas/events/saved; if multiple files are changed in one save operation,
@@ -4397,8 +4433,6 @@
 	still create the file with whatever default user/group/mode the current
 	user has set.
 
-2008-10-20  David Lutterkort  <lutter@redhat.com>
-
 	aug_save: report the number of files that were changed
 	When the tree is saved, keep track of the number of files that were
 	actually changed and return that number.
@@ -4434,11 +4468,11 @@
 
 	Add gdm lens and associated test
 
-2008-10-02  David Lutterkort  <lutter@redhat.com>
+2008-10-03  David Lutterkort  <lutter@redhat.com>
 
 	Ignore files based on .hgignore
 
-2008-10-01  David Lutterkort  <lutter@redhat.com>
+2008-10-02  David Lutterkort  <lutter@redhat.com>
 
 	Complain when nodes in the tree can not be put
 	When nodes are added to the tree that do not match the appropriate
@@ -4451,14 +4485,16 @@
 	This also uncovered that the test rec-hosts-add.rb was broken, but still
 	passed.
 
-2008-10-01  David Lutterkort  <dlutter@redhat.com>
+2008-10-02  David Lutterkort  <dlutter@redhat.com>
 
 	Pass --nostdinc properly when running under gdb
 
+2008-10-01  David Lutterkort  <dlutter@redhat.com>
+
 	Logrotate: parse tabooext into list; add processing of a number of options
 	Patch by Sean E. Millichamp
 
-2008-09-22  David Lutterkort  <dlutter@redhat.com>
+2008-09-23  David Lutterkort  <dlutter@redhat.com>
 
 	Grub: add support for 'serial' and 'terminal'
 	Patch by Sean E. Millichamp
@@ -4470,6 +4506,8 @@
 	Logrotate: add dateext flag
 	Patch by Sean E. Millichamp
 
+2008-09-22  David Lutterkort  <dlutter@redhat.com>
+
 	Various changes to the NaturalDocs support
 	This patch changes a few things around in the NaturalDocs support:
 
@@ -4510,7 +4548,7 @@
 
 	Adapt augeas.h for NaturalDocs parsing
 
-2008-09-08  David Lutterkort  <dlutter@redhat.com>
+2008-09-09  David Lutterkort  <dlutter@redhat.com>
 
 	Sshd: better handling of match blocks
 	Split match conditions into individual 'Condition' entries. Store the
@@ -4525,7 +4563,7 @@
 	Ldap: merge with Spacevars. Spacevars: process havp.config
 	Adapt Test_ldap, since there is no Ldap.lns anymore
 
-2008-09-08  David Lutterkort  <dlutter@redhat.com>
+2008-09-09  David Lutterkort  <dlutter@redhat.com>
 
 	Use --nostdinc in tests
 	We never want to use installed lenses in the tests; they should only be
@@ -4555,12 +4593,12 @@
 
 	Shellvars: handle space at the end of a line
 
-2008-09-04  David Lutterkort  <dlutter@redhat.com>
-
 	Added tag release-0.3.1 for changeset 803c17b1833a
 
 	Release 0.3.1
 
+2008-09-04  David Lutterkort  <dlutter@redhat.com>
+
 	Sysctl: lens for sysctl.conf
 	Contributed by Sean Millichamp
 
@@ -4623,7 +4661,7 @@
 	- When a union during 'put' does not match, produce an error instead of
 	  aborting
 
-2008-08-28  David Lutterkort  <dlutter@redhat.com>
+2008-08-29  David Lutterkort  <dlutter@redhat.com>
 
 	Fix a bug with transferring skeletons
 	It is possible for a skeleton to move from one subtree lens to another, if
@@ -4665,7 +4703,7 @@
 	See man dput.cf(5) from a recent dput version (Ubuntu/hardy or
 	Debian/lenny)
 
-2008-08-26  David Lutterkort  <dlutter@redhat.com>
+2008-08-27  David Lutterkort  <dlutter@redhat.com>
 
 	Typecheck del lens
 	The builtin lens 'del RE STR' was missing a typecheck: the default string
@@ -4708,7 +4746,7 @@
 	Adapt php.aug to support entries outside of sections and still map sections
 	as labels (Fix #9)
 
-2008-08-15  David Lutterkort  <dlutter@redhat.com>
+2008-08-16  David Lutterkort  <dlutter@redhat.com>
 
 	Shellvars: one more cornercase with double quoted strings
 
@@ -4722,12 +4760,12 @@
 	There is no point in trying to match against skel->text for a store lens
 	since that is always NULL.
 
+2008-08-15  David Lutterkort  <dlutter@redhat.com>
+
 	Fix syntax error in test
 
 	augl_error: Initialize info
 
-2008-08-14  David Lutterkort  <dlutter@redhat.com>
-
 	aug_mv: fix bug when moving at the root level
 	When moving from the root level, the source node needs to be removed from
 	aug->tree, not aug->tree->children. In addition, the list_remove macro must
@@ -4769,7 +4807,7 @@
 
 	Sudoers: clean up comment definition
 
-2008-08-12  David Lutterkort  <dlutter@redhat.com>
+2008-08-13  David Lutterkort  <dlutter@redhat.com>
 
 	Hosts: handle comments at the end of a host entry
 	Comments are put into the tree as part of that host node, i.e. will live as
@@ -4840,7 +4878,7 @@
 	See regex(7) or
 	http://www.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap09.html#tag_09_04
 
-2008-08-09  David Lutterkort  <dlutter@redhat.com>
+2008-08-10  David Lutterkort  <dlutter@redhat.com>
 
 	Revamp the dict data structure
 	Dicts were simple linked lists of key/value pairs, and appending and
@@ -4883,12 +4921,12 @@
 	list_reverse reverses a list in place. list_tail_cons appends to a list in
 	constant time, since it is given a pointer to the tail of the list.
 
-2008-08-07  David Lutterkort  <dlutter@redhat.com>
-
 	Added tag release-0.3.0 for changeset 60f2a13c2528
 
 	Release 0.3.0
 
+2008-08-07  David Lutterkort  <dlutter@redhat.com>
+
 	Mention the exit status
 
 	Version libfa and libaugeas
@@ -4915,7 +4953,7 @@
 	failed. This is useful when piping multiple commands into augtool to check
 	that they all succeeded.
 
-2008-07-29  David Lutterkort  <dlutter@redhat.com>
+2008-07-30  David Lutterkort  <dlutter@redhat.com>
 
 	Fix failures on FreeBSD
 	(1) Point augtool at the lenses in the source dir (not FreeBSD problem,
@@ -4964,7 +5002,7 @@
 
 	Add a call to move a subtree to the public API
 
-2008-07-26  David Lutterkort  <dlutter@redhat.com>
+2008-07-27  David Lutterkort  <dlutter@redhat.com>
 
 	Refactor tree_create
 
@@ -5035,13 +5073,13 @@
 	Lens for Debian's dput files
 	Contributed by Raphael Pinson
 
-2008-07-17  David Lutterkort  <dlutter@redhat.com>
-
 	augtool: Print '(none)' when getting a path with no value
 	The output used to be mangled. Now it is 'path = value' if hte path has a
 	non-NULL value, 'path (none)' if the path exists but has a NULL value, and
 	'path (o)' if an error occurred.
 
+2008-07-17  David Lutterkort  <dlutter@redhat.com>
+
 	Added tag release-0.2.1 for changeset 13fdcd9bb18a
 
 	aliases.aug: Do not require whitespace after commas
@@ -5075,7 +5113,7 @@
 	Otherwise, get and parse on an empty string will produce a 'short
 	iteration' error, even if the empty string is acceptable for that lens.
 
-2008-07-07  David Lutterkort  <dlutter@redhat.com>
+2008-07-08  David Lutterkort  <dlutter@redhat.com>
 
 	Put the default dir for lenses into DATADIR (the real fix)
 	Reworks 527:14602e2757dd in a way that actually works and conforms to the
@@ -5084,10 +5122,12 @@
 	Most of this fix suggested by Jim Meyering, I only touched it up a little
 	(and no doubt introduced all the bugs).
 
+2008-07-07  David Lutterkort  <dlutter@redhat.com>
+
 	Check for NULL values in the put direction of store
 	This is now flagged as an error instead of causing a segfault.
 
-2008-07-03  David Lutterkort  <dlutter@redhat.com>
+2008-07-04  David Lutterkort  <dlutter@redhat.com>
 
 	Lens for /etc/exports
 
@@ -5099,13 +5139,13 @@
 
 	Suppress generated manpages
 
-2008-06-30  David Lutterkort  <dlutter@redhat.com>
-
 	Put the default dir for lenses into DATADIR
 	Instead of hardcoding the default dir for lenses to somewhere in '/usr',
 	look in DATADIR - that's after all where the default lenses are installed
 	if DATADIR (or PREFIX) is changed.
 
+2008-06-30  David Lutterkort  <dlutter@redhat.com>
+
 	Man page for augparse
 
 	Put Augeas version into footer
@@ -5132,10 +5172,10 @@
 	With this change, error messages contain an indication to where the error
 	happened that is a little closer to the actual trouble spot.
 
-2008-06-12  David Lutterkort  <dlutter@redhat.com>
-
 	Check that we take the right branch in a union
 
+2008-06-12  David Lutterkort  <dlutter@redhat.com>
+
 	Process /etc/sysconfig/selinux
 	Patch by Alan Pevec
 
@@ -5166,7 +5206,7 @@
 
 	Release 0.2.0
 
-2008-06-03  David Lutterkort  <dlutter@redhat.com>
+2008-06-04  David Lutterkort  <dlutter@redhat.com>
 
 	Remove bashisms from test scripts
 	Make tests scripts work with plain old sh; also, don't hardcode location of
@@ -5387,8 +5427,6 @@
 	increased, as the calling conventions for builtin functions stipulate that
 	the returned value is owned by the caller
 
-2008-05-14  David Lutterkort  <dlutter@redhat.com>
-
 	Report errors more clearly in the tree
 	When an error happens during get/put, store additional info in the tree:
 	for get errors, store the position in the file where the error occured, for
@@ -5399,7 +5437,7 @@
 	with the value associated with /augeas/F/error giving some indication about
 	the kind of error encountered.
 
-2008-05-13  David Lutterkort  <dlutter@redhat.com>
+2008-05-14  David Lutterkort  <dlutter@redhat.com>
 
 	Report errors during put
 
@@ -5417,6 +5455,8 @@
 	that "jumped branches", i.e. whose get used one branch of the union, and
 	the put uses the other branch because of changes to the tree.
 
+2008-05-13  David Lutterkort  <dlutter@redhat.com>
+
 	Reduce the number of calls to collect
 	We were calling collect way too often, which was slowing things down. Also
 	broke collect into separate subfunctions so we can see better when one of
@@ -5435,12 +5475,14 @@
 
 	Fix up the existing lenses that violate that.
 
-2008-05-09  David Lutterkort  <dlutter@redhat.com>
+2008-05-10  David Lutterkort  <dlutter@redhat.com>
 
 	Keep re_cset_as_string from including an explicit '\0'
 	We use NUL delimited strings; that means we can not use a CSET
 	representation that mentions '\0' explicitly.
 
+2008-05-09  David Lutterkort  <dlutter@redhat.com>
+
 	Use the new '-' operator for key_re
 
 	Add subtraction of regular expressions to the language
@@ -5468,8 +5510,6 @@
 	There are lots of gyrations to keep the generated regexp reasonably short
 	(and syntactically correct)
 
-2008-05-08  David Lutterkort  <dlutter@redhat.com>
-
 	Check for (some) allocation failures
 
 	Reference count 'struct re' instances
@@ -5512,8 +5552,6 @@
 	Small fixes to the specfile
 	Suggested by Michael Schwendt
 
-2008-05-05  David Lutterkort  <dlutter@redhat.com>
-
 	Lens and transform for xinetd.conf
 
 	Enclose the regexp for a key in (..) before adding a /
@@ -5585,7 +5623,7 @@
 
 	do ldconfig in post/postun of the libs subpackage
 
-2008-04-28  David Lutterkort  <dlutter@redhat.com>
+2008-04-29  David Lutterkort  <dlutter@redhat.com>
 
 	Free the value when freeing a tree node
 
@@ -5615,8 +5653,6 @@
 	Note that the baseurl nodes have to be consecutive; otherwise, put will
 	fail.
 
-2008-04-24  David Lutterkort  <dlutter@redhat.com>
-
 	Fix lens selection in union
 	The logic in put to select the appropriate branch in unions got it wrong if
 	the first branch matched the empty word, because applies only checked that
@@ -5630,6 +5666,8 @@
 	we unref STAR at the end, we need to take ownership of STAR->LENS when
 	constructing the concat of L and STAR->LENS
 
+2008-04-24  David Lutterkort  <dlutter@redhat.com>
+
 	* src/fa.c (string_extend): Handle realloc failure.
 	Patch by Jim Meyering
 
@@ -5647,8 +5685,6 @@
 	Remove trailing whitespace from the end of lines
 	No functional change, only formatting.
 
-2008-04-23  David Lutterkort  <dlutter@redhat.com>
-
 	Remove aug_exists - it does not exist anymore
 
 	Delete old, outdated notes
@@ -5673,6 +5709,8 @@
 	Also, parseline initializes all args as NULL now to guard against garbage
 	pointers accumulating from previous uses.
 
+2008-04-23  David Lutterkort  <dlutter@redhat.com>
+
 	Don't complain about missing optional args
 	For example, both 'print' and 'print PATH' are legal. Make sure we accept
 	either.
@@ -5714,8 +5752,6 @@
 	Properly escape/unescape quotes in strings
 	Patch provided by Alan Pevec
 
-2008-04-21  David Lutterkort  <dlutter@redhat.com>
-
 	Updated for 0.0.8 and upcoming 0.1.0 release
 
 	Remove aug_exists from public API
@@ -5740,6 +5776,8 @@
 	Parse network configs in /etc/sysconfig/ifcfg-*
 	Patch provided by Alan Pevec
 
+2008-04-21  David Lutterkort  <dlutter@redhat.com>
+
 	Don't mark ROOT for MAKE_PATH as const - it's not always true
 
 	Cap file reads (arbitrarily) at 32MB
@@ -5766,25 +5804,25 @@
 
 	Add "2008" to the copyright in the headers
 
-2008-04-19  David Lutterkort  <dlutter@redhat.com>
+2008-04-20  David Lutterkort  <dlutter@redhat.com>
 
 	Remove dependency on glib and use kazlib's hash table instead
 	The dependency on glib was only there for the hash tables used by
 	libfa. Rather than requiring all of glib just for that, use the hash table
 	implementation in hash.[ch] taken from kazlib.
 
-2008-04-18  David Lutterkort  <dlutter@redhat.com>
+2008-04-19  David Lutterkort  <dlutter@redhat.com>
 
 	Hashtable from Kazlib 1.20
 	Available from http://users.footprints.net/~kaz/kazlib.html
 
 	Abort if failing assertions are not used
 
-2008-04-19  David Lutterkort  <dlutter@redhat.com>
+2008-04-20  David Lutterkort  <dlutter@redhat.com>
 
 	Remove pathsplit symbol
 
-2008-04-16  David Lutterkort  <dlutter@redhat.com>
+2008-04-17  David Lutterkort  <dlutter@redhat.com>
 
 	Added tag release-0.0.8 for changeset cb00aa18e518
 
@@ -5794,6 +5832,8 @@
 
 	Install lens tests in lenses/tests/ not lenses/
 
+2008-04-16  David Lutterkort  <dlutter@redhat.com>
+
 	Use the right path expression to print the whole tree
 
 	Don't segfault when a test fails without producing any tree
@@ -5802,8 +5842,6 @@
 
 	Call the node for a boot entry 'title'
 
-2008-04-14  David Lutterkort  <dlutter@redhat.com>
-
 	Remove the use in sequences in some places
 	Where indentation isn't important, we can flatten and simplify the tree by
 	not using seqs. Instead of something like aliases/1, aliases/2, ... we now
@@ -5816,6 +5854,8 @@
 	Change the ins syntax to support insert before/after
 	This reflects the change to the aug_insert API
 
+2008-04-14  David Lutterkort  <dlutter@redhat.com>
+
 	Handle searching for the last() element properly
 	path_first didn't find anything when looking for 'element[last()]'
 
@@ -5833,7 +5873,7 @@
 
 	Running a failing test fails loading the whole module
 
-2008-04-11  David Lutterkort  <dlutter@redhat.com>
+2008-04-12  David Lutterkort  <dlutter@redhat.com>
 
 	Add path expressions allowing XPath-like path matching
 	Path expressions passed in through the public API can now contain indices
@@ -5842,6 +5882,8 @@
 
 	Syntax and semantics follow XPath.
 
+2008-04-11  David Lutterkort  <dlutter@redhat.com>
+
 	Run all tests - don't abort after the first failure
 
 2008-04-10  David Lutterkort  <dlutter@redhat.com>
@@ -5852,8 +5894,6 @@
 	It's enough to pass -c to augtool on the first test we run; doing it again
 	in later tests is completely redundant and just slows the test run down.
 
-2008-04-09  David Lutterkort  <dlutter@redhat.com>
-
 	Complain if a transform is built from a lens orphaning a key/value
 	Such a transform would lose information when applied and can't be
 	valid. Ideally, this check would be in the typechecker, but requires
@@ -5874,6 +5914,8 @@
 
 	Update README
 
+2008-04-09  David Lutterkort  <dlutter@redhat.com>
+
 	Remove 'spec' files and tests that don't make sense any longer
 
 	Fail test scripts on _any_ unexpected error
@@ -5916,8 +5958,6 @@
 	is already defined locally, everything works, and if it is not, an error is
 	produced.
 
-2008-04-08  David Lutterkort  <dlutter@redhat.com>
-
 	Typecheck the atype of concat and iter
 
 	Typecheck the atype of union
@@ -5933,6 +5973,8 @@
 
 	Clearer error message
 
+2008-04-08  David Lutterkort  <dlutter@redhat.com>
+
 	Processing of pam.d
 
 	Pull some useful space deleters into Util
@@ -5969,8 +6011,6 @@
 	identifier mentioned in the autoload must be defined in the enclosing
 	module.
 
-2008-04-07  David Lutterkort  <dlutter@redhat.com>
-
 	Builtins for filters and transforms
 	Three simple builtins to construct transforms:
 
@@ -5978,12 +6018,8 @@
 	- excl : string -> filter -> filter excludes all files matching a glob
 	- transform: lens -> filter -> transform
 
-2008-04-08  David Lutterkort  <dlutter@redhat.com>
-
 	Implement free_lens
 
-2008-04-07  David Lutterkort  <dlutter@redhat.com>
-
 	A lens for yum
 
 	Fix bad free
@@ -6006,13 +6042,15 @@
 
 	Add a 'gensym' builtin
 
+2008-04-07  David Lutterkort  <dlutter@redhat.com>
+
 	More ref ocunting fixes
 	- aug_close now releases the list of modules
 	- compile_bracket cleans up the arg
 	- augparse closes the augeas connection, mostly so that we can see leaks
 	  in valgrind better
 
-2008-04-04  David Lutterkort  <dlutter@redhat.com>
+2008-04-05  David Lutterkort  <dlutter@redhat.com>
 
 	Fix major brainfart in ref counting lists
 	The way lists were reference counted (and particularly unref'd) was just
@@ -6032,6 +6070,8 @@
 
 	Exceptions during compilation countas failure
 
+2008-04-04  David Lutterkort  <dlutter@redhat.com>
+
 	Fix how the key regexp for unions is calculated
 	Union would produce spurious empty keys, for example in the expression
 	  [ key /a/ . ([ l1 ] | [ l2 ]) ]
@@ -6069,8 +6109,6 @@
 
 	Update yylloc for string/regexp constants
 
-2008-04-03  David Lutterkort  <dlutter@redhat.com>
-
 	When compile_exp produces an exn, bind it anyway
 	This avoids lots of trouble with NULL values
 
@@ -6113,6 +6151,8 @@
 	automatically load it by looking for a file mod.aug on the module load
 	path.
 
+2008-04-03  David Lutterkort  <dlutter@redhat.com>
+
 	Rename struct env to struct module
 
 	Separate function composition from concatenation
@@ -6131,8 +6171,6 @@
 	Fix reference problem
 	The wrong type was being unref'd
 
-2008-04-02  David Lutterkort  <dlutter@redhat.com>
-
 	Free the whole dictionary
 	While entries are looked up, dict->entry changes; dict->mark is the head of
 	the list of all entries that were ever in the dict.
@@ -6160,6 +6198,8 @@
 	lns_get now reports parse errors in an lns_error struct, which is turned
 	into an exception in the interpreter.
 
+2008-04-02  David Lutterkort  <dlutter@redhat.com>
+
 	Added tag ml-syntax-start for changeset fcd6c04a1eed
 
 	A subtree without a key matches "/"
@@ -6172,8 +6212,6 @@
 
 	Fill in subtree->atype with empty regexp
 
-2008-04-01  David Lutterkort  <dlutter@redhat.com>
-
 	Interpreter for the new file description syntax
 	This is by no means done, but done enough to allow incremental fixes from
 	now on. This checkin still contains lots of FIXME's and bugs. Very simple
@@ -6182,7 +6220,7 @@
 	The syntax for describing files is now a very simple OCaml-like functional
 	language; the file syntax.c implements an interpreter for that language.
 
-2008-03-25  David Lutterkort  <dlutter@redhat.com>
+2008-03-26  David Lutterkort  <dlutter@redhat.com>
 
 	Revamp the language
 
@@ -6219,8 +6257,6 @@
 	with a single node matching FOO is wrongly split as if there was a COMMENT
 	(which, if it were there would have to have a NULL label)
 
-2008-03-13  David Lutterkort  <dlutter@redhat.com>
-
 	Defer allocating storage for a state_set as long as possible
 
 	Rename constants state_set_* to array_*
@@ -6242,6 +6278,8 @@
 	individually, and since traversing and accessing transitions is a wee bit
 	faster.
 
+2008-03-13  David Lutterkort  <dlutter@redhat.com>
+
 	Remove unused macro
 
 	Clean up fa_iter some
@@ -6265,13 +6303,13 @@
 	When order of states in a set doesn't matter, allow the set to be kept
 	sorted so that search can use binary search.
 
-2008-03-12  David Lutterkort  <dlutter@redhat.com>
-
 	Fix two memory leaks
 
 	Remove the last uses of FA_MAP
 	Use STATE_SET instead, since it's faster and lighterweight
 
+2008-03-12  David Lutterkort  <dlutter@redhat.com>
+
 	Rename structs fa_state and fa_trans to state and trans
 
 	[mq]: min_hopcroft.patch
@@ -6300,8 +6338,6 @@
 	reducs the overhead from memory allocations, since the array is expanded by
 	doubling its size (up to some threshold)
 
-2008-03-11  David Lutterkort  <dlutter@redhat.com>
-
 	fa_star added a spurious epstrans loop on new initial
 
 	Mark live and reachable states
@@ -6324,7 +6360,7 @@
 	Fix subtle bug in determinize
 	Fix a bug that would only hit if '\0' is ever in points.
 
-2008-03-06  David Lutterkort  <dlutter@redhat.com>
+2008-03-07  David Lutterkort  <dlutter@redhat.com>
 
 	Add fa_ambig_example to generate ambiguous words
 	Generate an ambiguous string upv given two languages and directions on how
@@ -6339,9 +6375,9 @@
 	preferences, so that for example, alnum characters are preferred over
 	printable ones, and those over nonprintable ones.
 
-	Fix some cornercases in fa_example
+2008-03-06  David Lutterkort  <dlutter@redhat.com>
 
-2008-03-05  David Lutterkort  <dlutter@redhat.com>
+	Fix some cornercases in fa_example
 
 	Add generators and tests for some basic languages
 	Basic languages are the empty language, the language containing only the
@@ -6362,6 +6398,8 @@
 	Also added switches to augtool to set this from the command line, and to
 	set the filesystem root.
 
+2008-03-05  David Lutterkort  <dlutter@redhat.com>
+
 	Added tag release-0.0.5 for changeset 0efe2a620e39
 
 	Mark print_re as unused
@@ -6374,8 +6412,6 @@
 	To make Augeas threadsafe, we need to move away from keeping stuff in
 	global variables.
 
-2008-03-04  David Lutterkort  <dlutter@redhat.com>
-
 	Add fa_example which produces an example string from a regular language
 
 	Add a test that performs Anders Moeller's ambiguity algorithm manually
@@ -6387,6 +6423,8 @@
 
 	Also added tests to check these two problems.
 
+2008-03-04  David Lutterkort  <dlutter@redhat.com>
+
 	Fix handling of negated charsets
 	Negated charsets where handled entirely wrong. A character set is now
 	represented as a map from char -> {0, 1}. That map is rather big (one byte
@@ -6406,10 +6444,10 @@
 
 	Add deciding unambiguously iterable based on ua concatenable
 
-2008-03-03  David Lutterkort  <dlutter@redhat.com>
-
 	Automatically free all automata allocated during a test
 
+2008-03-03  David Lutterkort  <dlutter@redhat.com>
+
 	Cleanup the returned FA in fa_intersect
 
 	Add a target to run fatest through valgrind
@@ -6426,7 +6464,7 @@
 	Use a linker script instead. The visibility pragma is only available in gcc
 	>= 4.0, and thus imposes a pretty high burden to build Augeas.
 
-2008-02-29  David Lutterkort  <dlutter@redhat.com>
+2008-03-01  David Lutterkort  <dlutter@redhat.com>
 
 	Reign in the number of symbols exported from libaugeas
 	Use visibility=hidden to keep most local symbols to ourselves. Still needs
@@ -6444,6 +6482,8 @@
 
 	Add tests for language subsets and equality
 
+2008-02-29  David Lutterkort  <dlutter@redhat.com>
+
 	The beginnings of a finite automata library
 	The code is heavily based on the Java package dk.brics.automaton by Anders
 	Moeller (http://www.brics.dk/automaton/)
@@ -6465,8 +6505,6 @@
 	When skipping nodes with NULL label, don't segfault if the whole tail of
 	the list has NULL labels
 
-2008-02-25  David Lutterkort  <dlutter@redhat.com>
-
 	Added tag release-0.0.4 for changeset d8e750d82f97
 
 	Version 0.0.4
@@ -6496,6 +6534,8 @@
 
 	Rename AUGEAS_SPECLIB to AUGEAS_LENS_LIB
 
+2008-02-25  David Lutterkort  <dlutter@redhat.com>
+
 	Added tag release-0.0.2 for changeset f981ccccb0ab
 
 	Include the try script in the distribution
@@ -6533,10 +6573,10 @@
 	The list of env vars for AcceptEnv was not being split into individual
 	pieces
 
-2008-02-20  David Lutterkort  <dlutter@redhat.com>
-
 	A (pretty kludgy) description for cmfm.conf
 
+2008-02-20  David Lutterkort  <dlutter@redhat.com>
+
 	Make printing of skel/dict optional
 
 	Print test results a tad prettier
@@ -6574,8 +6614,6 @@
 
 	Allow escaping of a slash in tegular expressions
 
-2008-02-18  David Lutterkort  <dlutter@redhat.com>
-
 	Base parsing completely off regexp matching.
 	Parsing now uses regexp matching, and not the CFG-style parsing based on
 	first sets previously used. This actually makes it easier to write specs,
@@ -6594,6 +6632,8 @@
 
 	Remove unused token T_FIELD
 
+2008-02-18  David Lutterkort  <dlutter@redhat.com>
+
 	Rename match.xaction to match.action
 	The field was named initially to avoid a clash with another 'action' field,
 	but that field is gone now.
@@ -6629,7 +6669,7 @@
 	helps maintain the illusion for users that the split node is really just
 	one node.
 
-2008-02-15  David Lutterkort  <dlutter@redhat.com>
+2008-02-16  David Lutterkort  <dlutter@redhat.com>
 
 	Report some information underneath /augeas
 	The root directory and information about how files were loaded into the
@@ -6637,6 +6677,8 @@
 
 	Fix very bad use of realloc
 
+2008-02-15  David Lutterkort  <dlutter@redhat.com>
+
 	Adjust expected diff
 	Do not allow comments to disappear
 
@@ -6688,8 +6730,6 @@
 
 	Properly handle a NULL value in aug_set. Make aug_insert deal with NULL labels.
 
-2008-02-14  David Lutterkort  <dlutter@redhat.com>
-
 	Fixed, nicely working tests
 
 	Readline completion
@@ -6714,15 +6754,13 @@
 
 	This change is majorly broken.
 
-2008-02-12  David Lutterkort  <dlutter@redhat.com>
-
 	Better description of lenses
 
 	Different representation of the tree
 	The tree is now represented as a tree data structure, where each node in
 	the tree stores only a path component (label).
 
-2008-02-08  David Lutterkort  <dlutter@redhat.com>
+2008-02-09  David Lutterkort  <dlutter@redhat.com>
 
 	Beginnings of a formal writeup
 
@@ -6742,8 +6780,6 @@
 
 	Don't segfault when the parse matches nothing
 
-2008-01-29  David Lutterkort  <dlutter@redhat.com>
-
 	Another yum test
 
 	Remove more unneeded cruft
@@ -6777,6 +6813,8 @@
 
 	Test that reordering of subtrees works
 
+2008-01-29  David Lutterkort  <dlutter@redhat.com>
+
 	Set the root of the tree from include
 
 	Respect ordering of nodes in the config tree.
@@ -6838,7 +6876,7 @@
 
 	Docs
 
-2008-01-24  David Lutterkort  <dlutter@redhat.com>
+2008-01-25  David Lutterkort  <dlutter@redhat.com>
 
 	Rough thoughts about emit
 
@@ -6883,8 +6921,6 @@
 
 	Detect association of values with impossible paths
 
-2008-01-17  David Lutterkort  <dlutter@redhat.com>
-
 	Make augtest set AUGEAS_ROOT and AUGEAS_SPECLIB before running augtool.
 	augtest now copies test files into a separate subdirectory and points
 	augtool to that as its root. It also points augtool to ../spec for the spec
@@ -6943,13 +6979,13 @@
 
 	Remove debug printing in augparse about loaded maps
 
-2008-01-07  David Lutterkort  <dlutter@redhat.com>
+2008-01-08  David Lutterkort  <dlutter@redhat.com>
 
 	Free tokens entirely when freeing file
 
 	Set action in all path components
 
-2008-01-03  David Lutterkort  <dlutter@redhat.com>
+2008-01-04  David Lutterkort  <dlutter@redhat.com>
 
 	Provider that uses specs
 	The spec provider is hooked into libaugeas and loaded. It reads spec files
@@ -6969,7 +7005,7 @@
 
 	Compile regexps for multiline matching
 
-2008-01-02  David Lutterkort  <dlutter@redhat.com>
+2008-01-03  David Lutterkort  <dlutter@redhat.com>
 
 	Fix syntax error; we want to test that missing defaults are noticed
 
@@ -6979,6 +7015,8 @@
 
 	Print the filename in errors about tokens (abbrevs)
 
+2008-01-02  David Lutterkort  <dlutter@redhat.com>
+
 	Add name to grammars
 
 	Add -v switch for printing errors
@@ -6990,7 +7028,7 @@
 	paths is maintained. References to values work with the exception of
 	references to rules.
 
-2007-12-21  David Lutterkort  <dlutter@redhat.com>
+2007-12-22  David Lutterkort  <dlutter@redhat.com>
 
 	Check grammar acceptance/rejection
 
@@ -7004,9 +7042,9 @@
 	  - the assignment part of the action is done after the field/group
 	    has been parsed
 
-	Snapshot before changing the syntax of rule actions
+2007-12-21  David Lutterkort  <dlutter@redhat.com>
 
-2007-12-20  David Lutterkort  <dlutter@redhat.com>
+	Snapshot before changing the syntax of rule actions
 
 	Remove unused keyword and token 'default'
 
@@ -7031,6 +7069,8 @@
 	Produce tokens during parsing.
 	Also, nicer printing of the tokens read.
 
+2007-12-20  David Lutterkort  <dlutter@redhat.com>
+
 	Stricter checking for ambiguous rules
 	Check that all items in alternatives have non-overlapping first sets. Two
 	sets are overlapping if they both contain an entry pointing to the same
@@ -7061,7 +7101,7 @@
 
 	Factor aug_make_file into internal.c
 
-2007-12-01  David Lutterkort  <dlutter@redhat.com>
+2007-12-02  David Lutterkort  <dlutter@redhat.com>
 
 	Be more verbose about which tests were run
 
@@ -7079,7 +7119,7 @@
 
 	Explain yourself
 
-2007-11-30  David Lutterkort  <dlutter@redhat.com>
+2007-12-01  David Lutterkort  <dlutter@redhat.com>
 
 	Add a test that shows how to change the initdefault
 
@@ -7099,6 +7139,8 @@
 
 	aug_rec_save: Check input parameters
 
+2007-11-30  David Lutterkort  <dlutter@redhat.com>
+
 	Major overhaul of record parsing
 	Use PCRE to split records with regexps, and abstract a major chunk of
 	functionality out so it is independent of parsing pam config files
@@ -7111,7 +7153,7 @@
 
 	Basic tests for record parsing
 
-2007-11-26  David Lutterkort  <dlutter@redhat.com>
+2007-11-27  David Lutterkort  <dlutter@redhat.com>
 
 	Trim trailing slashes from paths
 
diff --git a/Makefile.in b/Makefile.in
index d08d7e2..626b008 100644
--- a/Makefile.in
+++ b/Makefile.in
@@ -111,6 +111,7 @@ am__aclocal_m4_deps = $(top_srcdir)/gnulib/m4/00gnulib.m4 \
 	$(top_srcdir)/gnulib/m4/pathmax.m4 \
 	$(top_srcdir)/gnulib/m4/printf.m4 \
 	$(top_srcdir)/gnulib/m4/putenv.m4 \
+	$(top_srcdir)/gnulib/m4/rawmemchr.m4 \
 	$(top_srcdir)/gnulib/m4/readlink.m4 \
 	$(top_srcdir)/gnulib/m4/realloc.m4 \
 	$(top_srcdir)/gnulib/m4/regex.m4 \
@@ -130,6 +131,7 @@ am__aclocal_m4_deps = $(top_srcdir)/gnulib/m4/00gnulib.m4 \
 	$(top_srcdir)/gnulib/m4/stdlib_h.m4 \
 	$(top_srcdir)/gnulib/m4/stpcpy.m4 \
 	$(top_srcdir)/gnulib/m4/stpncpy.m4 \
+	$(top_srcdir)/gnulib/m4/strchrnul.m4 \
 	$(top_srcdir)/gnulib/m4/string_h.m4 \
 	$(top_srcdir)/gnulib/m4/strndup.m4 \
 	$(top_srcdir)/gnulib/m4/strnlen.m4 \
diff --git a/aclocal.m4 b/aclocal.m4
index b3a5ed7..929c6d7 100644
--- a/aclocal.m4
+++ b/aclocal.m4
@@ -177,456 +177,6 @@ else
 fi[]dnl
 ])# PKG_CHECK_MODULES
 
-# po.m4 serial 17 (gettext-0.18)
-dnl Copyright (C) 1995-2010 Free Software Foundation, Inc.
-dnl This file is free software; the Free Software Foundation
-dnl gives unlimited permission to copy and/or distribute it,
-dnl with or without modifications, as long as this notice is preserved.
-dnl
-dnl This file can can be used in projects which are not available under
-dnl the GNU General Public License or the GNU Library General Public
-dnl License but which still want to provide support for the GNU gettext
-dnl functionality.
-dnl Please note that the actual code of the GNU gettext library is covered
-dnl by the GNU Library General Public License, and the rest of the GNU
-dnl gettext package package is covered by the GNU General Public License.
-dnl They are *not* in the public domain.
-
-dnl Authors:
-dnl   Ulrich Drepper <drepper@cygnus.com>, 1995-2000.
-dnl   Bruno Haible <haible@clisp.cons.org>, 2000-2003.
-
-AC_PREREQ([2.50])
-
-dnl Checks for all prerequisites of the po subdirectory.
-AC_DEFUN([AM_PO_SUBDIRS],
-[
-  AC_REQUIRE([AC_PROG_MAKE_SET])dnl
-  AC_REQUIRE([AC_PROG_INSTALL])dnl
-  AC_REQUIRE([AM_PROG_MKDIR_P])dnl defined by automake
-  AC_REQUIRE([AM_NLS])dnl
-
-  dnl Release version of the gettext macros. This is used to ensure that
-  dnl the gettext macros and po/Makefile.in.in are in sync.
-  AC_SUBST([GETTEXT_MACRO_VERSION], [0.18])
-
-  dnl Perform the following tests also if --disable-nls has been given,
-  dnl because they are needed for "make dist" to work.
-
-  dnl Search for GNU msgfmt in the PATH.
-  dnl The first test excludes Solaris msgfmt and early GNU msgfmt versions.
-  dnl The second test excludes FreeBSD msgfmt.
-  AM_PATH_PROG_WITH_TEST(MSGFMT, msgfmt,
-    [$ac_dir/$ac_word --statistics /dev/null >&]AS_MESSAGE_LOG_FD[ 2>&1 &&
-     (if $ac_dir/$ac_word --statistics /dev/null 2>&1 >/dev/null | grep usage >/dev/null; then exit 1; else exit 0; fi)],
-    :)
-  AC_PATH_PROG([GMSGFMT], [gmsgfmt], [$MSGFMT])
-
-  dnl Test whether it is GNU msgfmt >= 0.15.
-changequote(,)dnl
-  case `$MSGFMT --version | sed 1q | sed -e 's,^[^0-9]*,,'` in
-    '' | 0.[0-9] | 0.[0-9].* | 0.1[0-4] | 0.1[0-4].*) MSGFMT_015=: ;;
-    *) MSGFMT_015=$MSGFMT ;;
-  esac
-changequote([,])dnl
-  AC_SUBST([MSGFMT_015])
-changequote(,)dnl
-  case `$GMSGFMT --version | sed 1q | sed -e 's,^[^0-9]*,,'` in
-    '' | 0.[0-9] | 0.[0-9].* | 0.1[0-4] | 0.1[0-4].*) GMSGFMT_015=: ;;
-    *) GMSGFMT_015=$GMSGFMT ;;
-  esac
-changequote([,])dnl
-  AC_SUBST([GMSGFMT_015])
-
-  dnl Search for GNU xgettext 0.12 or newer in the PATH.
-  dnl The first test excludes Solaris xgettext and early GNU xgettext versions.
-  dnl The second test excludes FreeBSD xgettext.
-  AM_PATH_PROG_WITH_TEST(XGETTEXT, xgettext,
-    [$ac_dir/$ac_word --omit-header --copyright-holder= --msgid-bugs-address= /dev/null >&]AS_MESSAGE_LOG_FD[ 2>&1 &&
-     (if $ac_dir/$ac_word --omit-header --copyright-holder= --msgid-bugs-address= /dev/null 2>&1 >/dev/null | grep usage >/dev/null; then exit 1; else exit 0; fi)],
-    :)
-  dnl Remove leftover from FreeBSD xgettext call.
-  rm -f messages.po
-
-  dnl Test whether it is GNU xgettext >= 0.15.
-changequote(,)dnl
-  case `$XGETTEXT --version | sed 1q | sed -e 's,^[^0-9]*,,'` in
-    '' | 0.[0-9] | 0.[0-9].* | 0.1[0-4] | 0.1[0-4].*) XGETTEXT_015=: ;;
-    *) XGETTEXT_015=$XGETTEXT ;;
-  esac
-changequote([,])dnl
-  AC_SUBST([XGETTEXT_015])
-
-  dnl Search for GNU msgmerge 0.11 or newer in the PATH.
-  AM_PATH_PROG_WITH_TEST(MSGMERGE, msgmerge,
-    [$ac_dir/$ac_word --update -q /dev/null /dev/null >&]AS_MESSAGE_LOG_FD[ 2>&1], :)
-
-  dnl Installation directories.
-  dnl Autoconf >= 2.60 defines localedir. For older versions of autoconf, we
-  dnl have to define it here, so that it can be used in po/Makefile.
-  test -n "$localedir" || localedir='${datadir}/locale'
-  AC_SUBST([localedir])
-
-  dnl Support for AM_XGETTEXT_OPTION.
-  test -n "${XGETTEXT_EXTRA_OPTIONS+set}" || XGETTEXT_EXTRA_OPTIONS=
-  AC_SUBST([XGETTEXT_EXTRA_OPTIONS])
-
-  AC_CONFIG_COMMANDS([po-directories], [[
-    for ac_file in $CONFIG_FILES; do
-      # Support "outfile[:infile[:infile...]]"
-      case "$ac_file" in
-        *:*) ac_file=`echo "$ac_file"|sed 's%:.*%%'` ;;
-      esac
-      # PO directories have a Makefile.in generated from Makefile.in.in.
-      case "$ac_file" in */Makefile.in)
-        # Adjust a relative srcdir.
-        ac_dir=`echo "$ac_file"|sed 's%/[^/][^/]*$%%'`
-        ac_dir_suffix="/`echo "$ac_dir"|sed 's%^\./%%'`"
-        ac_dots=`echo "$ac_dir_suffix"|sed 's%/[^/]*%../%g'`
-        # In autoconf-2.13 it is called $ac_given_srcdir.
-        # In autoconf-2.50 it is called $srcdir.
-        test -n "$ac_given_srcdir" || ac_given_srcdir="$srcdir"
-        case "$ac_given_srcdir" in
-          .)  top_srcdir=`echo $ac_dots|sed 's%/$%%'` ;;
-          /*) top_srcdir="$ac_given_srcdir" ;;
-          *)  top_srcdir="$ac_dots$ac_given_srcdir" ;;
-        esac
-        # Treat a directory as a PO directory if and only if it has a
-        # POTFILES.in file. This allows packages to have multiple PO
-        # directories under different names or in different locations.
-        if test -f "$ac_given_srcdir/$ac_dir/POTFILES.in"; then
-          rm -f "$ac_dir/POTFILES"
-          test -n "$as_me" && echo "$as_me: creating $ac_dir/POTFILES" || echo "creating $ac_dir/POTFILES"
-          cat "$ac_given_srcdir/$ac_dir/POTFILES.in" | sed -e "/^#/d" -e "/^[ 	]*\$/d" -e "s,.*,     $top_srcdir/& \\\\," | sed -e "\$s/\(.*\) \\\\/\1/" > "$ac_dir/POTFILES"
-          POMAKEFILEDEPS="POTFILES.in"
-          # ALL_LINGUAS, POFILES, UPDATEPOFILES, DUMMYPOFILES, GMOFILES depend
-          # on $ac_dir but don't depend on user-specified configuration
-          # parameters.
-          if test -f "$ac_given_srcdir/$ac_dir/LINGUAS"; then
-            # The LINGUAS file contains the set of available languages.
-            if test -n "$OBSOLETE_ALL_LINGUAS"; then
-              test -n "$as_me" && echo "$as_me: setting ALL_LINGUAS in configure.in is obsolete" || echo "setting ALL_LINGUAS in configure.in is obsolete"
-            fi
-            ALL_LINGUAS_=`sed -e "/^#/d" -e "s/#.*//" "$ac_given_srcdir/$ac_dir/LINGUAS"`
-            # Hide the ALL_LINGUAS assigment from automake < 1.5.
-            eval 'ALL_LINGUAS''=$ALL_LINGUAS_'
-            POMAKEFILEDEPS="$POMAKEFILEDEPS LINGUAS"
-          else
-            # The set of available languages was given in configure.in.
-            # Hide the ALL_LINGUAS assigment from automake < 1.5.
-            eval 'ALL_LINGUAS''=$OBSOLETE_ALL_LINGUAS'
-          fi
-          # Compute POFILES
-          # as      $(foreach lang, $(ALL_LINGUAS), $(srcdir)/$(lang).po)
-          # Compute UPDATEPOFILES
-          # as      $(foreach lang, $(ALL_LINGUAS), $(lang).po-update)
-          # Compute DUMMYPOFILES
-          # as      $(foreach lang, $(ALL_LINGUAS), $(lang).nop)
-          # Compute GMOFILES
-          # as      $(foreach lang, $(ALL_LINGUAS), $(srcdir)/$(lang).gmo)
-          case "$ac_given_srcdir" in
-            .) srcdirpre= ;;
-            *) srcdirpre='$(srcdir)/' ;;
-          esac
-          POFILES=
-          UPDATEPOFILES=
-          DUMMYPOFILES=
-          GMOFILES=
-          for lang in $ALL_LINGUAS; do
-            POFILES="$POFILES $srcdirpre$lang.po"
-            UPDATEPOFILES="$UPDATEPOFILES $lang.po-update"
-            DUMMYPOFILES="$DUMMYPOFILES $lang.nop"
-            GMOFILES="$GMOFILES $srcdirpre$lang.gmo"
-          done
-          # CATALOGS depends on both $ac_dir and the user's LINGUAS
-          # environment variable.
-          INST_LINGUAS=
-          if test -n "$ALL_LINGUAS"; then
-            for presentlang in $ALL_LINGUAS; do
-              useit=no
-              if test "%UNSET%" != "$LINGUAS"; then
-                desiredlanguages="$LINGUAS"
-              else
-                desiredlanguages="$ALL_LINGUAS"
-              fi
-              for desiredlang in $desiredlanguages; do
-                # Use the presentlang catalog if desiredlang is
-                #   a. equal to presentlang, or
-                #   b. a variant of presentlang (because in this case,
-                #      presentlang can be used as a fallback for messages
-                #      which are not translated in the desiredlang catalog).
-                case "$desiredlang" in
-                  "$presentlang"*) useit=yes;;
-                esac
-              done
-              if test $useit = yes; then
-                INST_LINGUAS="$INST_LINGUAS $presentlang"
-              fi
-            done
-          fi
-          CATALOGS=
-          if test -n "$INST_LINGUAS"; then
-            for lang in $INST_LINGUAS; do
-              CATALOGS="$CATALOGS $lang.gmo"
-            done
-          fi
-          test -n "$as_me" && echo "$as_me: creating $ac_dir/Makefile" || echo "creating $ac_dir/Makefile"
-          sed -e "/^POTFILES =/r $ac_dir/POTFILES" -e "/^# Makevars/r $ac_given_srcdir/$ac_dir/Makevars" -e "s|@POFILES@|$POFILES|g" -e "s|@UPDATEPOFILES@|$UPDATEPOFILES|g" -e "s|@DUMMYPOFILES@|$DUMMYPOFILES|g" -e "s|@GMOFILES@|$GMOFILES|g" -e "s|@CATALOGS@|$CATALOGS|g" -e "s|@POMAKEFILEDEPS@|$POMAKEFILEDEPS|g" "$ac_dir/Makefile.in" > "$ac_dir/Makefile"
-          for f in "$ac_given_srcdir/$ac_dir"/Rules-*; do
-            if test -f "$f"; then
-              case "$f" in
-                *.orig | *.bak | *~) ;;
-                *) cat "$f" >> "$ac_dir/Makefile" ;;
-              esac
-            fi
-          done
-        fi
-        ;;
-      esac
-    done]],
-   [# Capture the value of obsolete ALL_LINGUAS because we need it to compute
-    # POFILES, UPDATEPOFILES, DUMMYPOFILES, GMOFILES, CATALOGS. But hide it
-    # from automake < 1.5.
-    eval 'OBSOLETE_ALL_LINGUAS''="$ALL_LINGUAS"'
-    # Capture the value of LINGUAS because we need it to compute CATALOGS.
-    LINGUAS="${LINGUAS-%UNSET%}"
-   ])
-])
-
-dnl Postprocesses a Makefile in a directory containing PO files.
-AC_DEFUN([AM_POSTPROCESS_PO_MAKEFILE],
-[
-  # When this code is run, in config.status, two variables have already been
-  # set:
-  # - OBSOLETE_ALL_LINGUAS is the value of LINGUAS set in configure.in,
-  # - LINGUAS is the value of the environment variable LINGUAS at configure
-  #   time.
-
-changequote(,)dnl
-  # Adjust a relative srcdir.
-  ac_dir=`echo "$ac_file"|sed 's%/[^/][^/]*$%%'`
-  ac_dir_suffix="/`echo "$ac_dir"|sed 's%^\./%%'`"
-  ac_dots=`echo "$ac_dir_suffix"|sed 's%/[^/]*%../%g'`
-  # In autoconf-2.13 it is called $ac_given_srcdir.
-  # In autoconf-2.50 it is called $srcdir.
-  test -n "$ac_given_srcdir" || ac_given_srcdir="$srcdir"
-  case "$ac_given_srcdir" in
-    .)  top_srcdir=`echo $ac_dots|sed 's%/$%%'` ;;
-    /*) top_srcdir="$ac_given_srcdir" ;;
-    *)  top_srcdir="$ac_dots$ac_given_srcdir" ;;
-  esac
-
-  # Find a way to echo strings without interpreting backslash.
-  if test "X`(echo '\t') 2>/dev/null`" = 'X\t'; then
-    gt_echo='echo'
-  else
-    if test "X`(printf '%s\n' '\t') 2>/dev/null`" = 'X\t'; then
-      gt_echo='printf %s\n'
-    else
-      echo_func () {
-        cat <<EOT
-$*
-EOT
-      }
-      gt_echo='echo_func'
-    fi
-  fi
-
-  # A sed script that extracts the value of VARIABLE from a Makefile.
-  sed_x_variable='
-# Test if the hold space is empty.
-x
-s/P/P/
-x
-ta
-# Yes it was empty. Look if we have the expected variable definition.
-/^[	 ]*VARIABLE[	 ]*=/{
-  # Seen the first line of the variable definition.
-  s/^[	 ]*VARIABLE[	 ]*=//
-  ba
-}
-bd
-:a
-# Here we are processing a line from the variable definition.
-# Remove comment, more precisely replace it with a space.
-s/#.*$/ /
-# See if the line ends in a backslash.
-tb
-:b
-s/\\$//
-# Print the line, without the trailing backslash.
-p
-tc
-# There was no trailing backslash. The end of the variable definition is
-# reached. Clear the hold space.
-s/^.*$//
-x
-bd
-:c
-# A trailing backslash means that the variable definition continues in the
-# next line. Put a nonempty string into the hold space to indicate this.
-s/^.*$/P/
-x
-:d
-'
-changequote([,])dnl
-
-  # Set POTFILES to the value of the Makefile variable POTFILES.
-  sed_x_POTFILES=`$gt_echo "$sed_x_variable" | sed -e '/^ *#/d' -e 's/VARIABLE/POTFILES/g'`
-  POTFILES=`sed -n -e "$sed_x_POTFILES" < "$ac_file"`
-  # Compute POTFILES_DEPS as
-  #   $(foreach file, $(POTFILES), $(top_srcdir)/$(file))
-  POTFILES_DEPS=
-  for file in $POTFILES; do
-    POTFILES_DEPS="$POTFILES_DEPS "'$(top_srcdir)/'"$file"
-  done
-  POMAKEFILEDEPS=""
-
-  if test -n "$OBSOLETE_ALL_LINGUAS"; then
-    test -n "$as_me" && echo "$as_me: setting ALL_LINGUAS in configure.in is obsolete" || echo "setting ALL_LINGUAS in configure.in is obsolete"
-  fi
-  if test -f "$ac_given_srcdir/$ac_dir/LINGUAS"; then
-    # The LINGUAS file contains the set of available languages.
-    ALL_LINGUAS_=`sed -e "/^#/d" -e "s/#.*//" "$ac_given_srcdir/$ac_dir/LINGUAS"`
-    POMAKEFILEDEPS="$POMAKEFILEDEPS LINGUAS"
-  else
-    # Set ALL_LINGUAS to the value of the Makefile variable LINGUAS.
-    sed_x_LINGUAS=`$gt_echo "$sed_x_variable" | sed -e '/^ *#/d' -e 's/VARIABLE/LINGUAS/g'`
-    ALL_LINGUAS_=`sed -n -e "$sed_x_LINGUAS" < "$ac_file"`
-  fi
-  # Hide the ALL_LINGUAS assigment from automake < 1.5.
-  eval 'ALL_LINGUAS''=$ALL_LINGUAS_'
-  # Compute POFILES
-  # as      $(foreach lang, $(ALL_LINGUAS), $(srcdir)/$(lang).po)
-  # Compute UPDATEPOFILES
-  # as      $(foreach lang, $(ALL_LINGUAS), $(lang).po-update)
-  # Compute DUMMYPOFILES
-  # as      $(foreach lang, $(ALL_LINGUAS), $(lang).nop)
-  # Compute GMOFILES
-  # as      $(foreach lang, $(ALL_LINGUAS), $(srcdir)/$(lang).gmo)
-  # Compute PROPERTIESFILES
-  # as      $(foreach lang, $(ALL_LINGUAS), $(top_srcdir)/$(DOMAIN)_$(lang).properties)
-  # Compute CLASSFILES
-  # as      $(foreach lang, $(ALL_LINGUAS), $(top_srcdir)/$(DOMAIN)_$(lang).class)
-  # Compute QMFILES
-  # as      $(foreach lang, $(ALL_LINGUAS), $(srcdir)/$(lang).qm)
-  # Compute MSGFILES
-  # as      $(foreach lang, $(ALL_LINGUAS), $(srcdir)/$(frob $(lang)).msg)
-  # Compute RESOURCESDLLFILES
-  # as      $(foreach lang, $(ALL_LINGUAS), $(srcdir)/$(frob $(lang))/$(DOMAIN).resources.dll)
-  case "$ac_given_srcdir" in
-    .) srcdirpre= ;;
-    *) srcdirpre='$(srcdir)/' ;;
-  esac
-  POFILES=
-  UPDATEPOFILES=
-  DUMMYPOFILES=
-  GMOFILES=
-  PROPERTIESFILES=
-  CLASSFILES=
-  QMFILES=
-  MSGFILES=
-  RESOURCESDLLFILES=
-  for lang in $ALL_LINGUAS; do
-    POFILES="$POFILES $srcdirpre$lang.po"
-    UPDATEPOFILES="$UPDATEPOFILES $lang.po-update"
-    DUMMYPOFILES="$DUMMYPOFILES $lang.nop"
-    GMOFILES="$GMOFILES $srcdirpre$lang.gmo"
-    PROPERTIESFILES="$PROPERTIESFILES \$(top_srcdir)/\$(DOMAIN)_$lang.properties"
-    CLASSFILES="$CLASSFILES \$(top_srcdir)/\$(DOMAIN)_$lang.class"
-    QMFILES="$QMFILES $srcdirpre$lang.qm"
-    frobbedlang=`echo $lang | sed -e 's/\..*$//' -e 'y/ABCDEFGHIJKLMNOPQRSTUVWXYZ/abcdefghijklmnopqrstuvwxyz/'`
-    MSGFILES="$MSGFILES $srcdirpre$frobbedlang.msg"
-    frobbedlang=`echo $lang | sed -e 's/_/-/g' -e 's/^sr-CS/sr-SP/' -e 's/@latin$/-Latn/' -e 's/@cyrillic$/-Cyrl/' -e 's/^sr-SP$/sr-SP-Latn/' -e 's/^uz-UZ$/uz-UZ-Latn/'`
-    RESOURCESDLLFILES="$RESOURCESDLLFILES $srcdirpre$frobbedlang/\$(DOMAIN).resources.dll"
-  done
-  # CATALOGS depends on both $ac_dir and the user's LINGUAS
-  # environment variable.
-  INST_LINGUAS=
-  if test -n "$ALL_LINGUAS"; then
-    for presentlang in $ALL_LINGUAS; do
-      useit=no
-      if test "%UNSET%" != "$LINGUAS"; then
-        desiredlanguages="$LINGUAS"
-      else
-        desiredlanguages="$ALL_LINGUAS"
-      fi
-      for desiredlang in $desiredlanguages; do
-        # Use the presentlang catalog if desiredlang is
-        #   a. equal to presentlang, or
-        #   b. a variant of presentlang (because in this case,
-        #      presentlang can be used as a fallback for messages
-        #      which are not translated in the desiredlang catalog).
-        case "$desiredlang" in
-          "$presentlang"*) useit=yes;;
-        esac
-      done
-      if test $useit = yes; then
-        INST_LINGUAS="$INST_LINGUAS $presentlang"
-      fi
-    done
-  fi
-  CATALOGS=
-  JAVACATALOGS=
-  QTCATALOGS=
-  TCLCATALOGS=
-  CSHARPCATALOGS=
-  if test -n "$INST_LINGUAS"; then
-    for lang in $INST_LINGUAS; do
-      CATALOGS="$CATALOGS $lang.gmo"
-      JAVACATALOGS="$JAVACATALOGS \$(DOMAIN)_$lang.properties"
-      QTCATALOGS="$QTCATALOGS $lang.qm"
-      frobbedlang=`echo $lang | sed -e 's/\..*$//' -e 'y/ABCDEFGHIJKLMNOPQRSTUVWXYZ/abcdefghijklmnopqrstuvwxyz/'`
-      TCLCATALOGS="$TCLCATALOGS $frobbedlang.msg"
-      frobbedlang=`echo $lang | sed -e 's/_/-/g' -e 's/^sr-CS/sr-SP/' -e 's/@latin$/-Latn/' -e 's/@cyrillic$/-Cyrl/' -e 's/^sr-SP$/sr-SP-Latn/' -e 's/^uz-UZ$/uz-UZ-Latn/'`
-      CSHARPCATALOGS="$CSHARPCATALOGS $frobbedlang/\$(DOMAIN).resources.dll"
-    done
-  fi
-
-  sed -e "s|@POTFILES_DEPS@|$POTFILES_DEPS|g" -e "s|@POFILES@|$POFILES|g" -e "s|@UPDATEPOFILES@|$UPDATEPOFILES|g" -e "s|@DUMMYPOFILES@|$DUMMYPOFILES|g" -e "s|@GMOFILES@|$GMOFILES|g" -e "s|@PROPERTIESFILES@|$PROPERTIESFILES|g" -e "s|@CLASSFILES@|$CLASSFILES|g" -e "s|@QMFILES@|$QMFILES|g" -e "s|@MSGFILES@|$MSGFILES|g" -e "s|@RESOURCESDLLFILES@|$RESOURCESDLLFILES|g" -e "s|@CATALOGS@|$CATALOGS|g" -e "s|@JAVACATALOGS@|$JAVACATALOGS|g" -e "s|@QTCATALOGS@|$QTCATALOGS|g" -e "s|@TCLCATALOGS@|$TCLCATALOGS|g" -e "s|@CSHARPCATALOGS@|$CSHARPCATALOGS|g" -e 's,^#distdir:,distdir:,' < "$ac_file" > "$ac_file.tmp"
-  if grep -l '@TCLCATALOGS@' "$ac_file" > /dev/null; then
-    # Add dependencies that cannot be formulated as a simple suffix rule.
-    for lang in $ALL_LINGUAS; do
-      frobbedlang=`echo $lang | sed -e 's/\..*$//' -e 'y/ABCDEFGHIJKLMNOPQRSTUVWXYZ/abcdefghijklmnopqrstuvwxyz/'`
-      cat >> "$ac_file.tmp" <<EOF
-$frobbedlang.msg: $lang.po
-	@echo "\$(MSGFMT) -c --tcl -d \$(srcdir) -l $lang $srcdirpre$lang.po"; \
-	\$(MSGFMT) -c --tcl -d "\$(srcdir)" -l $lang $srcdirpre$lang.po || { rm -f "\$(srcdir)/$frobbedlang.msg"; exit 1; }
-EOF
-    done
-  fi
-  if grep -l '@CSHARPCATALOGS@' "$ac_file" > /dev/null; then
-    # Add dependencies that cannot be formulated as a simple suffix rule.
-    for lang in $ALL_LINGUAS; do
-      frobbedlang=`echo $lang | sed -e 's/_/-/g' -e 's/^sr-CS/sr-SP/' -e 's/@latin$/-Latn/' -e 's/@cyrillic$/-Cyrl/' -e 's/^sr-SP$/sr-SP-Latn/' -e 's/^uz-UZ$/uz-UZ-Latn/'`
-      cat >> "$ac_file.tmp" <<EOF
-$frobbedlang/\$(DOMAIN).resources.dll: $lang.po
-	@echo "\$(MSGFMT) -c --csharp -d \$(srcdir) -l $lang $srcdirpre$lang.po -r \$(DOMAIN)"; \
-	\$(MSGFMT) -c --csharp -d "\$(srcdir)" -l $lang $srcdirpre$lang.po -r "\$(DOMAIN)" || { rm -f "\$(srcdir)/$frobbedlang.msg"; exit 1; }
-EOF
-    done
-  fi
-  if test -n "$POMAKEFILEDEPS"; then
-    cat >> "$ac_file.tmp" <<EOF
-Makefile: $POMAKEFILEDEPS
-EOF
-  fi
-  mv "$ac_file.tmp" "$ac_file"
-])
-
-dnl Initializes the accumulator used by AM_XGETTEXT_OPTION.
-AC_DEFUN([AM_XGETTEXT_OPTION_INIT],
-[
-  XGETTEXT_EXTRA_OPTIONS=
-])
-
-dnl Registers an option to be passed to xgettext in the po subdirectory.
-AC_DEFUN([AM_XGETTEXT_OPTION],
-[
-  AC_REQUIRE([AM_XGETTEXT_OPTION_INIT])
-  XGETTEXT_EXTRA_OPTIONS="$XGETTEXT_EXTRA_OPTIONS $1"
-])
-
 # Copyright (C) 2002, 2003, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
 #
 # This file is free software; the Free Software Foundation
@@ -1664,6 +1214,7 @@ m4_include([gnulib/m4/open.m4])
 m4_include([gnulib/m4/pathmax.m4])
 m4_include([gnulib/m4/printf.m4])
 m4_include([gnulib/m4/putenv.m4])
+m4_include([gnulib/m4/rawmemchr.m4])
 m4_include([gnulib/m4/readlink.m4])
 m4_include([gnulib/m4/realloc.m4])
 m4_include([gnulib/m4/regex.m4])
@@ -1683,6 +1234,7 @@ m4_include([gnulib/m4/stdio_h.m4])
 m4_include([gnulib/m4/stdlib_h.m4])
 m4_include([gnulib/m4/stpcpy.m4])
 m4_include([gnulib/m4/stpncpy.m4])
+m4_include([gnulib/m4/strchrnul.m4])
 m4_include([gnulib/m4/string_h.m4])
 m4_include([gnulib/m4/strndup.m4])
 m4_include([gnulib/m4/strnlen.m4])
diff --git a/config.h.in b/config.h.in
index adddf6f..3aad469 100644
--- a/config.h.in
+++ b/config.h.in
@@ -102,6 +102,9 @@
 /* Define to 1 when the gnulib module putenv should be tested. */
 #undef GNULIB_TEST_PUTENV
 
+/* Define to 1 when the gnulib module rawmemchr should be tested. */
+#undef GNULIB_TEST_RAWMEMCHR
+
 /* Define to 1 when the gnulib module readlink should be tested. */
 #undef GNULIB_TEST_READLINK
 
@@ -126,6 +129,9 @@
 /* Define to 1 when the gnulib module stpncpy should be tested. */
 #undef GNULIB_TEST_STPNCPY
 
+/* Define to 1 when the gnulib module strchrnul should be tested. */
+#undef GNULIB_TEST_STRCHRNUL
+
 /* Define to 1 when the gnulib module strndup should be tested. */
 #undef GNULIB_TEST_STRNDUP
 
@@ -371,6 +377,9 @@
 /* Define if the POSIX multithreading library has read/write locks. */
 #undef HAVE_PTHREAD_RWLOCK
 
+/* Define to 1 if you have the `rawmemchr' function. */
+#undef HAVE_RAWMEMCHR
+
 /* Define to 1 if atoll is declared even after undefining macros. */
 #undef HAVE_RAW_DECL_ATOLL
 
@@ -900,6 +909,9 @@
 /* Define if you have the stpncpy() function and it works. */
 #undef HAVE_STPNCPY
 
+/* Define to 1 if you have the `strchrnul' function. */
+#undef HAVE_STRCHRNUL
+
 /* Define to 1 if you have the `strerror_r' function. */
 #undef HAVE_STRERROR_R
 
diff --git a/configure b/configure
index f67c89d..c5f0028 100755
--- a/configure
+++ b/configure
@@ -6327,6 +6327,8 @@ fi
   # Code from module open-tests:
   # Code from module pathmax:
   # Code from module putenv:
+  # Code from module rawmemchr:
+  # Code from module rawmemchr-tests:
   # Code from module readlink:
   # Code from module readlink-tests:
   # Code from module realloc-posix:
@@ -6355,6 +6357,8 @@ fi
   # Code from module stdlib-tests:
   # Code from module stpcpy:
   # Code from module stpncpy:
+  # Code from module strchrnul:
+  # Code from module strchrnul-tests:
   # Code from module streq:
   # Code from module string:
   # Code from module string-tests:
@@ -18679,9 +18683,6 @@ $as_echo "#define HAVE_SNPRINTF_RETVAL_C99 1" >>confdefs.h
   esac
 
 
-  XGETTEXT_EXTRA_OPTIONS=
-
-
 
 
 
@@ -23567,6 +23568,51 @@ $as_echo "#define GNULIB_TEST_NL_LANGINFO 1" >>confdefs.h
 
 
 
+  # Code from module rawmemchr:
+
+
+
+
+
+
+
+
+
+
+
+
+  for ac_func in rawmemchr
+do :
+  ac_fn_c_check_func "$LINENO" "rawmemchr" "ac_cv_func_rawmemchr"
+if test "x$ac_cv_func_rawmemchr" = xyes; then :
+  cat >>confdefs.h <<_ACEOF
+#define HAVE_RAWMEMCHR 1
+_ACEOF
+
+else
+
+    gl_LIBOBJS="$gl_LIBOBJS $ac_func.$ac_objext"
+
+fi
+done
+
+
+  if test $ac_cv_func_rawmemchr = no; then
+    HAVE_RAWMEMCHR=0
+    :
+  fi
+
+
+
+
+  GNULIB_RAWMEMCHR=1
+
+
+
+$as_echo "#define GNULIB_TEST_RAWMEMCHR 1" >>confdefs.h
+
+
+
   # Code from module readlink:
 
 
@@ -25681,6 +25727,51 @@ $as_echo "#define GNULIB_TEST_STPNCPY 1" >>confdefs.h
 
 
 
+  # Code from module strchrnul:
+
+
+
+
+
+
+
+
+
+
+
+
+  for ac_func in strchrnul
+do :
+  ac_fn_c_check_func "$LINENO" "strchrnul" "ac_cv_func_strchrnul"
+if test "x$ac_cv_func_strchrnul" = xyes; then :
+  cat >>confdefs.h <<_ACEOF
+#define HAVE_STRCHRNUL 1
+_ACEOF
+
+else
+
+    gl_LIBOBJS="$gl_LIBOBJS $ac_func.$ac_objext"
+
+fi
+done
+
+
+  if test $ac_cv_func_strchrnul = no; then
+    HAVE_STRCHRNUL=0
+    :
+  fi
+
+
+
+
+  GNULIB_STRCHRNUL=1
+
+
+
+$as_echo "#define GNULIB_TEST_STRCHRNUL 1" >>confdefs.h
+
+
+
   # Code from module streq:
   # Code from module string:
 
@@ -26647,13 +26738,6 @@ $as_echo "#define GNULIB_TEST_VASPRINTF 1" >>confdefs.h
 
 
 
-
-  XGETTEXT_EXTRA_OPTIONS="$XGETTEXT_EXTRA_OPTIONS --flag=asprintf:2:c-format"
-
-
-
-  XGETTEXT_EXTRA_OPTIONS="$XGETTEXT_EXTRA_OPTIONS --flag=vasprintf:2:c-format"
-
   # Code from module verify:
   # Code from module warn-on-use:
   # Code from module wchar:
@@ -30061,6 +30145,83 @@ $as_echo "#define GNULIB_TEST_PUTENV 1" >>confdefs.h
 
 
 
+
+  # Check for mmap(). Don't use AC_FUNC_MMAP, because it checks too much: it
+  # fails on HP-UX 11, because MAP_FIXED mappings do not work. But this is
+  # irrelevant for anonymous mappings.
+  ac_fn_c_check_func "$LINENO" "mmap" "ac_cv_func_mmap"
+if test "x$ac_cv_func_mmap" = xyes; then :
+  gl_have_mmap=yes
+else
+  gl_have_mmap=no
+fi
+
+
+  # Try to allow MAP_ANONYMOUS.
+  gl_have_mmap_anonymous=no
+  if test $gl_have_mmap = yes; then
+    { $as_echo "$as_me:${as_lineno-$LINENO}: checking for MAP_ANONYMOUS" >&5
+$as_echo_n "checking for MAP_ANONYMOUS... " >&6; }
+    cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+#include <sys/mman.h>
+#ifdef MAP_ANONYMOUS
+    I cant identify this map.
+#endif
+
+_ACEOF
+if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+  $EGREP "I cant identify this map." >/dev/null 2>&1; then :
+  gl_have_mmap_anonymous=yes
+fi
+rm -f conftest*
+
+    if test $gl_have_mmap_anonymous != yes; then
+      cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+#include <sys/mman.h>
+#ifdef MAP_ANON
+    I cant identify this map.
+#endif
+
+_ACEOF
+if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+  $EGREP "I cant identify this map." >/dev/null 2>&1; then :
+
+$as_echo "#define MAP_ANONYMOUS MAP_ANON" >>confdefs.h
+
+         gl_have_mmap_anonymous=yes
+fi
+rm -f conftest*
+
+    fi
+    { $as_echo "$as_me:${as_lineno-$LINENO}: result: $gl_have_mmap_anonymous" >&5
+$as_echo "$gl_have_mmap_anonymous" >&6; }
+    if test $gl_have_mmap_anonymous = yes; then
+
+$as_echo "#define HAVE_MAP_ANONYMOUS 1" >>confdefs.h
+
+    fi
+  fi
+
+
+  :
+
+
+
+
+
+
+  :
+
+
+
+
+
+
+
   if test $HAVE_SETENV$REPLACE_SETENV != 10; then
 
 
diff --git a/doc/Makefile.in b/doc/Makefile.in
index 70dd818..9484d0f 100644
--- a/doc/Makefile.in
+++ b/doc/Makefile.in
@@ -104,6 +104,7 @@ am__aclocal_m4_deps = $(top_srcdir)/gnulib/m4/00gnulib.m4 \
 	$(top_srcdir)/gnulib/m4/pathmax.m4 \
 	$(top_srcdir)/gnulib/m4/printf.m4 \
 	$(top_srcdir)/gnulib/m4/putenv.m4 \
+	$(top_srcdir)/gnulib/m4/rawmemchr.m4 \
 	$(top_srcdir)/gnulib/m4/readlink.m4 \
 	$(top_srcdir)/gnulib/m4/realloc.m4 \
 	$(top_srcdir)/gnulib/m4/regex.m4 \
@@ -123,6 +124,7 @@ am__aclocal_m4_deps = $(top_srcdir)/gnulib/m4/00gnulib.m4 \
 	$(top_srcdir)/gnulib/m4/stdlib_h.m4 \
 	$(top_srcdir)/gnulib/m4/stpcpy.m4 \
 	$(top_srcdir)/gnulib/m4/stpncpy.m4 \
+	$(top_srcdir)/gnulib/m4/strchrnul.m4 \
 	$(top_srcdir)/gnulib/m4/string_h.m4 \
 	$(top_srcdir)/gnulib/m4/strndup.m4 \
 	$(top_srcdir)/gnulib/m4/strnlen.m4 \
diff --git a/doc/naturaldocs/Makefile.in b/doc/naturaldocs/Makefile.in
index 9213cb8..194e32e 100644
--- a/doc/naturaldocs/Makefile.in
+++ b/doc/naturaldocs/Makefile.in
@@ -103,6 +103,7 @@ am__aclocal_m4_deps = $(top_srcdir)/gnulib/m4/00gnulib.m4 \
 	$(top_srcdir)/gnulib/m4/pathmax.m4 \
 	$(top_srcdir)/gnulib/m4/printf.m4 \
 	$(top_srcdir)/gnulib/m4/putenv.m4 \
+	$(top_srcdir)/gnulib/m4/rawmemchr.m4 \
 	$(top_srcdir)/gnulib/m4/readlink.m4 \
 	$(top_srcdir)/gnulib/m4/realloc.m4 \
 	$(top_srcdir)/gnulib/m4/regex.m4 \
@@ -122,6 +123,7 @@ am__aclocal_m4_deps = $(top_srcdir)/gnulib/m4/00gnulib.m4 \
 	$(top_srcdir)/gnulib/m4/stdlib_h.m4 \
 	$(top_srcdir)/gnulib/m4/stpcpy.m4 \
 	$(top_srcdir)/gnulib/m4/stpncpy.m4 \
+	$(top_srcdir)/gnulib/m4/strchrnul.m4 \
 	$(top_srcdir)/gnulib/m4/string_h.m4 \
 	$(top_srcdir)/gnulib/m4/strndup.m4 \
 	$(top_srcdir)/gnulib/m4/strnlen.m4 \
diff --git a/examples/Makefile.in b/examples/Makefile.in
index c76141e..7a15b20 100644
--- a/examples/Makefile.in
+++ b/examples/Makefile.in
@@ -105,6 +105,7 @@ am__aclocal_m4_deps = $(top_srcdir)/gnulib/m4/00gnulib.m4 \
 	$(top_srcdir)/gnulib/m4/pathmax.m4 \
 	$(top_srcdir)/gnulib/m4/printf.m4 \
 	$(top_srcdir)/gnulib/m4/putenv.m4 \
+	$(top_srcdir)/gnulib/m4/rawmemchr.m4 \
 	$(top_srcdir)/gnulib/m4/readlink.m4 \
 	$(top_srcdir)/gnulib/m4/realloc.m4 \
 	$(top_srcdir)/gnulib/m4/regex.m4 \
@@ -124,6 +125,7 @@ am__aclocal_m4_deps = $(top_srcdir)/gnulib/m4/00gnulib.m4 \
 	$(top_srcdir)/gnulib/m4/stdlib_h.m4 \
 	$(top_srcdir)/gnulib/m4/stpcpy.m4 \
 	$(top_srcdir)/gnulib/m4/stpncpy.m4 \
+	$(top_srcdir)/gnulib/m4/strchrnul.m4 \
 	$(top_srcdir)/gnulib/m4/string_h.m4 \
 	$(top_srcdir)/gnulib/m4/strndup.m4 \
 	$(top_srcdir)/gnulib/m4/strnlen.m4 \
diff --git a/gnulib/lib/Makefile.am b/gnulib/lib/Makefile.am
index b299e53..7892284 100644
--- a/gnulib/lib/Makefile.am
+++ b/gnulib/lib/Makefile.am
@@ -9,7 +9,7 @@
 # the same distribution terms as the rest of that program.
 #
 # Generated by gnulib-tool.
-# Reproduce by: gnulib-tool --import --dir=. --lib=libgnu --source-base=gnulib/lib --m4-base=gnulib/m4 --doc-base=doc --tests-base=gnulib/tests --aux-dir=build/aux --with-tests --lgpl=2 --libtool --macro-prefix=gl argz canonicalize-lgpl fnmatch getline getopt-gnu gitlog-to-changelog isblank locale regex safe-alloc selinux-h stpcpy stpncpy strndup sys_wait vasprintf
+# Reproduce by: gnulib-tool --import --dir=. --lib=libgnu --source-base=gnulib/lib --m4-base=gnulib/m4 --doc-base=doc --tests-base=gnulib/tests --aux-dir=build/aux --with-tests --lgpl=2 --libtool --macro-prefix=gl argz canonicalize-lgpl fnmatch getline getopt-gnu gitlog-to-changelog isblank locale regex safe-alloc selinux-h stpcpy stpncpy strchrnul strndup sys_wait vasprintf
 
 AUTOMAKE_OPTIONS = 1.5 gnits
 
@@ -615,6 +615,15 @@ EXTRA_DIST += pathmax.h
 
 ## end   gnulib module pathmax
 
+## begin gnulib module rawmemchr
+
+
+EXTRA_DIST += rawmemchr.c rawmemchr.valgrind
+
+EXTRA_libgnu_la_SOURCES += rawmemchr.c
+
+## end   gnulib module rawmemchr
+
 ## begin gnulib module readlink
 
 
@@ -1009,6 +1018,15 @@ EXTRA_libgnu_la_SOURCES += stpncpy.c
 
 ## end   gnulib module stpncpy
 
+## begin gnulib module strchrnul
+
+
+EXTRA_DIST += strchrnul.c strchrnul.valgrind
+
+EXTRA_libgnu_la_SOURCES += strchrnul.c
+
+## end   gnulib module strchrnul
+
 ## begin gnulib module streq
 
 
diff --git a/gnulib/lib/Makefile.in b/gnulib/lib/Makefile.in
index f3b8518..f7c69a2 100644
--- a/gnulib/lib/Makefile.in
+++ b/gnulib/lib/Makefile.in
@@ -24,7 +24,7 @@
 # the same distribution terms as the rest of that program.
 #
 # Generated by gnulib-tool.
-# Reproduce by: gnulib-tool --import --dir=. --lib=libgnu --source-base=gnulib/lib --m4-base=gnulib/m4 --doc-base=doc --tests-base=gnulib/tests --aux-dir=build/aux --with-tests --lgpl=2 --libtool --macro-prefix=gl argz canonicalize-lgpl fnmatch getline getopt-gnu gitlog-to-changelog isblank locale regex safe-alloc selinux-h stpcpy stpncpy strndup sys_wait vasprintf
+# Reproduce by: gnulib-tool --import --dir=. --lib=libgnu --source-base=gnulib/lib --m4-base=gnulib/m4 --doc-base=doc --tests-base=gnulib/tests --aux-dir=build/aux --with-tests --lgpl=2 --libtool --macro-prefix=gl argz canonicalize-lgpl fnmatch getline getopt-gnu gitlog-to-changelog isblank locale regex safe-alloc selinux-h stpcpy stpncpy strchrnul strndup sys_wait vasprintf
 
 
 
@@ -118,6 +118,7 @@ am__aclocal_m4_deps = $(top_srcdir)/gnulib/m4/00gnulib.m4 \
 	$(top_srcdir)/gnulib/m4/pathmax.m4 \
 	$(top_srcdir)/gnulib/m4/printf.m4 \
 	$(top_srcdir)/gnulib/m4/putenv.m4 \
+	$(top_srcdir)/gnulib/m4/rawmemchr.m4 \
 	$(top_srcdir)/gnulib/m4/readlink.m4 \
 	$(top_srcdir)/gnulib/m4/realloc.m4 \
 	$(top_srcdir)/gnulib/m4/regex.m4 \
@@ -137,6 +138,7 @@ am__aclocal_m4_deps = $(top_srcdir)/gnulib/m4/00gnulib.m4 \
 	$(top_srcdir)/gnulib/m4/stdlib_h.m4 \
 	$(top_srcdir)/gnulib/m4/stpcpy.m4 \
 	$(top_srcdir)/gnulib/m4/stpncpy.m4 \
+	$(top_srcdir)/gnulib/m4/strchrnul.m4 \
 	$(top_srcdir)/gnulib/m4/string_h.m4 \
 	$(top_srcdir)/gnulib/m4/strndup.m4 \
 	$(top_srcdir)/gnulib/m4/strnlen.m4 \
@@ -1014,11 +1016,12 @@ EXTRA_DIST = alloca.c alloca.in.h \
 	locale.in.h lstat.c malloc.c malloc.c malloca.h \
 	malloca.valgrind mbrtowc.c mbsinit.c mbsrtowcs-impl.h \
 	mbsrtowcs-state.c mbsrtowcs.c mbtowc-impl.h mbtowc.c memchr.c \
-	memchr.valgrind mempcpy.c nl_langinfo.c pathmax.h readlink.c \
-	realloc.c regcomp.c regex.c regex.h regex_internal.c \
-	regex_internal.h regexec.c safe-alloc.c safe-alloc.h \
-	getfilecon.c stat.c stdbool.in.h stddef.in.h stdint.in.h \
-	stdio.in.h stdlib.in.h stpcpy.c stpncpy.c streq.h string.in.h \
+	memchr.valgrind mempcpy.c nl_langinfo.c pathmax.h rawmemchr.c \
+	rawmemchr.valgrind readlink.c realloc.c regcomp.c regex.c \
+	regex.h regex_internal.c regex_internal.h regexec.c \
+	safe-alloc.c safe-alloc.h getfilecon.c stat.c stdbool.in.h \
+	stddef.in.h stdint.in.h stdio.in.h stdlib.in.h stpcpy.c \
+	stpncpy.c strchrnul.c strchrnul.valgrind streq.h string.in.h \
 	strndup.c strnlen.c str-two-way.h strstr.c sys_stat.in.h \
 	sys_wait.in.h time.in.h unistd.in.h \
 	$(top_srcdir)/build/aux/unused-parameter.h asnprintf.c \
@@ -1076,11 +1079,11 @@ EXTRA_libgnu_la_SOURCES = alloca.c argz.c btowc.c canonicalize-lgpl.c \
 	fnmatch.c fnmatch_loop.c getdelim.c getline.c getopt.c \
 	getopt1.c isblank.c lstat.c malloc.c malloc.c mbrtowc.c \
 	mbsinit.c mbsrtowcs-state.c mbsrtowcs.c mbtowc.c memchr.c \
-	mempcpy.c nl_langinfo.c readlink.c realloc.c regcomp.c regex.c \
-	regex_internal.c regexec.c safe-alloc.c getfilecon.c stat.c \
-	stpcpy.c stpncpy.c strndup.c strnlen.c strstr.c asnprintf.c \
-	printf-args.c printf-parse.c vasnprintf.c asprintf.c \
-	vasprintf.c wcrtomb.c
+	mempcpy.c nl_langinfo.c rawmemchr.c readlink.c realloc.c \
+	regcomp.c regex.c regex_internal.c regexec.c safe-alloc.c \
+	getfilecon.c stat.c stpcpy.c stpncpy.c strchrnul.c strndup.c \
+	strnlen.c strstr.c asnprintf.c printf-args.c printf-parse.c \
+	vasnprintf.c asprintf.c vasprintf.c wcrtomb.c
 libgnu_la_LDFLAGS = $(AM_LDFLAGS) -no-undefined $(LIB_SELINUX) \
 	$(LTLIBINTL)
 ARG_NONNULL_H = arg-nonnull.h
@@ -1174,6 +1177,7 @@ distclean-compile:
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/nl_langinfo.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/printf-args.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/printf-parse.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/rawmemchr.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/readlink.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/realloc.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/regcomp.Plo@am__quote@
@@ -1184,6 +1188,7 @@ distclean-compile:
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/stat.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/stpcpy.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/stpncpy.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/strchrnul.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/strndup.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/strnlen.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/strnlen1.Plo@am__quote@
diff --git a/gnulib/lib/rawmemchr.c b/gnulib/lib/rawmemchr.c
new file mode 100644
index 0000000..ef81f96
--- /dev/null
+++ b/gnulib/lib/rawmemchr.c
@@ -0,0 +1,136 @@
+/* Searching in a string.
+   Copyright (C) 2008-2011 Free Software Foundation, Inc.
+
+   This program is free software: you can redistribute it and/or modify
+   it under the terms of the GNU Lesser General Public License as published by
+   the Free Software Foundation; either version 2.1 of the License, or
+   (at your option) any later version.
+
+   This program is distributed in the hope that it will be useful,
+   but WITHOUT ANY WARRANTY; without even the implied warranty of
+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+   GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License
+   along with this program.  If not, see <http://www.gnu.org/licenses/>.  */
+
+#include <config.h>
+
+/* Specification.  */
+#include <string.h>
+
+/* Find the first occurrence of C in S.  */
+void *
+rawmemchr (const void *s, int c_in)
+{
+  /* On 32-bit hardware, choosing longword to be a 32-bit unsigned
+     long instead of a 64-bit uintmax_t tends to give better
+     performance.  On 64-bit hardware, unsigned long is generally 64
+     bits already.  Change this typedef to experiment with
+     performance.  */
+  typedef unsigned long int longword;
+
+  const unsigned char *char_ptr;
+  const longword *longword_ptr;
+  longword repeated_one;
+  longword repeated_c;
+  unsigned char c;
+
+  c = (unsigned char) c_in;
+
+  /* Handle the first few bytes by reading one byte at a time.
+     Do this until CHAR_PTR is aligned on a longword boundary.  */
+  for (char_ptr = (const unsigned char *) s;
+       (size_t) char_ptr % sizeof (longword) != 0;
+       ++char_ptr)
+    if (*char_ptr == c)
+      return (void *) char_ptr;
+
+  longword_ptr = (const longword *) char_ptr;
+
+  /* All these elucidatory comments refer to 4-byte longwords,
+     but the theory applies equally well to any size longwords.  */
+
+  /* Compute auxiliary longword values:
+     repeated_one is a value which has a 1 in every byte.
+     repeated_c has c in every byte.  */
+  repeated_one = 0x01010101;
+  repeated_c = c | (c << 8);
+  repeated_c |= repeated_c << 16;
+  if (0xffffffffU < (longword) -1)
+    {
+      repeated_one |= repeated_one << 31 << 1;
+      repeated_c |= repeated_c << 31 << 1;
+      if (8 < sizeof (longword))
+        {
+          size_t i;
+
+          for (i = 64; i < sizeof (longword) * 8; i *= 2)
+            {
+              repeated_one |= repeated_one << i;
+              repeated_c |= repeated_c << i;
+            }
+        }
+    }
+
+  /* Instead of the traditional loop which tests each byte, we will
+     test a longword at a time.  The tricky part is testing if *any of
+     the four* bytes in the longword in question are equal to NUL or
+     c.  We first use an xor with repeated_c.  This reduces the task
+     to testing whether *any of the four* bytes in longword1 is zero.
+
+     We compute tmp =
+       ((longword1 - repeated_one) & ~longword1) & (repeated_one << 7).
+     That is, we perform the following operations:
+       1. Subtract repeated_one.
+       2. & ~longword1.
+       3. & a mask consisting of 0x80 in every byte.
+     Consider what happens in each byte:
+       - If a byte of longword1 is zero, step 1 and 2 transform it into 0xff,
+         and step 3 transforms it into 0x80.  A carry can also be propagated
+         to more significant bytes.
+       - If a byte of longword1 is nonzero, let its lowest 1 bit be at
+         position k (0 <= k <= 7); so the lowest k bits are 0.  After step 1,
+         the byte ends in a single bit of value 0 and k bits of value 1.
+         After step 2, the result is just k bits of value 1: 2^k - 1.  After
+         step 3, the result is 0.  And no carry is produced.
+     So, if longword1 has only non-zero bytes, tmp is zero.
+     Whereas if longword1 has a zero byte, call j the position of the least
+     significant zero byte.  Then the result has a zero at positions 0, ...,
+     j-1 and a 0x80 at position j.  We cannot predict the result at the more
+     significant bytes (positions j+1..3), but it does not matter since we
+     already have a non-zero bit at position 8*j+7.
+
+     The test whether any byte in longword1 is zero is equivalent
+     to testing whether tmp is nonzero.
+
+     This test can read beyond the end of a string, depending on where
+     C_IN is encountered.  However, this is considered safe since the
+     initialization phase ensured that the read will be aligned,
+     therefore, the read will not cross page boundaries and will not
+     cause a fault.  */
+
+  while (1)
+    {
+      longword longword1 = *longword_ptr ^ repeated_c;
+
+      if ((((longword1 - repeated_one) & ~longword1)
+           & (repeated_one << 7)) != 0)
+        break;
+      longword_ptr++;
+    }
+
+  char_ptr = (const unsigned char *) longword_ptr;
+
+  /* At this point, we know that one of the sizeof (longword) bytes
+     starting at char_ptr is == c.  On little-endian machines, we
+     could determine the first such byte without any further memory
+     accesses, just by looking at the tmp result from the last loop
+     iteration.  But this does not work on big-endian machines.
+     Choose code that works in both cases.  */
+
+  char_ptr = (unsigned char *) longword_ptr;
+  while (*char_ptr != c)
+    char_ptr++;
+  return (void *) char_ptr;
+}
diff --git a/gnulib/lib/rawmemchr.valgrind b/gnulib/lib/rawmemchr.valgrind
new file mode 100644
index 0000000..6363923
--- /dev/null
+++ b/gnulib/lib/rawmemchr.valgrind
@@ -0,0 +1,12 @@
+# Suppress a valgrind message about use of uninitialized memory in rawmemchr().
+# This use is OK because it provides only a speedup.
+{
+    rawmemchr-value4
+    Memcheck:Value4
+    fun:rawmemchr
+}
+{
+    rawmemchr-value8
+    Memcheck:Value8
+    fun:rawmemchr
+}
diff --git a/gnulib/lib/strchrnul.c b/gnulib/lib/strchrnul.c
new file mode 100644
index 0000000..d3b077f
--- /dev/null
+++ b/gnulib/lib/strchrnul.c
@@ -0,0 +1,142 @@
+/* Searching in a string.
+   Copyright (C) 2003, 2007-2011 Free Software Foundation, Inc.
+
+   This program is free software: you can redistribute it and/or modify
+   it under the terms of the GNU Lesser General Public License as published by
+   the Free Software Foundation; either version 2.1 of the License, or
+   (at your option) any later version.
+
+   This program is distributed in the hope that it will be useful,
+   but WITHOUT ANY WARRANTY; without even the implied warranty of
+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+   GNU Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public License
+   along with this program.  If not, see <http://www.gnu.org/licenses/>.  */
+
+#include <config.h>
+
+/* Specification.  */
+#include <string.h>
+
+/* Find the first occurrence of C in S or the final NUL byte.  */
+char *
+strchrnul (const char *s, int c_in)
+{
+  /* On 32-bit hardware, choosing longword to be a 32-bit unsigned
+     long instead of a 64-bit uintmax_t tends to give better
+     performance.  On 64-bit hardware, unsigned long is generally 64
+     bits already.  Change this typedef to experiment with
+     performance.  */
+  typedef unsigned long int longword;
+
+  const unsigned char *char_ptr;
+  const longword *longword_ptr;
+  longword repeated_one;
+  longword repeated_c;
+  unsigned char c;
+
+  c = (unsigned char) c_in;
+  if (!c)
+    return rawmemchr (s, 0);
+
+  /* Handle the first few bytes by reading one byte at a time.
+     Do this until CHAR_PTR is aligned on a longword boundary.  */
+  for (char_ptr = (const unsigned char *) s;
+       (size_t) char_ptr % sizeof (longword) != 0;
+       ++char_ptr)
+    if (!*char_ptr || *char_ptr == c)
+      return (char *) char_ptr;
+
+  longword_ptr = (const longword *) char_ptr;
+
+  /* All these elucidatory comments refer to 4-byte longwords,
+     but the theory applies equally well to any size longwords.  */
+
+  /* Compute auxiliary longword values:
+     repeated_one is a value which has a 1 in every byte.
+     repeated_c has c in every byte.  */
+  repeated_one = 0x01010101;
+  repeated_c = c | (c << 8);
+  repeated_c |= repeated_c << 16;
+  if (0xffffffffU < (longword) -1)
+    {
+      repeated_one |= repeated_one << 31 << 1;
+      repeated_c |= repeated_c << 31 << 1;
+      if (8 < sizeof (longword))
+        {
+          size_t i;
+
+          for (i = 64; i < sizeof (longword) * 8; i *= 2)
+            {
+              repeated_one |= repeated_one << i;
+              repeated_c |= repeated_c << i;
+            }
+        }
+    }
+
+  /* Instead of the traditional loop which tests each byte, we will
+     test a longword at a time.  The tricky part is testing if *any of
+     the four* bytes in the longword in question are equal to NUL or
+     c.  We first use an xor with repeated_c.  This reduces the task
+     to testing whether *any of the four* bytes in longword1 or
+     longword2 is zero.
+
+     Let's consider longword1.  We compute tmp =
+       ((longword1 - repeated_one) & ~longword1) & (repeated_one << 7).
+     That is, we perform the following operations:
+       1. Subtract repeated_one.
+       2. & ~longword1.
+       3. & a mask consisting of 0x80 in every byte.
+     Consider what happens in each byte:
+       - If a byte of longword1 is zero, step 1 and 2 transform it into 0xff,
+         and step 3 transforms it into 0x80.  A carry can also be propagated
+         to more significant bytes.
+       - If a byte of longword1 is nonzero, let its lowest 1 bit be at
+         position k (0 <= k <= 7); so the lowest k bits are 0.  After step 1,
+         the byte ends in a single bit of value 0 and k bits of value 1.
+         After step 2, the result is just k bits of value 1: 2^k - 1.  After
+         step 3, the result is 0.  And no carry is produced.
+     So, if longword1 has only non-zero bytes, tmp is zero.
+     Whereas if longword1 has a zero byte, call j the position of the least
+     significant zero byte.  Then the result has a zero at positions 0, ...,
+     j-1 and a 0x80 at position j.  We cannot predict the result at the more
+     significant bytes (positions j+1..3), but it does not matter since we
+     already have a non-zero bit at position 8*j+7.
+
+     The test whether any byte in longword1 or longword2 is zero is equivalent
+     to testing whether tmp1 is nonzero or tmp2 is nonzero.  We can combine
+     this into a single test, whether (tmp1 | tmp2) is nonzero.
+
+     This test can read more than one byte beyond the end of a string,
+     depending on where the terminating NUL is encountered.  However,
+     this is considered safe since the initialization phase ensured
+     that the read will be aligned, therefore, the read will not cross
+     page boundaries and will not cause a fault.  */
+
+  while (1)
+    {
+      longword longword1 = *longword_ptr ^ repeated_c;
+      longword longword2 = *longword_ptr;
+
+      if (((((longword1 - repeated_one) & ~longword1)
+            | ((longword2 - repeated_one) & ~longword2))
+           & (repeated_one << 7)) != 0)
+        break;
+      longword_ptr++;
+    }
+
+  char_ptr = (const unsigned char *) longword_ptr;
+
+  /* At this point, we know that one of the sizeof (longword) bytes
+     starting at char_ptr is == 0 or == c.  On little-endian machines,
+     we could determine the first such byte without any further memory
+     accesses, just by looking at the tmp result from the last loop
+     iteration.  But this does not work on big-endian machines.
+     Choose code that works in both cases.  */
+
+  char_ptr = (unsigned char *) longword_ptr;
+  while (*char_ptr && (*char_ptr != c))
+    char_ptr++;
+  return (char *) char_ptr;
+}
diff --git a/gnulib/lib/strchrnul.valgrind b/gnulib/lib/strchrnul.valgrind
new file mode 100644
index 0000000..b14fa13
--- /dev/null
+++ b/gnulib/lib/strchrnul.valgrind
@@ -0,0 +1,12 @@
+# Suppress a valgrind message about use of uninitialized memory in strchrnul().
+# This use is OK because it provides only a speedup.
+{
+    strchrnul-value4
+    Memcheck:Value4
+    fun:strchrnul
+}
+{
+    strchrnul-value8
+    Memcheck:Value8
+    fun:strchrnul
+}
diff --git a/gnulib/m4/gnulib-comp.m4 b/gnulib/m4/gnulib-comp.m4
index e42948b..2aca838 100644
--- a/gnulib/m4/gnulib-comp.m4
+++ b/gnulib/m4/gnulib-comp.m4
@@ -109,6 +109,8 @@ AC_DEFUN([gl_EARLY],
   # Code from module open-tests:
   # Code from module pathmax:
   # Code from module putenv:
+  # Code from module rawmemchr:
+  # Code from module rawmemchr-tests:
   # Code from module readlink:
   # Code from module readlink-tests:
   # Code from module realloc-posix:
@@ -137,6 +139,8 @@ AC_DEFUN([gl_EARLY],
   # Code from module stdlib-tests:
   # Code from module stpcpy:
   # Code from module stpncpy:
+  # Code from module strchrnul:
+  # Code from module strchrnul-tests:
   # Code from module streq:
   # Code from module string:
   # Code from module string-tests:
@@ -290,6 +294,9 @@ AC_SUBST([LTALLOCA])
   gl_LANGINFO_MODULE_INDICATOR([nl_langinfo])
   # Code from module pathmax:
   gl_PATHMAX
+  # Code from module rawmemchr:
+  gl_FUNC_RAWMEMCHR
+  gl_STRING_MODULE_INDICATOR([rawmemchr])
   # Code from module readlink:
   gl_FUNC_READLINK
   gl_UNISTD_MODULE_INDICATOR([readlink])
@@ -327,6 +334,9 @@ AC_SUBST([LTALLOCA])
   # Code from module stpncpy:
   gl_FUNC_STPNCPY
   gl_STRING_MODULE_INDICATOR([stpncpy])
+  # Code from module strchrnul:
+  gl_FUNC_STRCHRNUL
+  gl_STRING_MODULE_INDICATOR([strchrnul])
   # Code from module streq:
   # Code from module string:
   gl_HEADER_STRING_H
@@ -453,6 +463,10 @@ changequote([, ])dnl
   gl_FCNTL_MODULE_INDICATOR([open])
   gl_FUNC_PUTENV
   gl_STDLIB_MODULE_INDICATOR([putenv])
+  dnl Check for prerequisites for memory fence checks.
+  gl_FUNC_MMAP_ANON
+  AC_CHECK_HEADERS_ONCE([sys/mman.h])
+  AC_CHECK_FUNCS_ONCE([mprotect])
   gl_FUNC_SETENV
   gl_STDLIB_MODULE_INDICATOR([setenv])
   gl_FUNC_SETLOCALE
@@ -635,6 +649,8 @@ AC_DEFUN([gl_FILE_LIST], [
   lib/printf-args.h
   lib/printf-parse.c
   lib/printf-parse.h
+  lib/rawmemchr.c
+  lib/rawmemchr.valgrind
   lib/readlink.c
   lib/realloc.c
   lib/ref-add.sin
@@ -659,6 +675,8 @@ AC_DEFUN([gl_FILE_LIST], [
   lib/stpcpy.c
   lib/stpncpy.c
   lib/str-two-way.h
+  lib/strchrnul.c
+  lib/strchrnul.valgrind
   lib/streq.h
   lib/string.in.h
   lib/strndup.c
@@ -740,6 +758,7 @@ AC_DEFUN([gl_FILE_LIST], [
   m4/pathmax.m4
   m4/printf.m4
   m4/putenv.m4
+  m4/rawmemchr.m4
   m4/readlink.m4
   m4/realloc.m4
   m4/regex.m4
@@ -759,6 +778,7 @@ AC_DEFUN([gl_FILE_LIST], [
   m4/stdlib_h.m4
   m4/stpcpy.m4
   m4/stpncpy.m4
+  m4/strchrnul.m4
   m4/string_h.m4
   m4/strndup.m4
   m4/strnlen.m4
@@ -840,6 +860,7 @@ AC_DEFUN([gl_FILE_LIST], [
   tests/test-nl_langinfo.sh
   tests/test-open.c
   tests/test-open.h
+  tests/test-rawmemchr.c
   tests/test-readlink.c
   tests/test-readlink.h
   tests/test-safe-alloc.c
@@ -855,6 +876,7 @@ AC_DEFUN([gl_FILE_LIST], [
   tests/test-stdint.c
   tests/test-stdio.c
   tests/test-stdlib.c
+  tests/test-strchrnul.c
   tests/test-string.c
   tests/test-strnlen.c
   tests/test-strstr.c
diff --git a/gnulib/m4/rawmemchr.m4 b/gnulib/m4/rawmemchr.m4
new file mode 100644
index 0000000..542cba1
--- /dev/null
+++ b/gnulib/m4/rawmemchr.m4
@@ -0,0 +1,21 @@
+# rawmemchr.m4 serial 1
+dnl Copyright (C) 2003, 2007-2011 Free Software Foundation, Inc.
+dnl This file is free software; the Free Software Foundation
+dnl gives unlimited permission to copy and/or distribute it,
+dnl with or without modifications, as long as this notice is preserved.
+
+AC_DEFUN([gl_FUNC_RAWMEMCHR],
+[
+  dnl Persuade glibc <string.h> to declare rawmemchr().
+  AC_REQUIRE([AC_USE_SYSTEM_EXTENSIONS])
+
+  AC_REQUIRE([gl_HEADER_STRING_H_DEFAULTS])
+  AC_REPLACE_FUNCS([rawmemchr])
+  if test $ac_cv_func_rawmemchr = no; then
+    HAVE_RAWMEMCHR=0
+    gl_PREREQ_RAWMEMCHR
+  fi
+])
+
+# Prerequisites of lib/strchrnul.c.
+AC_DEFUN([gl_PREREQ_RAWMEMCHR], [:])
diff --git a/gnulib/m4/strchrnul.m4 b/gnulib/m4/strchrnul.m4
new file mode 100644
index 0000000..a64e805
--- /dev/null
+++ b/gnulib/m4/strchrnul.m4
@@ -0,0 +1,21 @@
+# strchrnul.m4 serial 7
+dnl Copyright (C) 2003, 2007, 2009-2011 Free Software Foundation, Inc.
+dnl This file is free software; the Free Software Foundation
+dnl gives unlimited permission to copy and/or distribute it,
+dnl with or without modifications, as long as this notice is preserved.
+
+AC_DEFUN([gl_FUNC_STRCHRNUL],
+[
+  dnl Persuade glibc <string.h> to declare strchrnul().
+  AC_REQUIRE([AC_USE_SYSTEM_EXTENSIONS])
+
+  AC_REQUIRE([gl_HEADER_STRING_H_DEFAULTS])
+  AC_REPLACE_FUNCS([strchrnul])
+  if test $ac_cv_func_strchrnul = no; then
+    HAVE_STRCHRNUL=0
+    gl_PREREQ_STRCHRNUL
+  fi
+])
+
+# Prerequisites of lib/strchrnul.c.
+AC_DEFUN([gl_PREREQ_STRCHRNUL], [:])
diff --git a/gnulib/tests/Makefile.am b/gnulib/tests/Makefile.am
index 3676a7d..2331f4b 100644
--- a/gnulib/tests/Makefile.am
+++ b/gnulib/tests/Makefile.am
@@ -488,6 +488,14 @@ EXTRA_libtests_a_SOURCES += putenv.c
 
 ## end   gnulib module putenv
 
+## begin gnulib module rawmemchr-tests
+
+TESTS += test-rawmemchr
+check_PROGRAMS += test-rawmemchr
+EXTRA_DIST += test-rawmemchr.c zerosize-ptr.h signature.h macros.h
+
+## end   gnulib module rawmemchr-tests
+
 ## begin gnulib module readlink-tests
 
 TESTS += test-readlink
@@ -598,6 +606,14 @@ EXTRA_DIST += test-stdlib.c test-sys_wait.h
 
 ## end   gnulib module stdlib-tests
 
+## begin gnulib module strchrnul-tests
+
+TESTS += test-strchrnul
+check_PROGRAMS += test-strchrnul
+EXTRA_DIST += test-strchrnul.c signature.h macros.h
+
+## end   gnulib module strchrnul-tests
+
 ## begin gnulib module string-tests
 
 TESTS += test-string
diff --git a/gnulib/tests/Makefile.in b/gnulib/tests/Makefile.in
index 2e36ff5..a7cf54e 100644
--- a/gnulib/tests/Makefile.in
+++ b/gnulib/tests/Makefile.in
@@ -62,19 +62,21 @@ TESTS = test-alloca-opt$(EXEEXT) test-binary-io.sh test-btowc1.sh \
 	test-mbrtowc-w32-5.sh test-mbsinit.sh test-mbsrtowcs1.sh \
 	test-mbsrtowcs2.sh test-mbsrtowcs3.sh test-mbsrtowcs4.sh \
 	test-memchr$(EXEEXT) test-nl_langinfo.sh test-open$(EXEEXT) \
-	test-readlink$(EXEEXT) test-safe-alloc$(EXEEXT) \
-	test-setenv$(EXEEXT) test-setlocale1.sh test-setlocale2.sh \
-	test-stat$(EXEEXT) test-stdbool$(EXEEXT) test-stddef$(EXEEXT) \
+	test-rawmemchr$(EXEEXT) test-readlink$(EXEEXT) \
+	test-safe-alloc$(EXEEXT) test-setenv$(EXEEXT) \
+	test-setlocale1.sh test-setlocale2.sh test-stat$(EXEEXT) \
+	test-stdbool$(EXEEXT) test-stddef$(EXEEXT) \
 	test-stdint$(EXEEXT) test-stdio$(EXEEXT) test-stdlib$(EXEEXT) \
-	test-string$(EXEEXT) test-strnlen$(EXEEXT) \
-	test-strstr$(EXEEXT) test-symlink$(EXEEXT) \
-	test-sys_stat$(EXEEXT) test-sys_wait$(EXEEXT) \
-	test-time$(EXEEXT) test-unistd$(EXEEXT) test-unsetenv$(EXEEXT) \
-	test-vasnprintf$(EXEEXT) test-vasprintf$(EXEEXT) \
-	test-verify$(EXEEXT) test-verify.sh test-wchar$(EXEEXT) \
-	test-wcrtomb.sh test-wcrtomb-w32-1.sh test-wcrtomb-w32-2.sh \
-	test-wcrtomb-w32-3.sh test-wcrtomb-w32-4.sh \
-	test-wcrtomb-w32-5.sh test-wctype-h$(EXEEXT)
+	test-strchrnul$(EXEEXT) test-string$(EXEEXT) \
+	test-strnlen$(EXEEXT) test-strstr$(EXEEXT) \
+	test-symlink$(EXEEXT) test-sys_stat$(EXEEXT) \
+	test-sys_wait$(EXEEXT) test-time$(EXEEXT) test-unistd$(EXEEXT) \
+	test-unsetenv$(EXEEXT) test-vasnprintf$(EXEEXT) \
+	test-vasprintf$(EXEEXT) test-verify$(EXEEXT) test-verify.sh \
+	test-wchar$(EXEEXT) test-wcrtomb.sh test-wcrtomb-w32-1.sh \
+	test-wcrtomb-w32-2.sh test-wcrtomb-w32-3.sh \
+	test-wcrtomb-w32-4.sh test-wcrtomb-w32-5.sh \
+	test-wctype-h$(EXEEXT)
 XFAIL_TESTS =
 noinst_PROGRAMS =
 check_PROGRAMS = test-alloca-opt$(EXEEXT) test-binary-io$(EXEEXT) \
@@ -92,17 +94,19 @@ check_PROGRAMS = test-alloca-opt$(EXEEXT) test-binary-io$(EXEEXT) \
 	test-mbrtowc$(EXEEXT) test-mbrtowc-w32$(EXEEXT) \
 	test-mbsinit$(EXEEXT) test-mbsrtowcs$(EXEEXT) \
 	test-memchr$(EXEEXT) test-nl_langinfo$(EXEEXT) \
-	test-open$(EXEEXT) test-readlink$(EXEEXT) \
-	test-safe-alloc$(EXEEXT) test-setenv$(EXEEXT) \
-	test-setlocale1$(EXEEXT) test-setlocale2$(EXEEXT) \
-	test-stat$(EXEEXT) test-stdbool$(EXEEXT) test-stddef$(EXEEXT) \
+	test-open$(EXEEXT) test-rawmemchr$(EXEEXT) \
+	test-readlink$(EXEEXT) test-safe-alloc$(EXEEXT) \
+	test-setenv$(EXEEXT) test-setlocale1$(EXEEXT) \
+	test-setlocale2$(EXEEXT) test-stat$(EXEEXT) \
+	test-stdbool$(EXEEXT) test-stddef$(EXEEXT) \
 	test-stdint$(EXEEXT) test-stdio$(EXEEXT) test-stdlib$(EXEEXT) \
-	test-string$(EXEEXT) test-strnlen$(EXEEXT) \
-	test-strstr$(EXEEXT) test-symlink$(EXEEXT) \
-	test-sys_stat$(EXEEXT) test-sys_wait$(EXEEXT) \
-	test-time$(EXEEXT) test-unistd$(EXEEXT) test-unsetenv$(EXEEXT) \
-	test-vasnprintf$(EXEEXT) test-vasprintf$(EXEEXT) \
-	test-verify$(EXEEXT) test-wchar$(EXEEXT) test-wcrtomb$(EXEEXT) \
+	test-strchrnul$(EXEEXT) test-string$(EXEEXT) \
+	test-strnlen$(EXEEXT) test-strstr$(EXEEXT) \
+	test-symlink$(EXEEXT) test-sys_stat$(EXEEXT) \
+	test-sys_wait$(EXEEXT) test-time$(EXEEXT) test-unistd$(EXEEXT) \
+	test-unsetenv$(EXEEXT) test-vasnprintf$(EXEEXT) \
+	test-vasprintf$(EXEEXT) test-verify$(EXEEXT) \
+	test-wchar$(EXEEXT) test-wcrtomb$(EXEEXT) \
 	test-wcrtomb-w32$(EXEEXT) test-wctype-h$(EXEEXT)
 subdir = gnulib/tests
 DIST_COMMON = $(noinst_HEADERS) $(srcdir)/Makefile.am \
@@ -176,6 +180,7 @@ am__aclocal_m4_deps = $(top_srcdir)/gnulib/m4/00gnulib.m4 \
 	$(top_srcdir)/gnulib/m4/pathmax.m4 \
 	$(top_srcdir)/gnulib/m4/printf.m4 \
 	$(top_srcdir)/gnulib/m4/putenv.m4 \
+	$(top_srcdir)/gnulib/m4/rawmemchr.m4 \
 	$(top_srcdir)/gnulib/m4/readlink.m4 \
 	$(top_srcdir)/gnulib/m4/realloc.m4 \
 	$(top_srcdir)/gnulib/m4/regex.m4 \
@@ -195,6 +200,7 @@ am__aclocal_m4_deps = $(top_srcdir)/gnulib/m4/00gnulib.m4 \
 	$(top_srcdir)/gnulib/m4/stdlib_h.m4 \
 	$(top_srcdir)/gnulib/m4/stpcpy.m4 \
 	$(top_srcdir)/gnulib/m4/stpncpy.m4 \
+	$(top_srcdir)/gnulib/m4/strchrnul.m4 \
 	$(top_srcdir)/gnulib/m4/string_h.m4 \
 	$(top_srcdir)/gnulib/m4/strndup.m4 \
 	$(top_srcdir)/gnulib/m4/strnlen.m4 \
@@ -401,6 +407,11 @@ test_open_OBJECTS = test-open.$(OBJEXT)
 test_open_LDADD = $(LDADD)
 test_open_DEPENDENCIES = libtests.a ../../gnulib/lib/libgnu.la \
 	libtests.a $(am__DEPENDENCIES_1)
+test_rawmemchr_SOURCES = test-rawmemchr.c
+test_rawmemchr_OBJECTS = test-rawmemchr.$(OBJEXT)
+test_rawmemchr_LDADD = $(LDADD)
+test_rawmemchr_DEPENDENCIES = libtests.a ../../gnulib/lib/libgnu.la \
+	libtests.a $(am__DEPENDENCIES_1)
 test_readlink_SOURCES = test-readlink.c
 test_readlink_OBJECTS = test-readlink.$(OBJEXT)
 test_readlink_LDADD = $(LDADD)
@@ -456,6 +467,11 @@ test_stdlib_OBJECTS = test-stdlib.$(OBJEXT)
 test_stdlib_LDADD = $(LDADD)
 test_stdlib_DEPENDENCIES = libtests.a ../../gnulib/lib/libgnu.la \
 	libtests.a $(am__DEPENDENCIES_1)
+test_strchrnul_SOURCES = test-strchrnul.c
+test_strchrnul_OBJECTS = test-strchrnul.$(OBJEXT)
+test_strchrnul_LDADD = $(LDADD)
+test_strchrnul_DEPENDENCIES = libtests.a ../../gnulib/lib/libgnu.la \
+	libtests.a $(am__DEPENDENCIES_1)
 test_string_SOURCES = test-string.c
 test_string_OBJECTS = test-string.$(OBJEXT)
 test_string_LDADD = $(LDADD)
@@ -569,14 +585,15 @@ SOURCES = $(libtests_a_SOURCES) $(EXTRA_libtests_a_SOURCES) \
 	test-locale.c test-localename.c test-lock.c test-lstat.c \
 	test-malloc-gnu.c test-malloca.c test-mbrtowc.c \
 	test-mbrtowc-w32.c test-mbsinit.c test-mbsrtowcs.c \
-	test-memchr.c test-nl_langinfo.c test-open.c test-readlink.c \
-	test-safe-alloc.c test-setenv.c test-setlocale1.c \
-	test-setlocale2.c test-stat.c test-stdbool.c test-stddef.c \
-	test-stdint.c test-stdio.c test-stdlib.c test-string.c \
-	test-strnlen.c test-strstr.c test-symlink.c test-sys_stat.c \
-	test-sys_wait.c test-time.c test-unistd.c test-unsetenv.c \
-	test-vasnprintf.c test-vasprintf.c test-verify.c test-wchar.c \
-	test-wcrtomb.c test-wcrtomb-w32.c test-wctype-h.c
+	test-memchr.c test-nl_langinfo.c test-open.c test-rawmemchr.c \
+	test-readlink.c test-safe-alloc.c test-setenv.c \
+	test-setlocale1.c test-setlocale2.c test-stat.c test-stdbool.c \
+	test-stddef.c test-stdint.c test-stdio.c test-stdlib.c \
+	test-strchrnul.c test-string.c test-strnlen.c test-strstr.c \
+	test-symlink.c test-sys_stat.c test-sys_wait.c test-time.c \
+	test-unistd.c test-unsetenv.c test-vasnprintf.c \
+	test-vasprintf.c test-verify.c test-wchar.c test-wcrtomb.c \
+	test-wcrtomb-w32.c test-wctype-h.c
 DIST_SOURCES = $(libtests_a_SOURCES) $(EXTRA_libtests_a_SOURCES) \
 	test-alloca-opt.c test-binary-io.c test-btowc.c test-c-ctype.c \
 	test-c-strcasecmp.c test-c-strncasecmp.c \
@@ -587,14 +604,15 @@ DIST_SOURCES = $(libtests_a_SOURCES) $(EXTRA_libtests_a_SOURCES) \
 	test-locale.c test-localename.c test-lock.c test-lstat.c \
 	test-malloc-gnu.c test-malloca.c test-mbrtowc.c \
 	test-mbrtowc-w32.c test-mbsinit.c test-mbsrtowcs.c \
-	test-memchr.c test-nl_langinfo.c test-open.c test-readlink.c \
-	test-safe-alloc.c test-setenv.c test-setlocale1.c \
-	test-setlocale2.c test-stat.c test-stdbool.c test-stddef.c \
-	test-stdint.c test-stdio.c test-stdlib.c test-string.c \
-	test-strnlen.c test-strstr.c test-symlink.c test-sys_stat.c \
-	test-sys_wait.c test-time.c test-unistd.c test-unsetenv.c \
-	test-vasnprintf.c test-vasprintf.c test-verify.c test-wchar.c \
-	test-wcrtomb.c test-wcrtomb-w32.c test-wctype-h.c
+	test-memchr.c test-nl_langinfo.c test-open.c test-rawmemchr.c \
+	test-readlink.c test-safe-alloc.c test-setenv.c \
+	test-setlocale1.c test-setlocale2.c test-stat.c test-stdbool.c \
+	test-stddef.c test-stdint.c test-stdio.c test-stdlib.c \
+	test-strchrnul.c test-string.c test-strnlen.c test-strstr.c \
+	test-symlink.c test-sys_stat.c test-sys_wait.c test-time.c \
+	test-unistd.c test-unsetenv.c test-vasnprintf.c \
+	test-vasprintf.c test-verify.c test-wchar.c test-wcrtomb.c \
+	test-wcrtomb-w32.c test-wctype-h.c
 RECURSIVE_TARGETS = all-recursive check-recursive dvi-recursive \
 	html-recursive info-recursive install-data-recursive \
 	install-dvi-recursive install-exec-recursive \
@@ -1516,17 +1534,19 @@ EXTRA_DIST = test-alloca-opt.c $(top_srcdir)/build/aux/arg-nonnull.h \
 	test-memchr.c zerosize-ptr.h signature.h macros.h \
 	test-nl_langinfo.sh test-nl_langinfo.c signature.h macros.h \
 	open.c test-open.h test-open.c signature.h macros.h putenv.c \
+	test-rawmemchr.c zerosize-ptr.h signature.h macros.h \
 	test-readlink.h test-readlink.c signature.h macros.h \
 	test-safe-alloc.c macros.h same-inode.h setenv.c test-setenv.c \
 	signature.h macros.h setlocale.c test-setlocale1.sh \
 	test-setlocale1.c test-setlocale2.sh test-setlocale2.c \
 	signature.h macros.h test-stat.h test-stat.c signature.h \
 	macros.h test-stdbool.c test-stddef.c test-stdint.c \
-	test-stdio.c test-stdlib.c test-sys_wait.h test-string.c \
-	test-strnlen.c zerosize-ptr.h signature.h macros.h \
-	test-strstr.c zerosize-ptr.h signature.h macros.h symlink.c \
-	test-symlink.h test-symlink.c signature.h macros.h \
-	test-sys_stat.c test-sys_wait.c test-sys_wait.h \
+	test-stdio.c test-stdlib.c test-sys_wait.h test-strchrnul.c \
+	signature.h macros.h test-string.c test-strnlen.c \
+	zerosize-ptr.h signature.h macros.h test-strstr.c \
+	zerosize-ptr.h signature.h macros.h symlink.c test-symlink.h \
+	test-symlink.c signature.h macros.h test-sys_stat.c \
+	test-sys_wait.c test-sys_wait.h \
 	$(top_srcdir)/build/aux/config.rpath test-time.c test-unistd.c \
 	unsetenv.c test-unsetenv.c signature.h macros.h \
 	$(top_srcdir)/build/aux/unused-parameter.h test-vasnprintf.c \
@@ -1757,6 +1777,9 @@ test-nl_langinfo$(EXEEXT): $(test_nl_langinfo_OBJECTS) $(test_nl_langinfo_DEPEND
 test-open$(EXEEXT): $(test_open_OBJECTS) $(test_open_DEPENDENCIES) 
 	@rm -f test-open$(EXEEXT)
 	$(AM_V_CCLD)$(LINK) $(test_open_OBJECTS) $(test_open_LDADD) $(LIBS)
+test-rawmemchr$(EXEEXT): $(test_rawmemchr_OBJECTS) $(test_rawmemchr_DEPENDENCIES) 
+	@rm -f test-rawmemchr$(EXEEXT)
+	$(AM_V_CCLD)$(LINK) $(test_rawmemchr_OBJECTS) $(test_rawmemchr_LDADD) $(LIBS)
 test-readlink$(EXEEXT): $(test_readlink_OBJECTS) $(test_readlink_DEPENDENCIES) 
 	@rm -f test-readlink$(EXEEXT)
 	$(AM_V_CCLD)$(LINK) $(test_readlink_OBJECTS) $(test_readlink_LDADD) $(LIBS)
@@ -1790,6 +1813,9 @@ test-stdio$(EXEEXT): $(test_stdio_OBJECTS) $(test_stdio_DEPENDENCIES)
 test-stdlib$(EXEEXT): $(test_stdlib_OBJECTS) $(test_stdlib_DEPENDENCIES) 
 	@rm -f test-stdlib$(EXEEXT)
 	$(AM_V_CCLD)$(LINK) $(test_stdlib_OBJECTS) $(test_stdlib_LDADD) $(LIBS)
+test-strchrnul$(EXEEXT): $(test_strchrnul_OBJECTS) $(test_strchrnul_DEPENDENCIES) 
+	@rm -f test-strchrnul$(EXEEXT)
+	$(AM_V_CCLD)$(LINK) $(test_strchrnul_OBJECTS) $(test_strchrnul_LDADD) $(LIBS)
 test-string$(EXEEXT): $(test_string_OBJECTS) $(test_string_DEPENDENCIES) 
 	@rm -f test-string$(EXEEXT)
 	$(AM_V_CCLD)$(LINK) $(test_string_OBJECTS) $(test_string_LDADD) $(LIBS)
@@ -1891,6 +1917,7 @@ distclean-compile:
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-memchr.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-nl_langinfo.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-open.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-rawmemchr.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-readlink.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-safe-alloc.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-setenv.Po@am__quote@
@@ -1902,6 +1929,7 @@ distclean-compile:
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-stdint.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-stdio.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-stdlib.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-strchrnul.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-string.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-strnlen.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-strstr.Po@am__quote@
@@ -2329,6 +2357,8 @@ test-nl_langinfo.sh.log: test-nl_langinfo.sh
 	@p='test-nl_langinfo.sh'; $(am__check_pre) $(LOG_COMPILE) "$$tst" $(am__check_post)
 test-open.log: test-open$(EXEEXT)
 	@p='test-open$(EXEEXT)'; $(am__check_pre) $(LOG_COMPILE) "$$tst" $(am__check_post)
+test-rawmemchr.log: test-rawmemchr$(EXEEXT)
+	@p='test-rawmemchr$(EXEEXT)'; $(am__check_pre) $(LOG_COMPILE) "$$tst" $(am__check_post)
 test-readlink.log: test-readlink$(EXEEXT)
 	@p='test-readlink$(EXEEXT)'; $(am__check_pre) $(LOG_COMPILE) "$$tst" $(am__check_post)
 test-safe-alloc.log: test-safe-alloc$(EXEEXT)
@@ -2351,6 +2381,8 @@ test-stdio.log: test-stdio$(EXEEXT)
 	@p='test-stdio$(EXEEXT)'; $(am__check_pre) $(LOG_COMPILE) "$$tst" $(am__check_post)
 test-stdlib.log: test-stdlib$(EXEEXT)
 	@p='test-stdlib$(EXEEXT)'; $(am__check_pre) $(LOG_COMPILE) "$$tst" $(am__check_post)
+test-strchrnul.log: test-strchrnul$(EXEEXT)
+	@p='test-strchrnul$(EXEEXT)'; $(am__check_pre) $(LOG_COMPILE) "$$tst" $(am__check_post)
 test-string.log: test-string$(EXEEXT)
 	@p='test-string$(EXEEXT)'; $(am__check_pre) $(LOG_COMPILE) "$$tst" $(am__check_post)
 test-strnlen.log: test-strnlen$(EXEEXT)
diff --git a/gnulib/tests/test-rawmemchr.c b/gnulib/tests/test-rawmemchr.c
new file mode 100644
index 0000000..be8feac
--- /dev/null
+++ b/gnulib/tests/test-rawmemchr.c
@@ -0,0 +1,92 @@
+/*
+ * Copyright (C) 2008-2011 Free Software Foundation, Inc.
+ * Written by Eric Blake and Bruno Haible
+ *
+ * This program is free software: you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 3 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program.  If not, see <http://www.gnu.org/licenses/>.  */
+
+#include <config.h>
+
+#include <string.h>
+
+#include "signature.h"
+SIGNATURE_CHECK (rawmemchr, void *, (void const *, int));
+
+#include <stdlib.h>
+
+#include "zerosize-ptr.h"
+#include "macros.h"
+
+/* Calculating void * + int is not portable, so this wrapper converts
+   to char * to make the tests easier to write.  */
+#define RAWMEMCHR (char *) rawmemchr
+
+int
+main (void)
+{
+  size_t n = 0x100000;
+  char *input = malloc (n + 1);
+  ASSERT (input);
+
+  input[0] = 'a';
+  input[1] = 'b';
+  memset (input + 2, 'c', 1024);
+  memset (input + 1026, 'd', n - 1028);
+  input[n - 2] = 'e';
+  input[n - 1] = 'a';
+  input[n] = '\0';
+
+  /* Basic behavior tests.  */
+  ASSERT (RAWMEMCHR (input, 'a') == input);
+  ASSERT (RAWMEMCHR (input, 'b') == input + 1);
+  ASSERT (RAWMEMCHR (input, 'c') == input + 2);
+  ASSERT (RAWMEMCHR (input, 'd') == input + 1026);
+
+  ASSERT (RAWMEMCHR (input + 1, 'a') == input + n - 1);
+  ASSERT (RAWMEMCHR (input + 1, 'e') == input + n - 2);
+  ASSERT (RAWMEMCHR (input + 1, 0x789abc00 | 'e') == input + n - 2);
+
+  ASSERT (RAWMEMCHR (input, '\0') == input + n);
+
+  /* Alignment tests.  */
+  {
+    int i, j;
+    for (i = 0; i < 32; i++)
+      {
+        for (j = 0; j < 256; j++)
+          input[i + j] = j;
+        for (j = 0; j < 256; j++)
+          {
+            ASSERT (RAWMEMCHR (input + i, j) == input + i + j);
+          }
+      }
+  }
+
+  /* Ensure that no unaligned oversized reads occur.  */
+  {
+    char *page_boundary = (char *) zerosize_ptr ();
+    size_t i;
+
+    if (!page_boundary)
+      page_boundary = input + 4096;
+    memset (page_boundary - 512, '1', 511);
+    page_boundary[-1] = '2';
+    for (i = 1; i <= 512; i++)
+      ASSERT (RAWMEMCHR (page_boundary - i, (i * 0x01010100) | '2')
+              == page_boundary - 1);
+  }
+
+  free (input);
+
+  return 0;
+}
diff --git a/gnulib/tests/test-readlink.h b/gnulib/tests/test-readlink.h
index 7247fc4..08d5662 100644
--- a/gnulib/tests/test-readlink.h
+++ b/gnulib/tests/test-readlink.h
@@ -38,7 +38,7 @@ test_readlink (ssize_t (*func) (char const *, char *, size_t), bool print)
   ASSERT (errno == ENOENT);
   errno = 0;
   ASSERT (func ("", buf, sizeof buf) == -1);
-  ASSERT (errno == ENOENT || errno == EINVAL);
+  ASSERT (errno == ENOENT);
   errno = 0;
   ASSERT (func (".", buf, sizeof buf) == -1);
   ASSERT (errno == EINVAL);
diff --git a/gnulib/tests/test-strchrnul.c b/gnulib/tests/test-strchrnul.c
new file mode 100644
index 0000000..6ea8adc
--- /dev/null
+++ b/gnulib/tests/test-strchrnul.c
@@ -0,0 +1,86 @@
+/*
+ * Copyright (C) 2008-2011 Free Software Foundation, Inc.
+ * Written by Eric Blake and Bruno Haible
+ *
+ * This program is free software: you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 3 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program.  If not, see <http://www.gnu.org/licenses/>.  */
+
+#include <config.h>
+
+#include <string.h>
+
+#include "signature.h"
+SIGNATURE_CHECK (strchrnul, char *, (char const *, int));
+
+#include <stdlib.h>
+
+#include "macros.h"
+
+int
+main (void)
+{
+  size_t n = 0x100000;
+  char *input = malloc (n + 1);
+  ASSERT (input);
+
+  input[0] = 'a';
+  input[1] = 'b';
+  memset (input + 2, 'c', 1024);
+  memset (input + 1026, 'd', n - 1028);
+  input[n - 2] = 'e';
+  input[n - 1] = 'a';
+  input[n] = '\0';
+
+  /* Basic behavior tests.  */
+  ASSERT (strchrnul (input, 'a') == input);
+  ASSERT (strchrnul (input, 'b') == input + 1);
+  ASSERT (strchrnul (input, 'c') == input + 2);
+  ASSERT (strchrnul (input, 'd') == input + 1026);
+
+  ASSERT (strchrnul (input + 1, 'a') == input + n - 1);
+  ASSERT (strchrnul (input + 1, 'e') == input + n - 2);
+
+  ASSERT (strchrnul (input, 'f') == input + n);
+  ASSERT (strchrnul (input, '\0') == input + n);
+
+  /* Check that a very long haystack is handled quickly if the byte is
+     found near the beginning.  */
+  {
+    size_t repeat = 10000;
+    for (; repeat > 0; repeat--)
+      {
+        ASSERT (strchrnul (input, 'c') == input + 2);
+      }
+  }
+
+  /* Alignment tests.  */
+  {
+    int i, j;
+    for (i = 0; i < 32; i++)
+      {
+        for (j = 0; j < 256; j++)
+          input[i + j] = (j + 1) & 0xff;
+        for (j = 1; j < 256; j++)
+          {
+            ASSERT (strchrnul (input + i, j) == input + i + j - 1);
+            input[i + j - 1] = (j == 1 ? 2 : 1);
+            ASSERT (strchrnul (input + i, j) == input + i + 255);
+            input[i + j - 1] = j;
+          }
+      }
+  }
+
+  free (input);
+
+  return 0;
+}
diff --git a/man/Makefile.in b/man/Makefile.in
index ea5c7a1..86212c4 100644
--- a/man/Makefile.in
+++ b/man/Makefile.in
@@ -103,6 +103,7 @@ am__aclocal_m4_deps = $(top_srcdir)/gnulib/m4/00gnulib.m4 \
 	$(top_srcdir)/gnulib/m4/pathmax.m4 \
 	$(top_srcdir)/gnulib/m4/printf.m4 \
 	$(top_srcdir)/gnulib/m4/putenv.m4 \
+	$(top_srcdir)/gnulib/m4/rawmemchr.m4 \
 	$(top_srcdir)/gnulib/m4/readlink.m4 \
 	$(top_srcdir)/gnulib/m4/realloc.m4 \
 	$(top_srcdir)/gnulib/m4/regex.m4 \
@@ -122,6 +123,7 @@ am__aclocal_m4_deps = $(top_srcdir)/gnulib/m4/00gnulib.m4 \
 	$(top_srcdir)/gnulib/m4/stdlib_h.m4 \
 	$(top_srcdir)/gnulib/m4/stpcpy.m4 \
 	$(top_srcdir)/gnulib/m4/stpncpy.m4 \
+	$(top_srcdir)/gnulib/m4/strchrnul.m4 \
 	$(top_srcdir)/gnulib/m4/string_h.m4 \
 	$(top_srcdir)/gnulib/m4/strndup.m4 \
 	$(top_srcdir)/gnulib/m4/strnlen.m4 \
diff --git a/man/augparse.1 b/man/augparse.1
index cd4ab6e..a0d5243 100644
--- a/man/augparse.1
+++ b/man/augparse.1
@@ -124,7 +124,7 @@
 .\" ========================================================================
 .\"
 .IX Title "AUGPARSE 1"
-.TH AUGPARSE 1 "2011-11-29" "Augeas 0.9.0" "Augeas"
+.TH AUGPARSE 1 "2010-11-17" "Augeas 0.7.4" "Augeas"
 .\" For nroff, turn off justification.  Always turn off hyphenation; it makes
 .\" way too many mistakes in technical documents.
 .if n .ad l
diff --git a/src/Makefile.in b/src/Makefile.in
index e55e0e2..d355525 100644
--- a/src/Makefile.in
+++ b/src/Makefile.in
@@ -118,6 +118,7 @@ am__aclocal_m4_deps = $(top_srcdir)/gnulib/m4/00gnulib.m4 \
 	$(top_srcdir)/gnulib/m4/pathmax.m4 \
 	$(top_srcdir)/gnulib/m4/printf.m4 \
 	$(top_srcdir)/gnulib/m4/putenv.m4 \
+	$(top_srcdir)/gnulib/m4/rawmemchr.m4 \
 	$(top_srcdir)/gnulib/m4/readlink.m4 \
 	$(top_srcdir)/gnulib/m4/realloc.m4 \
 	$(top_srcdir)/gnulib/m4/regex.m4 \
@@ -137,6 +138,7 @@ am__aclocal_m4_deps = $(top_srcdir)/gnulib/m4/00gnulib.m4 \
 	$(top_srcdir)/gnulib/m4/stdlib_h.m4 \
 	$(top_srcdir)/gnulib/m4/stpcpy.m4 \
 	$(top_srcdir)/gnulib/m4/stpncpy.m4 \
+	$(top_srcdir)/gnulib/m4/strchrnul.m4 \
 	$(top_srcdir)/gnulib/m4/string_h.m4 \
 	$(top_srcdir)/gnulib/m4/strndup.m4 \
 	$(top_srcdir)/gnulib/m4/strnlen.m4 \
diff --git a/tests/Makefile.in b/tests/Makefile.in
index a78da2c..f8b34a0 100644
--- a/tests/Makefile.in
+++ b/tests/Makefile.in
@@ -117,6 +117,7 @@ am__aclocal_m4_deps = $(top_srcdir)/gnulib/m4/00gnulib.m4 \
 	$(top_srcdir)/gnulib/m4/pathmax.m4 \
 	$(top_srcdir)/gnulib/m4/printf.m4 \
 	$(top_srcdir)/gnulib/m4/putenv.m4 \
+	$(top_srcdir)/gnulib/m4/rawmemchr.m4 \
 	$(top_srcdir)/gnulib/m4/readlink.m4 \
 	$(top_srcdir)/gnulib/m4/realloc.m4 \
 	$(top_srcdir)/gnulib/m4/regex.m4 \
@@ -136,6 +137,7 @@ am__aclocal_m4_deps = $(top_srcdir)/gnulib/m4/00gnulib.m4 \
 	$(top_srcdir)/gnulib/m4/stdlib_h.m4 \
 	$(top_srcdir)/gnulib/m4/stpcpy.m4 \
 	$(top_srcdir)/gnulib/m4/stpncpy.m4 \
+	$(top_srcdir)/gnulib/m4/strchrnul.m4 \
 	$(top_srcdir)/gnulib/m4/string_h.m4 \
 	$(top_srcdir)/gnulib/m4/strndup.m4 \
 	$(top_srcdir)/gnulib/m4/strnlen.m4 \
-- 
1.7.6.1

