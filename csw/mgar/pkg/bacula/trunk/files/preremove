# bacula - preremove script
# 2007-08-18 Fix usage of $BASEDIR and $PKG_INSTALL_ROOT.  This package is
#            not relocatable; so $BASEDIR is not used
# 2006-01-09 Add SMF capability
#

# If removing package from a filesystem tree not running the OS; then exit.
if [ ! x"$PKG_INSTALL_ROOT" = x"" ] ; then exit 0 ; fi

# Stop bacula if it is running.
smf=no
if [ -f /usr/sbin/svccfg -a -f /usr/sbin/svcadm ] ; then smf=yes ; fi

  echo "Stopping bacula"
  if [ $smf = yes ]
  then
	# Disable service
	/usr/sbin/svcadm disable svc:application/cswbacula:default
  else
	/etc/init.d/cswbacula stop
  fi
  sleep 3

exit 0
