# bacula - postremove script
# 2007-01-19 Initial version
#
# Since bacula_client is still installed; restart the init script.
#
# Start bacula if it is running.

if [ ! x"$PKG_INSTALL_ROOT" = x"" -a ! x"$PKG_INSTALL_ROOT" = x"/" ] ; then exit 0 ; fi

# daemons are started by default
enable_daemon=yes

# Source csw.conf, if it exists
if [ -f /opt/csw/etc/csw.conf ] ; then
  . /opt/csw/etc/csw.conf
fi
if [ -f /etc/opt/csw/csw.conf ] ; then
  . /etc/opt/csw/csw.conf
fi

# If defined, autoenable for the specific daemon name takes precedence
if [ "$autoenable_bacula" = "no" ] ; then
  enable_daemon=no
elif [ "$autoenable_daemons" = "no" -a ! -n "$autoenable_bacula" ] ; then
  enable_daemon=no
fi

smf=no
if [ -f /usr/sbin/svccfg -a -f /usr/sbin/svcadm ] ; then smf=yes ; fi

if [ "$enable_daemon" = "yes" ] ; then
  echo "Starting bacula client"
  if [ $smf = yes ]
  then
	# Enable service
	/usr/sbin/svcadm enable svc:application/cswbacula:default >/dev/null 2>&1
  else
	/etc/init.d/cswbacula start >/dev/null 2>&1
  fi
  sleep 3
fi

exit 0
