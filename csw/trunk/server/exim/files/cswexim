#! /bin/sh
# /etc/init.d/exim
#
# Written by Miquel van Smoorenburg <miquels@drinkel.ow.org>.
# Modified for Debian GNU/Linux by Ian Murdock <imurdock@gnu.ai.mit.edu>.
# Modified for exim by Tim Cutts <timc@chiark.greenend.org.uk>

set -e

# Exit if exim runs from /etc/inetd.conf
if [ -f /etc/inetd.conf ] && grep "^ *\([0-9.]\+:\)\?smtp" /etc/inetd.conf >/dev/null; then
    exit 0
fi

DAEMON=/opt/csw/sbin/exim
#PIDFILE=/opt/csw/var/run/exim-daemon.pid
PIDFILE=/var/run/exim.pid

test -x $DAEMON || exit 0

case "$1" in
  start)
    echo "Starting MTA:\c "
    $DAEMON -bd -q30m
    echo "exim."
    ;;
  stop)
    echo "Stopping MTA: \c"
    kill `cat "$PIDFILE"`
    echo "exim."
      ;;
  restart)
    echo "Restarting MTA: \c"
    kill `cat "$PIDFILE"`
    $DAEMON -bd -q30m
    echo "exim."
    ;;
  reload|force-reload)
    echo "Reloading exim configuration files"
    kill -1 `cat "$PIDFILE"`
    ;;
  *)
    echo "Usage: $0 {start|stop|restart|reload}"
    exit 1
    ;;
esac

exit 0
