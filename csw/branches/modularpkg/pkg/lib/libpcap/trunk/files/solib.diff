diff --speed-large-files --minimal -Nru libpcap-0.7.1.orig/Makefile.in libpcap-0.7.1/Makefile.in
--- libpcap-0.7.1.orig/Makefile.in	2001-01-17 20:05:12.000000000 -0800
+++ libpcap-0.7.1/Makefile.in	2003-07-28 14:12:12.837173000 -0700
@@ -37,6 +37,15 @@
 srcdir = @srcdir@
 VPATH = @srcdir@
 
+# some defines for shared library compilation - FIXME
+MAJ=0
+MIN=7.1
+VERSION=$(MAJ).$(MIN)
+LIBNAME=pcap
+LIBRARY=lib$(LIBNAME).a
+SOLIBRARY=lib$(LIBNAME).so
+SHAREDLIB=$(SOLIBRARY).$(VERSION)
+
 #
 # You shouldn't need to edit anything below.
 #
@@ -48,6 +57,7 @@
 
 # Standard CFLAGS
 CFLAGS = $(CCOPT) $(INCLS) $(DEFS)
+CFLAGS_SHARED = -G -Wl,-h,$(SOLIBRARY).$(MAJ)
 
 INSTALL = @INSTALL@
 INSTALL_PROGRAM = @INSTALL_PROGRAM@
@@ -67,7 +77,11 @@
 # problem if you don't own the file but can write to the directory.
 .c.o:
 	@rm -f $@
-	$(CC) $(CFLAGS) -c $(srcdir)/$*.c
+	$(CC) $(CFLAGS) -c -o $@ $(srcdir)/$*.c
+
+%_pic.o: %.c
+	@rm -f $@
+	$(CC) -KPIC $(CFLAGS) -c -o $@ $(srcdir)/$*.c
 
 PSRC =	pcap-@V_PCAP@.c
 CSRC =	pcap.c inet.c gencode.c optimize.c nametoaddr.c \
@@ -80,6 +94,8 @@
 # We would like to say "OBJ = $(SRC:.c=.o)" but Ultrix's make cannot
 # hack the extra indirection
 OBJ =	$(PSRC:.c=.o) $(CSRC:.c=.o) $(GENSRC:.c=.o) # $(LIBOBJS)
+OBJ_PIC = $(PSRC:.c=_pic.o) $(CSRC:.c=_pic.o) $(GENSRC:.c=_pic.o)
+
 HDR =	pcap.h pcap-int.h pcap-namedb.h pcap-nit.h pcap-pf.h \
 	ethertype.h gencode.h gnuc.h
 GENHDR = \
@@ -91,15 +107,22 @@
 TAGFILES = \
 	$(SRC) $(HDR) $(TAGHDR)
 
-CLEANFILES = $(OBJ) libpcap.a $(GENSRC) $(GENHDR) lex.yy.c
+CLEANFILES = $(OBJ) $(OBJ_PIC) libpcap.a $(GENSRC) $(GENHDR) lex.yy.c libpcap.so*
 
-all: libpcap.a
+all: libpcap.a $(SHAREDLIB)
 
 libpcap.a: $(OBJ)
 	@rm -f $@
 	ar rc $@ $(OBJ)
 	$(RANLIB) $@
 
+$(SHAREDLIB): $(OBJ_PIC)
+	-@rm -f $@
+	-@rm -f $(SOLIBRARY) $(SOLIBRARY).$(MAJ)
+	$(CC) $(CFLAGS_SHARED) -o $(SHAREDLIB) $(OBJ_PIC) -lc
+	ln -s $(SHAREDLIB) $(SOLIBRARY).$(MAJ)
+	ln -s $(SOLIBRARY).$(MAJ) $(SOLIBRARY)
+
 scanner.c: $(srcdir)/scanner.l
 	@rm -f $@
 	$(LEX) -t $< > $$$$.$@; mv $$$$.$@ $@
@@ -107,6 +130,9 @@
 scanner.o: scanner.c tokdefs.h
 	$(CC) $(CFLAGS) -c scanner.c
 
+scanner_pic.o: scanner.c tokdefs.h
+	$(CC) -KPIC $(CFLAGS) -o $@ -c scanner.c
+
 tokdefs.h: grammar.c
 grammar.c: $(srcdir)/grammar.y
 	@rm -f grammar.c tokdefs.h
@@ -118,9 +144,16 @@
 	@rm -f $@
 	$(CC) $(CFLAGS) -Dyylval=pcap_lval -c grammar.c
 
+grammar_pic.o: grammar.c
+	@rm -f $@
+	$(CC) -KPIC $(CFLAGS) -Dyylval=pcap_lval -o $@ -c grammar.c
+
 version.o: version.c
 	$(CC) $(CFLAGS) -c version.c
 
+version_pic.o: version.c
+	$(CC) -KPIC $(CFLAGS) -o $@ -c version.c
+
 snprintf.o: $(srcdir)/../tcpdump/missing/snprintf.c
 	$(CC) $(CFLAGS) -o $@ -c $(srcdir)/../tcpdump/missing/snprintf.c
 
@@ -135,31 +168,35 @@
 bpf_filter.o: bpf_filter.c
 	$(CC) $(CFLAGS) -c bpf_filter.c
 
+bpf_filter_pic.o: bpf_filter.c
+	$(CC) -KPIC $(CFLAGS) -o $@ -c bpf_filter.c
+
 install:
-	[ -d $(DESTDIR)$(libdir) ] || \
-	    (mkdir -p $(DESTDIR)$(libdir); chmod 755 $(DESTDIR)$(libdir))
-	$(INSTALL_DATA) libpcap.a $(DESTDIR)$(libdir)/libpcap.a
-	$(RANLIB) $(DESTDIR)$(libdir)/libpcap.a
-	[ -d $(DESTDIR)$(includedir) ] || \
-	    (mkdir -p $(DESTDIR)$(includedir); chmod 755 $(DESTDIR)$(includedir))
-	$(INSTALL_DATA) $(srcdir)/pcap.h $(DESTDIR)$(includedir)/pcap.h
-	$(INSTALL_DATA) $(srcdir)/pcap-namedb.h \
-	    $(DESTDIR)$(includedir)/pcap-namedb.h
-	[ -d $(DESTDIR)$(includedir)/net ] || \
-	    (mkdir -p $(DESTDIR)$(includedir)/net; chmod 755 $(DESTDIR)$(includedir)/net)
-	$(INSTALL_DATA) $(srcdir)/bpf/net/bpf.h \
-	    $(DESTDIR)$(includedir)/net/bpf.h
-	[ -d $(DESTDIR)$(mandir)/man3 ] || \
-		(mkdir -p $(DESTDIR)$(mandir)/man3; chmod 755 $(DESTDIR)$(mandir)/man3)
-	$(INSTALL_DATA) $(srcdir)/pcap.3 \
-	    $(DESTDIR)$(mandir)/man3/pcap.3
+	[ -d $(libdir) ] || \
+		(mkdir -p $(libdir); chmod 755 $(libdir))
+	$(INSTALL_DATA) libpcap.a $(libdir)/libpcap.a
+	$(INSTALL_DATA) $(SHAREDLIB) $(libdir)/
+	ln -sf $(SHAREDLIB) $(libdir)/$(SOLIBRARY).$(MAJ)
+	ln -sf $(SOLIBRARY).$(MAJ) $(libdir)/$(SOLIBRARY)
+	$(RANLIB) $(libdir)/libpcap.a
+	[ -d $(includedir) ] || \
+		(mkdir -p $(includedir); chmod 755 $(includedir))
+	$(INSTALL_DATA) $(srcdir)/pcap.h $(includedir)/pcap.h
+	$(INSTALL_DATA) $(srcdir)/pcap-namedb.h $(includedir)/pcap-namedb.h
+	[ -d $(includedir)/net ] || \
+		(mkdir -p $(includedir)/net; chmod 755 $(includedir)/net)
+	$(INSTALL_DATA) $(srcdir)/bpf/net/bpf.h $(includedir)/net/bpf.h
+	[ -d $(mandir)/man3 ] || \
+		(mkdir -p $(mandir)/man3; chmod 755 $(mandir)/man3)
+	$(INSTALL_DATA) $(srcdir)/pcap.3 $(mandir)/man3/pcap.3
+
 
 uninstall:
-	rm -f $(DESTDIR)$(libdir)/libpcap.a
-	rm -f $(DESTDIR)$(includedir)/pcap.h
-	rm -f $(DESTDIR)$(includedir)/pcap-namedb.h
-	rm -f $(DESTDIR)$(includedir)/net/bpf.h
-	rm -f $(DESTDIR)$(mandir)/man3/pcap.3
+	rm -f $(libdir)/libpcap.a
+	rm -f $(includedir)/pcap.h
+	rm -f $(includedir)/pcap-namedb.h
+	rm -f $(includedir)/net/bpf.h
+	rm -f $(mandir)/man3/pcap.3
 
 clean:
 	rm -f $(CLEANFILES)
