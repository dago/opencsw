GARNAME = openldap
GARVERSION = 2.3.41
CATEGORIE1 = server

DESCRIPTION = Open source implementation of the Lightweight Directory Access Protocol
define BLURB
  The OpenLDAP Project is a collaborative effort to develop a robust,
  commercial-grade, fully featured, and open source LDAP suite of applications
  and development tools. The project is managed by a worldwide community of
  volunteers that use the Internet to communicate, plan, and develop the
  OpenLDAP Suite and its related documentation.
endef

MASTER_SITES = ftp://ftp.openldap.org/pub/OpenLDAP/openldap-release/
DISTFILES  = $(GARNAME)-$(GARVERSION).tgz
DISTFILES += $(call admfiles,CSWoldap,depend)
DISTFILES += cswopenldap openldap.xml svc-openldap
DISTFILES += $(call admfiles,CSWoldapclient,depend)
DISTFILES += $(call admfiles,CSWoldapdevel,depend)
DISTFILES += $(call admfiles,CSWoldaprt,depend)
DISTFILES += README.CSW openldaprc

PATCHFILES = patch-oldap-2.3.24-ntlm.diff
DISTFILES += $(PATCHFILES)

EXTRA_DOCS = README.CSW openldaprc $(PATCHFILES)

EXTRA_INC = $(prefix)/bdb44/include
EXTRA_LIB = $(prefix)/bdb44/lib

CONFIGURE_ARGS = $(DIRPATHS)

TEST_SCRIPTS =

CONFIGURE_ARGS = $(DIRPATHS)

EXTRA_BUILD_ISAS_sparc = sparcv9
EXTRA_BUILD_ISAS_i386  = pentium_pro amd64

ISA_RELOCATE_DIRS_pentium_pro = $(libdir)
EXTRA_MERGE_EXCLUDE_FILES_pentium_pro = .*\.a .*\.la

PKGFILES_CSWoldapclient_EXCLUSIVE  = $(bindir)/.*
PKGFILES_CSWoldapclient_EXCLUSIVE += $(mandir)/man1/.*

PKGFILES_CSWoldapdevel_EXCLUSIVE  = $(PKGFILES_DEVEL)
PKGFILES_CSWoldapdevel_EXCLUSIVE += $(mandir)/man3/.*

PKGFILES_CSWoldaprt_EXCLUSIVE  = $(PKGFILES_RT)
PKGFILES_CSWoldaprt_EXCLUSIVE += $(sysconfdir)/ldap.conf
PKGFILES_CSWoldaprt_EXCLUSIVE += $(mandir)/man5/ldap.conf.5

include ../category.mk

INSTALL_SCRIPTS += custom

install-custom:
	@for file in $(EXTRA_DOCS); do \
		ginstall -D $(WORKDIR)/$$file $(DESTDIR)$(docdir)/$(GARNAME)/$$file; \
	done
	@$(MAKECOOKIE)
